## ChÆ°Æ¡ng V: Biáº¿t nÃªn comment nhá»¯ng gÃ¬
![](https://images.viblo.asia/fff131e9-3ee0-41b1-9d4a-4982a5b883e9.png)
<br><br>
Má»¥c tiÃªu cá»§a chÆ°Æ¡ng nÃ y lÃ  giÃºp báº¡n nháº­n ra nhá»¯ng gÃ¬ báº¡n nÃªn comment. Báº¡n cÃ³ thá»ƒ nghÄ© ráº±ng má»¥c Ä‘Ã­ch cá»§a viá»‡c comment lÃ  chá»‰ Ä‘á»ƒ "giáº£i thÃ­ch nhá»¯ng gÃ¬ code lÃ m", nhÆ°ng Ä‘Ã³ chá»‰ lÃ  má»™t pháº§n nhá» trong Ä‘Ã³.<br>
> ##### KEY IDEA: 
> ##### ***Má»¥c Ä‘Ã­ch cá»§a comment lÃ  giÃºp ngÆ°á»i Ä‘á»c hiá»ƒu nhá»¯ng gÃ¬ mÃ  tÃ¡c giáº£ viáº¿t cÃ ng nhiá»u cÃ ng tá»‘t.***
Khi báº¡n viáº¿t code, báº¡n cÃ³ ráº¥t nhiá»u thÃ´ng tin cÃ³ giÃ¡ trá»‹ trong Ä‘áº§u. Khi ngÆ°á»i khÃ¡c Ä‘á»c code cá»§a báº¡n, thÃ´ng tin Ä‘Ã³ sáº½ bá»‹ máº¥tâ€”vÃ  táº¥t cáº£ nhá»¯ng gÃ¬ há» cÃ³ chá»‰ lÃ  Ä‘oáº¡n code mÃ  há» Ä‘ang Ä‘á»c.<br>
Trong chÆ°Æ¡ng nÃ y, chÃºng tÃ´i sáº½ cho báº¡n tháº¥y nhiá»u vÃ­ dá»¥ vá» viá»‡c khi nÃ o thÃ¬ nÃªn viáº¿t ra thÃ´ng tin trong Ä‘áº§u cá»§a báº¡n. ChÃºng tÃ´i Ä‘Ã£ bá» qua nhá»¯ng Ä‘iá»ƒm nhá» nháº·t vá» comment mÃ  thay vÃ o Ä‘Ã³, chÃºng tÃ´i Ä‘Ã£ táº­p trung vÃ o nhá»¯ng khÃ­a cáº¡nh thÃº vá»‹ hÆ¡n vÃ  "khÃ´ng Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ cao" cá»§a comment.<br>
ChÃºng tÃ´i Ä‘Ã£ sáº¯p xáº¿p chÆ°Æ¡ng nÃ y thÃ nh cÃ¡c chá»§ Ä‘á» sau:
* Biáº¿t *khÃ´ng* nÃªn comment nhá»¯ng gÃ¬
* Ghi láº¡i nhá»¯ng suy nghÄ© cá»§a mÃ¬nh nhÆ° khi báº¡n viáº¿t code
* ÄÆ°a mÃ¬nh vÃ o vá»‹ trÃ­ cá»§a ngÆ°á»i Ä‘á»c, Ä‘á»ƒ tÆ°á»Ÿng tÆ°á»£ng nhá»¯ng gÃ¬ há» sáº½ cáº§n pháº£i biáº¿t
### Biáº¿t *KHÃ”NG* nÃªn comment nhá»¯ng gÃ¬
![](https://images.viblo.asia/1dbdd35d-92f2-4251-a2c3-736acaf77568.png)
<br><br>
Äá»c má»™t comment sáº½ láº¥y Ä‘i thá»i gian tá»« viá»‡c Ä‘á»c code, vÃ  má»—i comment cÅ©ng chiáº¿m khÃ´ng gian trÃªn mÃ n hÃ¬nh. CÃ³ nghÄ©a lÃ , nÃ³ Ä‘Ã¡ng giÃ¡ Ä‘á»ƒ chÃºng ta pháº£i suy nghÄ©. VÃ¬ váº­y, á»Ÿ Ä‘Ã¢u thÃ¬ báº¡n nghÄ© nÃ³ lÃ  má»™t comment vÃ´ giÃ¡ trá»‹ hay lÃ  má»™t comment tá»‘t?<br>
ToÃ n bá»™ comment á»Ÿ Ä‘oáº¡n code dÆ°á»›i Ä‘Ã¢y lÃ  vÃ´ giÃ¡ trá»‹:
```
// The class definition for Account
public class Account {
    // Constructor
    public Account() {}
    
    // Global variable profit
    private double profit;
    
    // Set the profit member to a new value
    public void setProfit(double profit) {
        this.profit = profit;
    }
    
    // Return the profit from this Account
    public double getProfit() {
        return profit;
    }
}
```
Nhá»¯ng comment khÃ´ng cÃ³ giÃ¡ trá»‹ vÃ¬ chÃºng khÃ´ng cung cáº¥p thÃªm báº¥t kÃ¬ thÃ´ng tin gÃ¬ hay giÃºp ngÆ°á»i Ä‘á»c hiá»ƒu Ä‘Æ°á»£c code tá»‘t hÆ¡n.
> ##### KEY IDEA: 
> ##### ***KhÃ´ng táº¡o comment vá» nhá»¯ng thá»© hiá»ƒn nhiÃªn mÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c dáº«n xuáº¥t nhanh chÃ³ng tá»« chÃ­nh Ä‘oáº¡n code.***
Tuy nhiÃªn, chÃºng ta cáº§n pháº£i phÃ¢n biá»‡t "nhanh chÃ³ng" á»Ÿ Ä‘Ã¢y. HÃ£y xem xÃ©t Ä‘oáº¡n comment cho Ä‘oáº¡n code Python nÃ y:
```
# remove everything after the second '*'
name = '*'.join(line.split('*')[:2])
```
Vá» máº·t ká»¹ thuáº­t, comment nÃ y khÃ´ng cung cáº¥p thÃªm báº¥t ká»³ "thÃ´ng tin má»›i" nÃ o. Náº¿u báº¡n chá»‰ nhÃ¬n vÃ o báº£n thÃ¢n code Ä‘Ã³, báº¡n cÅ©ng sáº½ biáº¿t chá»©c nÄƒng cá»§a nÃ³ lÃ  gÃ¬. NhÆ°ng Ä‘á»‘i vá»›i háº§u háº¿t cÃ¡c láº­p trÃ¬nh viÃªn, Ä‘á»c comment code nhanh hÆ¡n nhiá»u so vá»›i viá»‡c hiá»ƒu code mÃ  khÃ´ng cÃ³ comment.
<br><br>
#### Äá»«ng comment cho cÃ³
![](https://images.viblo.asia/3e419c4f-6853-40c4-8b9b-a8de1b66f026.png)
<br><br>
Má»™t sá»‘ giÃ¡o viÃªn yÃªu cáº§u cÃ¡c sinh viÃªn cá»§a mÃ¬nh pháº£i cÃ³ má»™t comment cho má»—i function trong code bÃ i táº­p vá» nhÃ  cá»§a há». VÃ  káº¿t quáº£ lÃ , má»™t sá»‘ láº­p trÃ¬nh viÃªn cáº£m tháº¥y "tá»™i lá»—i" vá» viá»‡c Ä‘á»ƒ láº¡i má»™t function "tráº§n truá»“ng" mÃ  khÃ´ng cÃ³ comment nÃ o, vÃ  cuá»‘i cÃ¹ng há» Ä‘Ã£ viáº¿t láº¡i tÃªn cá»§a function vÃ  tham sá»‘ theo hÃ¬nh thá»©c cÃ¢u nhÆ° nÃ y:
```
// Find the Node in the given subtree, with the given name, using the given depth.
Node findNodeInSubtree(Node subtree, String name, int depth);
```
TrÆ°á»ng há»£p nÃ y rÆ¡i vÃ o má»¥c â€œcomment vÃ´ giÃ¡ trá»‹â€â€”khai bÃ¡o cá»§a function vÃ  comment lÃ  háº§u nhÆ° giá»‘ng nhau. Comment nÃ y nÃªn Ä‘Æ°á»£c gá»¡ bá» hoáº·c cáº£i thiá»‡n.<br>
Náº¿u báº¡n muá»‘n cÃ³ má»™t comment á»Ÿ Ä‘Ã¢y, thÃ¬ nÃ³ nÃªn giáº£i thÃ­ch nhá»¯ng thÃ´ng tin quan trá»ng hÆ¡n:
```
// Find a Node with the given 'name' or return NULL.
// If depth <= 0, only 'subtree' is inspected.
// If depth == N, only 'subtree' and N levels below are inspected.
Node findNodeInSubtree(Node subtree, String name, int depth);
```

<br>

#### Äá»«ng comment trÃªn nhá»¯ng cÃ¡i tÃªn tá»“iâ€”Thay vÃ o Ä‘Ã³ hÃ£y sá»­a nhá»¯ng cÃ¡i tÃªn Ä‘Ã³
Má»™t comment khÃ´ng cáº§n pháº£i lÃ m Ä‘áº¹p cho má»™t cÃ¡i tÃªn xáº¥u. VÃ­ dá»¥, Ä‘Ã¢y lÃ  má»™t comment khÃ´ng Äƒn nháº­p vá»›i method *CleanReply()*:
```
// Enforce limits on the Reply as stated in the Request,
// such as the number of items returned, or total byte size, etc.
void cleanReply(Request request, Reply reply);
```
Háº§u háº¿t cÃ¡c comment chá»‰ Ä‘Æ¡n giáº£n lÃ  giáº£i thÃ­ch Ã½ nghÄ©a cá»§a â€œcleanâ€. Thay vÃ o Ä‘Ã³, cá»¥m tá»« â€œenforce limitsâ€ nÃªn Ä‘Æ°á»£c chuyá»ƒn vÃ o tÃªn function:
```
// Make sure 'reply' meets the count/byte/etc. limits from the 'request'
void enforceLimitsFromRequest(Request request, Reply reply);
```
TÃªn function nÃ y Ä‘Ã­nh kÃ¨m Ä‘Æ°á»£c nhiá»u thÃ´ng tin hÆ¡n. Má»™t cÃ¡i tÃªn tá»‘t sáº½ tá»‘t hÆ¡n lÃ  má»™t comment tá»‘t vÃ¬ nÃ³ sáº½ Ä‘Æ°á»£c hiá»ƒu luÃ´n á»Ÿ toÃ n bá»™ nhá»¯ng nÆ¡i mÃ  function Ä‘Æ°á»£c sá»­ dá»¥ng.<br>
DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ vá» má»™t comment cho má»™t function cÃ³ tÃªn xáº¥u:
```
// Releases the handle for this key. This doesn't modify the actual registry.
void deleteRegistry(RegistryKey key);
```
CÃ¡i tÃªn *deleteRegistry()* nghe cÃ³ váº» nhÆ° lÃ  má»™t function nguy hiá»ƒm (nÃ³ *xÃ³a registry*?!). Äoáº¡n comment "â€œThis doesnâ€™t modify the actual registryâ€ lÃ  Ä‘á»ƒ cá»‘ gáº¯ng lÃ m sÃ¡ng tá» sá»± nháº§m láº«n.<br>
Thay vÃ o Ä‘Ã³, chÃºng ta sáº½ sá»­ dá»¥ng má»™t cÃ¡i tÃªn mÃ  Ä‘Ã­nh kÃ¨m Ä‘Æ°á»£c nhiá»u thÃ´ng tin hÆ¡n nhÆ° lÃ :
```
void releaseRegistryHandle(RegistryKey key);
```
NÃ³i chung, khÃ´ng nÃªn cÃ³ nhá»¯ng â€œcomment nhÆ° cÃ¡i náº¡ngâ€ â€”comment mÃ  Ä‘ang cá»‘ gáº¯ng Ä‘á»ƒ bÃ¹ Ä‘áº¯p cho sá»± khÃ³ Ä‘á»c cá»§a code. CÃ¡c láº­p trÃ¬nh viÃªn thÆ°á»ng cÃ³ quy táº¯c lÃ  **code  tá»‘t > code xáº¥u + comment tá»‘t.**
### Ghi láº¡i nhá»¯ng suy nghÄ© cá»§a mÃ¬nh
BÃ¢y giá» báº¡n Ä‘Ã£ biáº¿t nhá»¯ng gÃ¬ *khÃ´ng nÃªn* comment, cÃ²n giá» thÃ¬ hÃ£y tháº£o luáº­n vá» nhá»¯ng gÃ¬ *nÃªn* comment (thÆ°á»ng khÃ´ng Ä‘Æ°á»£c thÃªm).<br>
Ráº¥t nhiá»u comment tá»‘t cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘Æ°a ra chá»‰ Ä‘Æ¡n giáº£n lÃ  "ghi láº¡i nhá»¯ng suy nghÄ© cá»§a báº¡n"â€”Ä‘Ã³ lÃ  nhá»¯ng suy nghÄ© quan trá»ng mÃ  báº¡n cÃ³ khi viáº¿t code.
<br><br>
#### Bao gá»“m â€œDirector Commentaryâ€ 
CÃ¡c bá»™ phim thÆ°á»ng cÃ³ má»™t â€œdirector commentaryâ€ track (táº¡m gá»i lÃ  chÃº giáº£i Ä‘áº¡o diá»…n), nÆ¡i cÃ¡c nhÃ  lÃ m phim Ä‘Æ°a ra nhá»¯ng hiá»ƒu biáº¿t cá»§a há» vÃ  ká»ƒ nhá»¯ng cÃ¢u chuyá»‡n Ä‘á»ƒ giÃºp báº¡n hiá»ƒu cÃ¡ch bá»™ phim Ä‘Æ°á»£c thá»±c hiá»‡n. TÆ°Æ¡ng tá»±, báº¡n nÃªn thÃªm cÃ¡c comment Ä‘á»ƒ ghi láº¡i nhá»¯ng hiá»ƒu biáº¿t cÃ³ giÃ¡ trá»‹ vá» code.<br>
ÄÃ¢y lÃ  má»™t vÃ­ dá»¥:
```
// Surprisingly, a binary tree was 40% faster than a hash table for this data.
// The cost of computing a hash was more than the left/right comparisons.
```
Comment nÃ y dáº¡y cho ngÆ°á»i Ä‘á»c má»™t Ä‘iá»u gÃ¬ Ä‘Ã³ vÃ  ngÄƒn cháº·n viá»‡c tá»‘i Æ°u hÃ³a code sáº½ lÃ m lÃ£ng phÃ­ thá»i gian xá»­ lÃ½ (Náº¿u dÃ¹ng hash table thay vÃ¬ binary tree).<br>
ÄÃ¢y lÃ  má»™t vÃ­ dá»¥ khÃ¡c:
```
// This heuristic might miss a few words. That's OK; solving this 100% is hard.
```
Náº¿u khÃ´ng cÃ³ comment nÃ y, ngÆ°á»i Ä‘á»c cÃ³ thá»ƒ nghÄ© ráº±ng cÃ³ má»™t bug vÃ  cÃ³ thá»ƒ lÃ£ng phÃ­ thá»i gian Ä‘á»ƒ cá»‘ gáº¯ng Ä‘Æ°a ra cÃ¡c test case hoáº·c cá»‘ gáº¯ng sá»­a lá»—i.<br>
Má»™t comment cÅ©ng cÃ³ thá»ƒ giáº£i thÃ­ch táº¡i sao code láº¡i khÃ´ng cÃ³ bá»‘ cá»¥c Ä‘áº¹p:
```
// This class is getting messy. Maybe we should create a 'ResourceNode' subclass to
// help organize things.
```
Comment nÃ y thá»«a nháº­n ráº±ng code nÃ y lá»™n xá»™n nhÆ°ng cÅ©ng khuyáº¿n khÃ­ch ngÆ°á»i code tiáº¿p theo sá»­a nÃ³ (vá»›i nhá»¯ng chi tiáº¿t cá»¥ thá»ƒ vá» cÃ¡ch báº¯t Ä‘áº§u). 
<br><br>
#### Comment nhá»¯ng sai sÃ³t trong code cá»§a mÃ¬nh
Trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn code cháº¯c cháº¯n sáº½ cÃ³ nhá»¯ng sai sÃ³t trÃªn Ä‘Æ°á»ng Ä‘i. Äá»«ng ngáº¡i khi ghi láº¡i nhá»¯ng sai sÃ³t. VÃ­ dá»¥, hÃ£y note láº¡i khi nhá»¯ng cáº£i tiáº¿n nÃªn Ä‘Æ°á»£c thá»±c hiá»‡n:
```
// TODO: use a faster algorithm
```
hoáº·c khi code Ä‘ang chÆ°a Ä‘Æ°á»£c hoÃ n thiá»‡n:
```
// TODO(dustin): handle other image formats besides JPEG
```
CÃ³ má»™t sá»‘ marker Ä‘Ã£ trá»Ÿ nÃªn phá»• biáº¿n trong láº­p trÃ¬nh:
| Marker | Ã nghÄ©a thÃ´ng thÆ°á»ng |
| -------- | -------- |
| TODO:  | Nhá»¯ng thá»© chÆ°a Ä‘Æ°á»£c giáº£i quyáº¿t á»Ÿ Ä‘Ã¢y |
| FIXME:  | Äoáº¡n code cÃ³ váº¥n Ä‘á» á»Ÿ Ä‘Ã¢y |
| HACK:  |Code nÃ y chá»‰ lÃ  giáº£i phÃ¡p táº¡m thá»i|
| XXX:  | Nguy hiá»ƒm! Váº¥n Ä‘á» máº¥u chá»‘t lÃ  á»Ÿ chá»— nÃ y |
Team cá»§a báº¡n cÃ³ thá»ƒ cÃ³ cÃ¡c quy Æ°á»›c cá»¥ thá»ƒ vá» viá»‡c sá»­ dá»¥ng cÃ¡c marker nÃ y. VÃ­ dá»¥: *TODO:* cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ nh riÃªng cho cÃ¡c váº¥n Ä‘á» lá»›n. Náº¿u váº­y, Ä‘á»‘i vá»›i cÃ¡c lá»—i nhá» hÆ¡n, báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng má»™t cÃ¡i gÃ¬ Ä‘Ã³ nhÆ° *todo:* (chá»¯ thÆ°á»ng) hoáº·c *maybe-later:* Ä‘á»ƒ thay vÃ o Ä‘Ã³.<br>
Äiá»u quan trá»ng lÃ  báº¡n pháº£i luÃ´n cáº£m tháº¥y thoáº£i mÃ¡i Ä‘á»ƒ comment nhá»¯ng suy nghÄ© cá»§a mÃ¬nh vá» cÃ¡ch mÃ  code sáº½ thay Ä‘á»•i trong tÆ°Æ¡ng lai. Nhá»¯ng comment nhÆ° tháº¿ nÃ y cung cáº¥p cho ngÆ°á»i Ä‘á»c cÃ¡i nhÃ¬n giÃ¡ trá»‹ vá» cháº¥t lÆ°á»£ng vÃ  tráº¡ng thÃ¡i cá»§a code, vÃ  tháº­m chÃ­ cÃ³ thá»ƒ cung cáº¥p cho há» má»™t sá»‘ hÆ°á»›ng vá» cÃ¡ch cáº£i thiá»‡n nÃ³.
<br><br>
#### Comment trÃªn cÃ¡c háº±ng sá»‘
Khi Ä‘á»‹nh nghÄ©a má»™t háº±ng sá»‘, thÆ°á»ng cÃ³ má»™t â€œcÃ¢u chuyá»‡nâ€ vá» Ã½ nghÄ©a cá»§a háº±ng sá»‘ Ä‘Ã³ hoáº·c táº¡i sao nÃ³ cÃ³ giÃ¡ trá»‹ Ä‘Ã³. VÃ­ dá»¥: báº¡n cÃ³ thá»ƒ tháº¥y háº±ng sá»‘ nÃ y trong code cá»§a mÃ¬nh:
```
int NUM_THREADS = 8;
```
CÃ³ váº» nhÆ° dÃ²ng nÃ y khÃ´ng cáº§n comment, nhÆ°ng cÃ³ váº» nhÆ° lÃ  ngÆ°á»i viáº¿t code biáº¿t vÃ¬ sao láº¡i Ä‘áº·t giÃ¡ trá»‹ nhÆ° váº­y:
```
int NUM_THREADS = 8; // as long as it's >= 2 * num_processors, that's good enough.
```
BÃ¢y giá» thÃ¬ ngÆ°á»i Ä‘á»c Ä‘Ã£ cÃ³ thÃªm hÆ°á»›ng dáº«n Ä‘á»ƒ Ä‘iá»u chá»‰nh láº¡i giÃ¡ trá»‹ (vÃ­ dá»¥, setting nÃ³ vá» 1 thÃ¬ quÃ¡ tháº¥p cÃ²n setting vá» 50 thÃ¬ lÃ  quÃ¡ má»©c cáº§n thiáº¿t.)<br>
Hoáº·c Ä‘Ã´i khi giÃ¡ trá»‹ chÃ­nh xÃ¡c cá»§a má»™t háº±ng sá»‘ lÃ  khÃ´ng quan trá»ng chÃºt nÃ o. Má»™t comment cho viá»‡c nÃ y váº«n há»¯u Ã­ch:
```
// Impose a reasonable limit - no human can read that much anyway.
int MAX_RSS_SUBSCRIPTIONS = 1000;
```
ÄÃ´i khi Ä‘Ã³ lÃ  má»™t giÃ¡ trá»‹ Ä‘Ã£ Ä‘Æ°á»£c cÃ¢n nháº¯c, vÃ  cÃ³ láº½ khÃ´ng nÃªn Ä‘Æ°á»£c Ä‘iá»u chá»‰nh nhiá»u:
```
float image_quality = 0.72; // users thought 0.72 gave the best size/quality tradeoff
```
Trong táº¥t cáº£ cÃ¡c vÃ­ dá»¥ nÃ y, báº¡n cÃ³ thá»ƒ khÃ´ng nghÄ© tá»›i viá»‡c thÃªm comment, nhÆ°ng thá»±c ra lÃ  chÃºng khÃ¡ há»¯u Ã­ch.<br>
CÃ³ má»™t sá»‘ háº±ng sá»‘ mÃ  khÃ´ng cáº§n comment, bá»Ÿi vÃ¬ tÃªn cá»§a nÃ³ lÃ  Ä‘á»§ rÃµ rÃ ng rá»“i (vÃ­ dá»¥, *SECONDS_PER_DAY*). NhÆ°ng theo kinh nghiá»‡m cá»§a chÃºng tÃ´i, háº§u háº¿t cÃ¡c háº±ng sá»‘ cÃ³ thá»ƒ Ä‘Æ°á»£c cáº£i thiá»‡n báº±ng cÃ¡ch thÃªm má»™t comment. NÃ³ chá»‰ lÃ  viá»‡c ghi láº¡i nhá»¯ng gÃ¬ báº¡n Ä‘Ã£ nghÄ© khi báº¡n quyáº¿t Ä‘á»‹nh vá» giÃ¡ trá»‹ khÃ´ng Ä‘á»•i Ä‘Ã³.
<br><br>
*(cÃ²n tiáº¿p)*
#### Káº¿t (P8)
ChÆ°Æ¡ng V mÃ¬nh xin phÃ©p Ä‘Æ°á»£c tÃ¡ch ra lÃ m 2 topic vÃ¬ ná»™i dung cá»§a nÃ³ cÅ©ng khÃ¡ lÃ  dÃ i, háº¹n gáº·p láº¡i cÃ¡c báº¡n á»Ÿ pháº§n tá»›i ğŸ˜ƒ 
<br> [Series Viáº¿t code "nghá»‡ thuáº­t"](https://viblo.asia/s/series-viet-code-nghe-thuat-o754jLL0ZM6)
<br> TÃ i liá»‡u tham kháº£o: *The art of readable code by Dustin Boswell and Trevor Foucher*