SHA-2 (Thuáº­t toÃ¡n bÄƒm an toÃ n 2), trong Ä‘Ã³ SHA-256 cÅ©ng lÃ  má»™t pháº§n, chÃºng lÃ  má»™t trong nhá»¯ng thuáº­t toÃ¡n bÄƒm phá»• biáº¿n nháº¥t hiá»‡n nay. á» bÃ i viáº¿t nÃ y, mÃ¬nh sáº½ chia sáº» cho cÃ¡c báº¡n cÃ¡ch thá»©c mÃ  thuáº­t toÃ¡n hoáº¡t Ä‘á»™ng. Vá»›i SHA-2 Ä‘Æ°á»£c biáº¿t Ä‘áº¿n vá»›i kháº£ nÄƒng báº£o máº­t cáº¥p cao (khÃ´ng giá»‘ng nhÆ° SHA-1) vÃ  tá»‘c Ä‘á»™ cá»§a nÃ³. Trong cÃ¡c trÆ°á»ng há»£p khÃ´ng táº¡o key, cháº³ng háº¡n nhÆ° khai thÃ¡c Bitcoin, thuáº­t toÃ¡n bÄƒm nhanh nhÆ° SHA-2 sáº½ lÃ  lá»£i tháº¿ cho báº¡n.
# HÃ m bÄƒm lÃ  gÃ¬ ?
HÃ m bÄƒm Ä‘Æ°á»£c chia lÃ m 3 loáº¡i chÃ­nh:
* XÃ¡o trá»™n dá»¯ liá»‡u.
* Cháº¥p nháº­n Ä‘áº§u vÃ o tÃ¹y Ã½ vÃ  Ä‘áº§u ra cá»‘ Ä‘á»‹nh.
* GiÃºp thao tÃ¡c dá»¯ liá»‡u mÃ  khÃ´ng thay Ä‘á»•i.
# SHA-2 cÃ³ há» hÃ ng vá»›i SHA-256 ?
SHA-2 lÃ  má»™t thuáº­t toÃ¡n bÄƒm dá»¯ liá»‡u. ChÃºng Ä‘á»u sá»­ dá»¥ng cÃ¹ng má»™t thuáº­t toÃ¡n nhÆ°ng sá»­ dá»¥ng cÃ¡c háº±ng sá»‘ khÃ¡c nhau. VÃ­ dá»¥: SHA-256 Ä‘áº·t cÃ¡c háº±ng sá»‘ bá»• sung xÃ¡c Ä‘á»‹nh hÃ nh vi cá»§a thuáº­t toÃ¡n SHA-2, má»™t trong nhá»¯ng háº±ng sá»‘ nÃ y lÃ  kÃ­ch thÆ°á»›c Ä‘áº§u ra, 256 vÃ  512 trong SHA-256 vÃ  SHA-512 tham chiáº¿u Ä‘áº¿n kÃ­ch thÆ°á»›c tÆ°Æ¡ng á»©ng vá»›i cÃ¡c bit.
# SHA-2 lÃ  con cá»§a SHA-1 ?
SHA-2 lÃ  sá»± káº¿ thá»«a cá»§a hÃ m bÄƒm SHA-1 vÃ  váº«n lÃ  má»™t trong nhá»¯ng hÃ m bÄƒm máº¡nh nháº¥t Ä‘Æ°á»£c sá»­ dá»¥ng ngÃ y nay. SHA-256, trÃ¡i ngÆ°á»£c vá»›i SHA-1, chÃºng khÃ´ng bá»‹ xÃ¢m pháº¡m. VÃ¬ lÃ½ do nÃ y, báº¡n cháº³ng cÃ³ lÃ½ do gÃ¬ Ä‘á»ƒ sá»­ dá»¥ng SHA-1 vÃ¬ nÃ³ khÃ´ng an toÃ n. TÃ­nh linh hoáº¡t cá»§a kÃ­ch thÆ°á»›c Ä‘áº§u ra (224, 256, 512, ....) cÅ©ng cho phÃ©p SHA-2 ghÃ©p ná»‘i tá»‘t vá»›i cÃ¡c **KDF** vÃ  máº­t mÃ£ phá»• biáº¿n nhÆ° **AES-256**.
# "hello world" Ä‘áº§u tiÃªn
## BÆ°á»›c xá»­ lÃ½:
TrÆ°á»›c tiÃªn ta cáº§n Ä‘á»•i chá»¯ `hello world` thÃ nh nhá»‹ phÃ¢n.
```
01101000 01100101 01101100 01101100 01101111 00100000 01110111 01101111
01110010 01101100 01100100
```
Tiáº¿p Ä‘Ãªn ta ná»‘i 1 sau chuá»—i nhá»‹ phÃ¢n.
```
01101000 01100101 01101100 01101100 01101111 00100000 01110111 01101111
01110010 01101100 01100100 1
```
Ná»‘i 0 cho Ä‘áº¿n khi dá»¯ liá»‡u lÃ  bá»™i sá»‘ cá»§a 512, Ã­t hÆ¡n 64 bit (á» Ä‘Ã¢y cá»§a mÃ¬nh lÃ  448 bit).
```
01101000 01100101 01101100 01101100 01101111 00100000 01110111 01101111
01110010 01101100 01100100 10000000 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
```
Ná»‘i 64 bit vÃ o cuá»‘i, trong Ä‘Ã³ 64 bit lÃ  sá»‘ nguyÃªn big-endian Ä‘áº¡i diá»‡n cho Ä‘á»™ dÃ i cá»§a Ä‘áº§u vÃ o ban Ä‘áº§u á»Ÿ dáº¡ng nhá»‹ phÃ¢n. á» Ä‘Ã¢y cá»§a mÃ¬nh lÃ  88 hoáº·c trong há»‡ nhá»‹ phÃ¢n lÃ  â€œ1011000â€.
```
01101000 01100101 01101100 01101100 01101111 00100000 01110111 01101111
01110010 01101100 01100100 10000000 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000000 01011000
```
BÃ¢y giá» Ä‘Ã£ cÃ³ Ä‘áº§u vÃ o cá»§a mÃ¬nh, vÃ  Ä‘áº§u vÃ o Ä‘Ã³ sáº½ luÃ´n chia háº¿t cho **512**.
## Khá»Ÿi táº¡o GiÃ¡ trá»‹ bÄƒm (h)
BÃ¢y giá» chÃºng ta táº¡o 8 giÃ¡ trá»‹ bÄƒm. ÄÃ¢y lÃ  cÃ¡c háº±ng sá»‘ Ä‘Æ°á»£c mÃ£ hÃ³a cá»©ng Ä‘áº¡i diá»‡n cho 32 bit Ä‘áº§u tiÃªn cá»§a pháº§n phÃ¢n sá»‘ cá»§a cÄƒn báº­c hai cá»§a 8 sá»‘ nguyÃªn tá»‘ Ä‘áº§u tiÃªn: **2**, **3**, **5**, **7**, **11**, **13**, **17**, **19**.
```
h0 := 0x6a09e667
h1 := 0xbb67ae85
h2 := 0x3c6ef372
h3 := 0xa54ff53a
h4 := 0x510e527f
h5 := 0x9b05688c
h6 := 0x1f83d9ab
h7 := 0x5be0cd19
```
## Khá»Ÿi táº¡o Háº±ng sá»‘ trÃ²n (k)
TÆ°Æ¡ng tá»± nhÆ° trÃªn Ä‘Ã¢y, á»Ÿ Ä‘Ã¢y ta táº¡o má»™t sá»‘ háº±ng sá»‘ (TÃ¬m hiá»ƒu thÃªm vá» háº±ng sá»‘ vÃ  khi nÃ o sá»­ dá»¥ng chÃºng). Láº§n nÃ y chÃºng ta cÃ³ 64 háº±ng sá»‘, má»—i giÃ¡ trá»‹ (0-63) lÃ  32 bit Ä‘áº§u tiÃªn cá»§a cÃ¡c pháº§n phÃ¢n sá»‘ cá»§a cÄƒn báº­c hai cá»§a 64 sá»‘ nguyÃªn tá»‘ Ä‘áº§u tiÃªn (2 - 311).
```
0x428a2f98 0x71374491 0xb5c0fbcf 0xe9b5dba5 0x3956c25b 0x59f111f1 0x923f82a4 0xab1c5ed5
0xd807aa98 0x12835b01 0x243185be 0x550c7dc3 0x72be5d74 0x80deb1fe 0x9bdc06a7 0xc19bf174
0xe49b69c1 0xefbe4786 0x0fc19dc6 0x240ca1cc 0x2de92c6f 0x4a7484aa 0x5cb0a9dc 0x76f988da
0x983e5152 0xa831c66d 0xb00327c8 0xbf597fc7 0xc6e00bf3 0xd5a79147 0x06ca6351 0x14292967
0x27b70a85 0x2e1b2138 0x4d2c6dfc 0x53380d13 0x650a7354 0x766a0abb 0x81c2c92e 0x92722c85
0xa2bfe8a1 0xa81a664b 0xc24b8b70 0xc76c51a3 0xd192e819 0xd6990624 0xf40e3585 0x106aa070
0x19a4c116 0x1e376c08 0x2748774c 0x34b0bcb5 0x391c0cb3 0x4ed8aa4a 0x5b9cca4f 0x682e6ff3
0x748f82ee 0x78a5636f 0x84c87814 0x8cc70208 0x90befffa 0xa4506ceb 0xbef9a3f7 0xc67178f2
```
## VÃ²ng láº·p Chunk
CÃ¡c bÆ°á»›c sau sáº½ xáº£y ra cho má»—i "Ä‘oáº¡n" dá»¯ liá»‡u 512-bit tá»« Ä‘áº§u vÃ o cá»§a mÃ¬nh. á» Ä‘Ã¢y, vÃ¬ â€œhello worldâ€ quÃ¡ ngáº¯n, nÃªn mÃ¬nh chá»‰ cÃ³ má»™t Ä‘oáº¡n. Táº¡i má»—i láº§n láº·p láº¡i cá»§a vÃ²ng láº·p, mÃ¬nh sáº½ thay Ä‘á»•i cÃ¡c giÃ¡ trá»‹ bÄƒm h0-h7 vÃ  Ä‘Ã¢y sáº½ lÃ  Ä‘áº§u ra.
## Táº¡o lá»‹ch trÃ¬nh nháº¯n tin (w)
Sao chÃ©p dá»¯ liá»‡u Ä‘áº§u vÃ o tá»« bÆ°á»›c 1 vÃ o má»™t máº£ng má»›i trong Ä‘Ã³ má»—i má»¥c nháº­p lÃ  má»™t tá»« 32 bit:
```
01101000011001010110110001101100 01101111001000000111011101101111
01110010011011000110010010000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000001011000
```
ThÃªm 48 tá»« khÃ¡c Ä‘Æ°á»£c khá»Ÿi táº¡o báº±ng 0, nhÆ° váº­y lÃ  cÃ³ má»™t máº£ng w[0â€¦ 63]
```
01101000011001010110110001101100 01101111001000000111011101101111
01110010011011000110010010000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000001011000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
...
...
00000000000000000000000000000000 00000000000000000000000000000000
```
Sá»­a Ä‘á»•i cÃ¡c chá»‰ má»¥c zero-ed á»Ÿ cuá»‘i máº£ng báº±ng cÃ¡ch sá»­ dá»¥ng thuáº­t toÃ¡n sau:
Äá»‘i vá»›i mÃ¬nh tá»« w[16â€¦ 63]:
* s0 = (w[i-15] rightrotate 7) xor (w[i-15] rightrotate 18) xor (w[i-15] rightshift 3)
* s1 = (w[i- 2] rightrotate 17) xor (w[i- 2] rightrotate 19) xor (w[i- 2] rightshift 10)
* w[i] = w[i-16] + s0 + w[i-7] + s1

Vá»›i [16] hÃ£y xem cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a nÃ³ nhÆ° tháº¿ nÃ o.
```
w[1] rightrotate 7:
  01101111001000000111011101101111 -> 11011110110111100100000011101110
w[1] rightrotate 18:
  01101111001000000111011101101111 -> 00011101110110111101101111001000
w[1] rightshift 3:
  01101111001000000111011101101111 -> 00001101111001000000111011101101

s0 = 11011110110111100100000011101110 XOR 00011101110110111101101111001000 XOR 00001101111001000000111011101101

s0 = 11001110111000011001010111001011

w[14] rightrotate 17:
  00000000000000000000000000000000 -> 00000000000000000000000000000000
w[14] rightrotate19:
  00000000000000000000000000000000 -> 00000000000000000000000000000000
w[14] rightshift 10:
  00000000000000000000000000000000 -> 00000000000000000000000000000000

s1 = 00000000000000000000000000000000 XOR 00000000000000000000000000000000 XOR 00000000000000000000000000000000

s1 = 00000000000000000000000000000000

w[16] = w[0] + s0 + w[9] + s1

w[16] = 01101000011001010110110001101100 + 11001110111000011001010111001011 + 00000000000000000000000000000000 + 00000000000000000000000000000000

// MÃ¬nh bá»• sung thÃªm Ä‘Æ°á»£c tÃ­nh theo modulo 2 ^ 32

w[16] = 00110111010001110000001000110111
```
Äiá»u nÃ y Ä‘á»ƒ láº¡i cho mÃ¬nh 64 tá»« trong ná»™i dung thÃ´ng bÃ¡o (w):
```
01101000011001010110110001101100 01101111001000000111011101101111
01110010011011000110010010000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000000000000
00000000000000000000000000000000 00000000000000000000000001011000
00110111010001110000001000110111 10000110110100001100000000110001
11010011101111010001000100001011 01111000001111110100011110000010
00101010100100000111110011101101 01001011001011110111110011001001
00110001111000011001010001011101 10001001001101100100100101100100
01111111011110100000011011011010 11000001011110011010100100111010
10111011111010001111011001010101 00001100000110101110001111100110
10110000111111100000110101111101 01011111011011100101010110010011
00000000100010011001101101010010 00000111111100011100101010010100
00111011010111111110010111010110 01101000011001010110001011100110
11001000010011100000101010011110 00000110101011111001101100100101
10010010111011110110010011010111 01100011111110010101111001011010
11100011000101100110011111010111 10000100001110111101111000010110
11101110111011001010100001011011 10100000010011111111001000100001
11111001000110001010110110111000 00010100101010001001001000011001
00010000100001000101001100011101 01100000100100111110000011001101
10000011000000110101111111101001 11010101101011100111100100111000
00111001001111110000010110101101 11111011010010110001101111101111
11101011011101011111111100101001 01101010001101101001010100110100
00100010111111001001110011011000 10101001011101000000110100101011
01100000110011110011100010000101 11000100101011001001100000111010
00010001010000101111110110101101 10110000101100000001110111011001
10011000111100001100001101101111 01110010000101111011100000011110
10100010110101000110011110011010 00000001000011111001100101111011
11111100000101110100111100001010 11000010110000101110101100010110
```
## NÃ©n
* Khá»Ÿi táº¡o cÃ¡c biáº¿n **a**, **b**, **c**, **d**, **e**, **f**, **g**, **h** vÃ  Ä‘áº·t chÃºng báº±ng cÃ¡c giÃ¡ trá»‹ bÄƒm hiá»‡n táº¡i tÆ°Æ¡ng á»©ng. **h0**, **h1**, **h2**, **h3**, **h4**, **h5**, **h6**, **h7**
* Cháº¡y vÃ²ng láº·p nÃ©n. VÃ²ng láº·p nÃ©n sáº½ thay Ä‘á»•i cÃ¡c giÃ¡ trá»‹ tá»« **aâ€¦h**. VÃ²ng láº·p nÃ©n nhÆ° sau:
    * Tá»« 0 Ä‘áº¿n 63
        * S1 = (e rightrotate 6) xor (e rightrotate 11) xor (e rightrotate 25)
        * ch = (e and f) xor ((not e) and g)
        * temp1 = h + S1 + ch + k[i] + w[i]
        * S0 = (a rightrotate 2) xor (a rightrotate 13) xor (a rightrotate 22)
        * maj = (a and b) xor (a and c) xor (b and c)
        * temp2 := S0 + maj
        * h = g
        * g = f
        * f = e
        * e = d + temp1
        * d = c
        * c = b
        * b = a
        * a = temp1 + temp2

HÃ£y xem qua láº§n láº·p Ä‘áº§u tiÃªn, táº¥t cáº£ phÃ©p cá»™ng Ä‘Æ°á»£c tÃ­nh theo modulo 2 ^ 32:
```
a = 0x6a09e667 = 01101010000010011110011001100111
b = 0xbb67ae85 = 10111011011001111010111010000101
c = 0x3c6ef372 = 00111100011011101111001101110010
d = 0xa54ff53a = 10100101010011111111010100111010
e = 0x510e527f = 01010001000011100101001001111111
f = 0x9b05688c = 10011011000001010110100010001100
g = 0x1f83d9ab = 00011111100000111101100110101011
h = 0x5be0cd19 = 01011011111000001100110100011001

e rightrotate 6:
  01010001000011100101001001111111 -> 11111101010001000011100101001001
e rightrotate 11:
  01010001000011100101001001111111 -> 01001111111010100010000111001010
e rightrotate 25:
  01010001000011100101001001111111 -> 10000111001010010011111110101000
S1 = 11111101010001000011100101001001 XOR 01001111111010100010000111001010 XOR 10000111001010010011111110101000
S1 = 00110101100001110010011100101011

e and f:
    01010001000011100101001001111111
  & 10011011000001010110100010001100 =
    00010001000001000100000000001100
not e:
  01010001000011100101001001111111 -> 10101110111100011010110110000000
(not e) and g:
    10101110111100011010110110000000
  & 00011111100000111101100110101011 =
    00001110100000011000100110000000
ch = (e and f) xor ((not e) and g)
   = 00010001000001000100000000001100 xor 00001110100000011000100110000000
   = 00011111100001011100100110001100

// k[i] lÃ  háº±ng sá»‘ vÃ²ng
// w[i] lÃ  batch
temp1 = h + S1 + ch + k[i] + w[i]
temp1 = 01011011111000001100110100011001 + 00110101100001110010011100101011 + 00011111100001011100100110001100 + 01000010100010100010111110011000 + 01101000011001010110110001101100
temp1 = 01011011110111010101100111010100

a rightrotate 2:
  01101010000010011110011001100111 -> 11011010100000100111100110011001
a rightrotate 13:
  01101010000010011110011001100111 -> 00110011001110110101000001001111
a rightrotate 22:
  01101010000010011110011001100111 -> 00100111100110011001110110101000
S0 = 11011010100000100111100110011001 XOR 00110011001110110101000001001111 XOR 00100111100110011001110110101000
S0 = 11001110001000001011010001111110

a and b:
    01101010000010011110011001100111
  & 10111011011001111010111010000101 =
    00101010000000011010011000000101
a and c:
    01101010000010011110011001100111
  & 00111100011011101111001101110010 =
    00101000000010001110001001100010
b and c:
    10111011011001111010111010000101
  & 00111100011011101111001101110010 =
    00111000011001101010001000000000
maj = (a and b) xor (a and c) xor (b and c)
    = 00101010000000011010011000000101 xor 00101000000010001110001001100010 xor 00111000011001101010001000000000 
    = 00111010011011111110011001100111

temp2 = S0 + maj
      = 11001110001000001011010001111110 + 00111010011011111110011001100111
      = 00001000100100001001101011100101

h = 00011111100000111101100110101011
g = 10011011000001010110100010001100
f = 01010001000011100101001001111111
e = 10100101010011111111010100111010 + 01011011110111010101100111010100
  = 00000001001011010100111100001110
d = 00111100011011101111001101110010
c = 10111011011001111010111010000101
b = 01101010000010011110011001100111
a = 01011011110111010101100111010100 + 00001000100100001001101011100101
  = 01100100011011011111010010111001
```
ToÃ n bá»™ phÃ©p tÃ­nh Ä‘Ã³ Ä‘Æ°á»£c thá»±c hiá»‡n thÃªm 63 láº§n ná»¯a, sá»­a Ä‘á»•i cÃ¡c biáº¿n a-h trong suá»‘t. ChÃºng tÃ´i sáº½ khÃ´ng lÃ m Ä‘iá»u Ä‘Ã³ báº±ng tay nhÆ°ng chÃºng tÃ´i sáº½ káº¿t thÃºc báº±ng:
```
h0 = 6A09E667 = 01101010000010011110011001100111
h1 = BB67AE85 = 10111011011001111010111010000101
h2 = 3C6EF372 = 00111100011011101111001101110010
h3 = A54FF53A = 10100101010011111111010100111010
h4 = 510E527F = 01010001000011100101001001111111
h5 = 9B05688C = 10011011000001010110100010001100
h6 = 1F83D9AB = 00011111100000111101100110101011
h7 = 5BE0CD19 = 01011011111000001100110100011001

a = 4F434152 = 01001111010000110100000101010010
b = D7E58F83 = 11010111111001011000111110000011
c = 68BF5F65 = 01101000101111110101111101100101
d = 352DB6C0 = 00110101001011011011011011000000
e = 73769D64 = 01110011011101101001110101100100
f = DF4E1862 = 11011111010011100001100001100010
g = 71051E01 = 01110001000001010001111000000001
h = 870F00D0 = 10000111000011110000000011010000
```
## Sá»­a Ä‘á»•i giÃ¡ trá»‹
Sau khi vÃ²ng láº·p nÃ©n, á»Ÿ trÃªn trong vÃ²ng láº·p chunk, mÃ¬nh sá»­a Ä‘á»•i cÃ¡c giÃ¡ trá»‹ bÄƒm báº±ng cÃ¡ch thÃªm cÃ¡c biáº¿n tÆ°Æ¡ng á»©ng **a-h**. VÃ  táº¥t cáº£ cÃ¡c phÃ©p cá»™ng á»Ÿ Ä‘Ã¢y Ä‘á»u lÃ  modulo 2 ^ 32.
```
h0 = h0 + a = 10111001010011010010011110111001
h1 = h1 + b = 10010011010011010011111000001000
h2 = h2 + c = 10100101001011100101001011010111
h3 = h3 + d = 11011010011111011010101111111010
h4 = h4 + e = 11000100100001001110111111100011
h5 = h5 + f = 01111010010100111000000011101110
h6 = h6 + g = 10010000100010001111011110101100
h7 = h7 + h = 11100010111011111100110111101001
```
## Káº¿t há»£p BÄƒm cuá»‘i cÃ¹ng
Cuá»‘i cÃ¹ng ghÃ©p táº¥t cáº£ láº¡i vá»›i nhau vÃ  tÃ¨n tÃ¨n, ta cÃ³ má»™t phÃ©p ná»‘i chuá»—i Ä‘Æ¡n giáº£n.
```
digest = h0 append h1 append h2 append h3 append h4 append h5 append h6 append h7 = B94D27B9934D3E08A52E52D7DA7DABFAC484EFE37A5380EE9088F7ACE2EFCDE9
```
Xong! MÃ¬nh Ä‘Ã£ xem qua tá»«ng bÆ°á»›c (khÃ´ng cÃ³ má»™t sá»‘ láº§n láº·p láº¡i) cá»§a SHA-256 vá»›i chi tiáº¿t tuyá»‡t vá»i ğŸ™‚
# Káº¿t luáº­n
Náº¿u báº¡n muá»‘n xem táº¥t cáº£ cÃ¡c bÆ°á»›c mÃ¬nh vá»«a lÃ m á»Ÿ trÃªn, thÃ¬ Ä‘Ã¢y mÃ¬nh sáº½ giáº£i thÃ­ch rÃµ hÆ¡n:
```
BÆ°á»›c 1: Táº¥t cáº£ cÃ¡c biáº¿n lÃ  sá»‘ nguyÃªn khÃ´ng dáº¥u 32 bit vÃ  phÃ©p cá»™ng Ä‘Æ°á»£c tÃ­nh theo modulo 2 ^ 32
BÆ°á»›c 2: Äá»‘i vá»›i má»—i vÃ²ng láº·p, cÃ³ má»™t háº±ng sá»‘ vÃ²ng k[i] vÃ  má»™t má»¥c nháº­p trong máº£ng thÃ´ng bÃ¡o w[i], 0 â‰¤ i â‰¤ 63
BÆ°á»›c 3: Sá»­ dá»¥ng 8 biáº¿n tá»« a Ä‘áº¿n h
BÆ°á»›c 4: Sá»­ dá»¥ng quy Æ°á»›c big-endian khi biá»ƒu thá»‹ cÃ¡c háº±ng sá»‘ trong mÃ£ hÃ³a nÃ y, vÃ  khi phÃ¢n tÃ­ch cÃº phÃ¡p tin nháº¯n sáº½ cháº·n dá»¯ liá»‡u tá»« byte thÃ nh tá»«, **VÃ­ dá»¥:** tá»« Ä‘áº§u tiÃªn cá»§a tin nháº¯n Ä‘áº§u vÃ o "abc" sau pháº§n Ä‘á»‡m lÃ  0x61626380

Khá»Ÿi táº¡o giÃ¡ trá»‹ bÄƒm (32 bit Ä‘áº§u tiÃªn cá»§a pháº§n phÃ¢n sá»‘ cá»§a cÄƒn báº­c hai cá»§a 8 sá»‘ nguyÃªn tá»‘ Ä‘áº§u tiÃªn 2..19):
h0 := 0x6a09e667
h1 := 0xbb67ae85
h2 := 0x3c6ef372
h3 := 0xa54ff53a
h4 := 0x510e527f
h5 := 0x9b05688c
h6 := 0x1f83d9ab
h7 := 0x5be0cd19

Khá»Ÿi táº¡o máº£ng cÃ¡c háº±ng sá»‘ vÃ²ng (32 bit Ä‘áº§u tiÃªn cá»§a pháº§n phÃ¢n sá»‘ cá»§a cÄƒn báº­c hai cá»§a 64 sá»‘ nguyÃªn tá»‘ Ä‘áº§u tiÃªn 2..311):
k[0..63] :=
   0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
   0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
   0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
   0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
   0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
   0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
   0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
   0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2

Pre-processing (Padding):
Báº¯t Ä‘áº§u vá»›i ná»™i dung cÃ³ Ä‘á»™ dÃ i L bit
Ná»‘i bit '1' duy nháº¥t
Ná»‘i K '0' bit, trong Ä‘Ã³ K lÃ  sá»‘ nhá» nháº¥t >= 0 sao cho L + 1 + K + 64 lÃ  bá»™i sá»‘ cá»§a 512
ThÃªm L dÆ°á»›i dáº¡ng sá»‘ nguyÃªn big-endian 64bit, lÃ m cho tá»•ng Ä‘á»™ dÃ i sau xá»­ lÃ½ lÃ  bá»™i sá»‘ cá»§a 512bit

Xá»­ lÃ½ tin nháº¯n theo cÃ¡c pháº§n 512bit liÃªn tiáº¿p, chia nhá» tin nháº¯n thÃ nh cÃ¡c Ä‘oáº¡n 512bit
for each chunk
    create a 64-entry message schedule array w[0..63] of 32-bit words
    (CÃ¡c giÃ¡ trá»‹ ban Ä‘áº§u trong w[0..63] khÃ´ng quan trá»ng) sao chÃ©p Ä‘oáº¡n vÃ o 16 tá»« Ä‘áº§u tiÃªn w[0..15] cá»§a máº£ng tin nháº¯n

    KÃ©o dÃ i 16 tá»« Ä‘áº§u tiÃªn thÃ nh 48 tá»« cÃ²n láº¡i w[16..63] cá»§a máº£ng tin nháº¯n:
    for i from 16 to 63
        s0 := (w[i-15] rightrotate  7) xor (w[i-15] rightrotate 18) xor (w[i-15] rightshift  3)
        s1 := (w[i- 2] rightrotate 17) xor (w[i- 2] rightrotate 19) xor (w[i- 2] rightshift 10)
        w[i] := w[i-16] + s0 + w[i-7] + s1

    Khá»Ÿi táº¡o cÃ¡c biáº¿n thÃ nh giÃ¡ trá»‹ bÄƒm hiá»‡n táº¡i:
    a := h0
    b := h1
    c := h2
    d := h3
    e := h4
    f := h5
    g := h6
    h := h7

    NÃ©n vÃ²ng láº·p chÃ­nh:
    for i from 0 to 63
        S1 := (e rightrotate 6) xor (e rightrotate 11) xor (e rightrotate 25)
        ch := (e and f) xor ((not e) and g)
        temp1 := h + S1 + ch + k[i] + w[i]
        S0 := (a rightrotate 2) xor (a rightrotate 13) xor (a rightrotate 22)
        maj := (a and b) xor (a and c) xor (b and c)
        temp2 := S0 + maj
 
        h := g
        g := f
        f := e
        e := d + temp1
        d := c
        c := b
        b := a
        a := temp1 + temp2

    ThÃªm Ä‘oáº¡n Ä‘Ã£ nÃ©n vÃ o giÃ¡ trá»‹ bÄƒm hiá»‡n táº¡i:
    h0 := h0 + a
    h1 := h1 + b
    h2 := h2 + c
    h3 := h3 + d
    h4 := h4 + e
    h5 := h5 + f
    h6 := h6 + g
    h7 := h7 + h

Táº¡o giÃ¡ trá»‹ bÄƒm cuá»‘i cÃ¹ng (big-endian): digest: = hash: = h0 append h1 append h2 append h3 append h4 append h5 append h6 append h7
```