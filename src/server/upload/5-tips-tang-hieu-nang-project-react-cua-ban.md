![](https://images.viblo.asia/e05228c4-ab3f-4c2c-a39e-78ef1d9fe58d.jpg)

## 1. Use `memo` v√† `PureComponent`

H√£y th·ª≠ xem qua v√≠ d·ª• b√™n d∆∞·ªõi nh√©, b·∫°n c√≥ nghƒ© r·∫±ng, `ComponentB` s·∫Ω re-render l·∫°i kh√¥ng n·∫øu ta ch·ªâ thay ƒë·ªïi m·ªói `props.propA`
    
```
import React from 'react';

const MyApp = (props) => {
  return (
    <div>
      <ComponentA propA={props.propA}/>
      <ComponentB propB={props.propB}/>
    </div>
  );
};

const ComponentA = (props) => {
  return <div>{props.propA}</div>
};

const ComponentB = (props) => {
  return <div>{props.propB}</div>
};
    
```
    
C√¢u tr·∫£ l·ªùi b·∫•t ng·ªù l√† c√≥ ƒë·∫•y, t·∫°i sao v·∫≠y, t√¥i ch·ªâ thay ƒë·ªïi gi√° `prop` trong `componentA` th√¥i m√†, t·∫°i sao `componentB`c≈©ng re-render l·∫°i, nh∆∞ v·∫≠y th√¨ qu√° l√† t·ªën t√†i nguy√™n
    
B·ªùi v√¨ `MyApp` nh·∫≠n th·∫•y r·∫±ng `<ComponentA>` c√≥ s·ª± thay ƒë·ªïi, n√™n `MyApp` quy·∫øt ƒë·ªãnh re-render l·∫°i, m·∫∑c d√π c√°c `props` c·ªßa `<ComponentB>` v·∫´n gi·ªØ nguy√™n, nh∆∞ng parent c·ªßa n√≥ l√† `MyApp` re-render, n√™n n√≥ c≈©ng b·ªã re-render theo
   
C√°c nh√† ph√°t tri·ªÉn React nh·∫≠n th·∫•y ƒëi·ªÅu n√†y l√† kh√¥ng ph√π h·ª£p v√† khi·∫øn cho hi·ªáu su·∫•t c·ªßa b·ªã gi·∫£m ƒëi ƒë√°ng k·ªÉ
    
V√† ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ tr√™n, h·ªç so s√°nh `props` c≈© v√† m·ªõi c·ªßa t·ª´ng component con tr∆∞·ªõc khi re-render l·∫°i, ƒë√≥ th·ª±c ch·∫•t l√† nh·ªØng g√¨ React.memo v√† React.PureComponent ƒë∆∞·ª£c ra ƒë·ªùi 
    
H√£y b·∫Øt ƒë·∫ßu v·ªõi `React.memo` trong `stateless`:

```
import React, { memo } from 'react';

// Bad
const ComponentB = (props) => {
  return <div>{props.propB}</div>
};

// Good
const ComponentB = memo((props) => {
  return <div>{props.propB}</div>
});
    
```

·ªû ph·∫ßn code b√™n d∆∞·ªõi ch√≠nh l√† `memo`, ch·ªâ ƒë∆°n gi·∫£n l√† ch√∫ng ra s·∫Ω b·ªçc `<ComponentB>` v·ªõi `memo`
    
`<ComponentB>` ch·ªâ re-render l·∫°i khi g√≠a tr·ªã c·ªßa `propB` thay ƒë·ªïi, b·∫•p k·ªÉ `MyApp` thay ƒë·ªïi bao nhi√™u l·∫ßn

B√¢y gi·ªù ch√∫ng ta s·∫Ω ti·∫øp t·ª•c v·ªõi `PureComponent`, n√≥ ph√π h·ª£p v·ªõi `stateful`
    
```
import React, { Component, PureComponent } from 'react';

// Bad
class ComponentB extends Component {
  render() {
    return <div>{this.props.propB}</div>
  }
}

// Good
class ComponentB extends PureComponent {
  render() {
    return <div>{this.props.propB}</div>
  }
}
```

Hi·ªáu su·∫•t c·ªßa project tƒÉng ƒë√°ng kinh ng·∫°c v·ªõi nh∆∞ng b·∫°n ƒë√£ bao gi·ªù t·ª± h·ªèi, t·∫°i sao React l·∫°i kh√¥ng ƒë·ªÉ t·ª± ƒë·ªông c√°c `memo`, `PureComponent` ƒë·ªÉ tr√°nh vi·ªác re-render n√†y l·∫°i

Th·ª±c s·ª± th√¨ vi·ªác so s√°nh gi·ªØa `props` c≈© v√† m·ªõi ch√≠nh l√† n√∫t th·∫Øt trong vi·ªác t·ªëi ∆∞u performance hi·ªán t·∫°i
    
L·∫•y v√≠ d·ª• nh∆∞ l√† ta c√≥ m·ªôt `props` c·ª±c l·ªõn v√† thay ƒë·ªïi li√™n t·ª•c, b√™n c·∫°nh vi·ªác re-render l·∫°i, React c√≤n t·ªën hi·ªáu nƒÉng cho vi·ªác so s√°nh c√°c props thay ƒë·ªïi v·ªõi nhau

H∆°n n·ªØa, ph∆∞∆°ng th·ª©c `shouldComponentUpdate()` c·ªßa `React.PureComponent` b·ªè qua vi·ªác c·∫≠p nh·∫≠t prop cho to√†n b·ªô c√°c component con. N√™n h√£y ch·∫Øc ch·∫Øn r·∫±ng c√°c component con c≈©ng l√† ‚Äúpure‚Äù.

Ngo√†i ra, React c≈©ng t·∫°o ra m·ªôt hook t∆∞∆°ng ƒë∆∞∆°ng v·ªõi `React.memo` l√† [useMemo](https://reactjs.org/docs/hooks-reference.html#usememo)

    
## 2. Avoid Anonymous Functions

C√°c function b√™n trong body c·ªßa component th∆∞·ªùng ƒëu·ª£c g·∫Øn v·ªõi c√°c `event handler` ho·∫∑c `callbacks`
    
Trong nhi·ªÅu tr∆∞·ªùng h·ª£p, c√°c function n√†y kh√¥ng ƒë∆∞·ª£c ƒë·ªãnh danh, hay c√≤n ƒë∆∞·ª£c g·ªçi l√† `anonymous function`
   
```
import React from 'react';

function Foo() {
  return (
    <button onClick={() => console.log('boop')}> // üôÖ‚Äç‚ôÄÔ∏è
      BOOP
    </button>
  );
}    
```

C√≥ th·ªÉ th·∫•y r·∫±ng function tr√™n ƒë√£ kh√¥ng ƒë∆∞·ª£c g√°n m·ªôt ƒë·ªãnh danh (khai b√°o th√¥ng qua const/let/var), ƒëi·ªÅu n√†y khi·∫øn Javascript ph√¢n b·ªèo b·ªô nh·ªõ m·ªói l·∫ßn re-render l·∫°i thay v√¨ ch·ªâ ph√¢n b·ªë m·ªôt √¥ nh·ªõ duy nh·∫•t m·ªôt l·∫ßn khi s·ª≠ d·ª•ng c√°c h√†m n√†y

C√≥ 2 c√°ch ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y, m·ªôt l√† ƒë·∫∑t t√™n function ƒë√≥ v√† ƒë·ªÉ n√≥ n·∫±m ngo√†i component
    
```
import React, { useCallback } from 'react';

// Variation 1: naming and placing handler outside the component 
const handleClick = () => console.log('boop');
function Foo() {
  return (
    <button onClick={handleClick}>  // üôÜ‚Äç‚ôÇÔ∏è
      BOOP
    </button>
  );
}

// Variation 2: "useCallback"
function Foo() {
  const handleClick = useCallback(() => console.log('boop'), []);
  return (
    <button onClick={handleClick}>  // üôÜ‚Äç‚ôÇÔ∏è
      BOOP
    </button>
  );
}
```
    
C√°ch th·ª© 2 l√† s·ª≠ dung hook `useCallback`

N√≥ c≈©ng gi·ªëng v·ªõi `useMemo`, tr√°nh vi·ªác re-render component con khi component cha re-render, [tham kh·∫£o th√™m](https://laptrinhx.com/han-che-re-render-khi-su-dung-react-hook-voi-memo-va-usecallback-1722328189/)
    
V·ªõi stateless th√¨ ta d√πng `useCallback`, c√≤n stateful th√¨ ta s·∫Ω x·ª≠ l√≠ nh∆∞ sau:
    
```
import React from 'react';

//Bad
class Foo extends Component {
  render() {
    return (
      <button onClick={() => console.log('boop')}> 
        BOOP
      </button>
    );
  }
}

//Good
class Foo extends Component {
  render() {
    return (
      <button onClick={this.handleClick}>
        BOOP
      </button>
    );
  }
  handleClick = () => {  // this anonymous function is fine used like this
    console.log('boop');
  }
}
    
```
    
## 3. Avoid Object Literals
    
This performance tip is similar to the previous section about anonymous functions. Object literals don‚Äôt have a persistent memory space, so your component will need to allocate a new location in memory whenever the component re-renders:

Gi·ªëng v·ªõi v√≠ d·ª• ·ªü m·ª•c tr√™n, vi·ªác ph√¢n b·ªï c√°c thu·ªôc t√≠nh kh√¥ng ƒë∆∞·ª£c ƒë·ªãnh danh c≈©ng l√†m cho `Component` b·ªã re-render
    
```
function ComponentA() {
  return (
    <div>
      HELLO WORLD
      <ComponentB style={{  {/* üôÖ‚Äç‚ôÄÔ∏è */}
        color: 'blue',     
        background: 'gold'
      }}/>
    </div>
  );
}

function ComponentB(props) {
  return (
    <div style={this.props.style}>
      TOP OF THE MORNING TO YA
    </div>
  )
}
    
```
    
M·ªói l·∫ßn `<ComponentA>` ƒë∆∞·ª£c re-render, m·ªôt object literal (trong v√≠ d·ª• l√† style) ƒë∆∞·ª£c tao ra trong b·ªô nh·ªõ, ƒëi·ªÅu ƒë√≥ c√≥ nghƒ© l√† `<ComponentB>` c≈©ng nh·∫≠n ƒëu·ª£c gi√° tr·ªã kh√°c 
    
Trong tr∆∞·ªùng h·ª£p n√†y, ta c≈©ng n√™n s·ª≠ dung `useMemo` ho·∫∑c ƒë·ªÉ ph·∫ßn khai b√°o ra b√™n ngo√†i component 
    
```
const myStyle = {
  color: 'blue',     
  background: 'gold'
};

function ComponentA() {
  return (
    <div>
      HELLO WORLD
      <ComponentB style={myStyle}/>
    </div>
  );
}

function ComponentB(props) {
  return (
    <div style={this.props.style}>
      TOP OF THE MORNING TO YA
    </div>
  )
}    
```
    
## 4. Use `React.lazy` and `React.Suspense`

M·ªôt c√°ch kh√°c ƒë√™ cho ·ª©ng d·ª•ng React c·ªßa b·∫°n nhanh h∆°n ƒë√≥ l√† th·ª±c hi·ªán vi·ªác t√°ch m√£ (code-splitting). T√≠nh nƒÉng n√†y ƒë∆∞·ª£c gi·ªõi thi·ªáu cho React v16 v·ªõi React.lazy v√† React.Suspense.

N·∫øu b·∫°n kh√¥ng bi·∫øt, `code-splitting` l√† vi·ªác chia nh·ªè file th√†nh c√°c ph·∫ßn nh·ªè c·ªßa React, n·∫øu kh√¥ng t·ª± chia nh·ªè, file ƒë√≥ s·∫Ω r·∫•t l∆°n 
 
```   
- bundle.js (10MB!)
```

Khi s·ª≠ d·ª•ng `code-splitting`, gi√∫p cho file ban ƒë·∫ßu tr·ªü n√™n nh·ªè g·ªçn ƒë√°ng k·∫ø, s·∫Ω gi√∫p cho vi·ªác hi·ªÉn th·ªã, c≈©ng nh∆∞ request qua m·∫°ng ƒëu·ª£c d·ªÖ d√†ng h∆°n
    
```
- bundle-1.js (5MB)
- bundle-2.js (3MB)
- bundle-3.js (2MB)
```
    
V·ªõi vi·ªác chia nh·ªè, ch·ªâ c·∫ßn t·∫£i xu·ªëng 5MB ƒë·∫ßu ti√™n, ng∆∞·ªùi d√πng s·∫Ω th·∫•y ƒë∆∞·ª£c m·ªôt ph·∫ßn c·ªßa website hi·ªán ra, sau ƒë√≥ s·∫Ω ti·∫øp t·ª•c t·∫£i xu·ªëng
    
V√≠ d·ª• nh∆∞, m·ªôt trang web, vi·ªác ta chia ra t·∫£i ph·∫ßn header, footer tr∆∞·ªõc, sau ƒë√≥ s·∫Ω show nh∆∞ng d·ªØ li·ªáu ·ªü body ra sau, ng∆∞·ªùi d√πng s·∫Ω th√≠ch th√∫ h∆°n v·ªõi vi·ªác show m·ªôt l√∫c ra c·∫£ trang m√† ph·∫£i ch·ªù th·ªùi gian l√¢u h∆°n

**V·∫≠y, React s·ª≠ d·ª•ng `code-splitting` nh∆∞ th·∫ø n√†o?** 
    
N·∫øu b·∫°n ƒë√£ t·ª´ng s·ª≠ d·ª•ng [Create React App](https://create-react-app.dev/), th√¨ n√≥ th·ª±c s·ª± ƒë√£ ƒë·ª±oc c√†i ƒë·∫∑t m·∫∑c ƒë·ªãnh b√™n trong, vi·ªác c√≤n l·∫°i c·ªßa ta l√† s·ª≠ d·ª•ng `React.lazy` v√† `React.Suspense`
    
C√≤n n·∫øu b·∫°n t·ª± config, th√¨ n√≥ s·∫Ω tr√¥ng gi·ªëng nh∆∞ [n√†y](https://gist.github.com/gaearon/ca6e803f5c604d37468b0091d9959269)
    
D∆∞·ªõi ƒë√¢y l√† v√≠ d·ª• ƒë∆°n gian c·ªßa vi·ªác s·ª≠ d·ª•ng `React.lazy` v√† `React.Suspense`
    
```
import React, { lazy, Suspense } from 'react';
import Header from './Header';
import Footer from './Footer';
const BlogPosts = React.lazy(() => import('./BlogPosts'));

function MyBlog() {
  return (
    <div>
      <Header>
      <Suspense fallback={<div>Loading...</div>}>
        <BlogPosts />
      </Suspense>
      <Footer>
    </div>
  );
}
```

[Tham kh·∫£o th√™m ·ªü ƒë√¢y](https://alligator.io/react/code-splitting-with-react-suspense/)

## 5. Avoid Frequent Mounting/Unmounting
    
Ch√∫ng ra v·∫´n th∆∞·ªùng s·ª≠ d·ª•ng vi·ªác ki·ªÉm tra ·∫©n hi·ªán component b·∫±ng c√°c ph√©p to√°n t·ª≠ 3 ng√¥i
    
```
import React, { Component } from 'react';
import DropdownItems from './DropdownItems';

class Dropdown extends Component {
  state = {
    isOpen: false
  }
  render() {
    <a onClick={this.toggleDropdown}>
      Our Products
      {
        this.state.isOpen
          ? <DropdownItems>
          : null
      }
    </a>
  }
  toggleDropdown = () => {
    this.setState({isOpen: !this.state.isOpen})
  }
}
```

V√¨ <DropdownItems> b·ªã x√≥a kh·ªèi DOM, n√≥ c√≥ th·ªÉ g√¢y ra s·ª± l·∫∑p l·∫°i (x√≥a/r·ªìi l·∫°i hi·ªÉn th·ªã) b·ªüi tr√¨nh duy·ªát. Vi·ªác n√†y c≈©ng t·ªën kh√° nhi·ªÅu hi·ªáu nƒÉng, ƒë·∫∑c bi·ªát l√† n·∫øu n√≥ l√†m cho c√°c y·∫øu t·ªë HTML xung quanh kh√°c (sibling) thay ƒë·ªïi
        
ƒê·ªÉ gi·∫£m thi·ªÉu t·ªën k√©m k·ªÉ tr√™n, ta n√™n tr√°nh c√°c tr∆∞·ªùng `unmounting` component ·ªü nh·ªØng tr∆∞·ªùng h·ª£p thay ƒë·ªïi li√™n t·ª•c (v√≠ d·ª• nh∆∞ click ƒë·ªÉ hi·ªán th·ªã ra list s·∫£n ph·∫©m l·ªõn ƒë√£ k·ªÉ b√™n tr√™n)
        
Thay v√†o ƒë√≥, ta n√™n thay ƒë·ªïi css `visibility: hidden` ho·∫∑c `display: none` ƒë·ªÉ tr√°nh vi·ªác thay ƒë·ªïi, load DOM li√™n t·ª•c.

## 6. K·∫øt lu·∫≠n
        
Tr√™n ƒë√¢y l√† t√¨m hi·ªÉu c·ªßa m√¨nh v·ªÅ 5 tips gi√∫p tƒÉng hi·ªáu nƒÉng c·ªßa ·ª©ng d·ª•ng react, mong l√† s·∫Ω gi√∫p √≠ch ƒë∆∞·ª£c cho m·ªçi ng∆∞·ªùi
        
C·∫£m ∆°n m·ªçi ng∆∞·ªùi ƒë√£ theo d√µi.
        
T√†i li√™u tham kh·∫£o: 
        
[Pure component](https://alligator.io/react/performance-boost-purecomponent/)
        
[S·ª≠ d·ª•ng useCallBack, useMemo](https://laptrinhx.com/han-che-re-render-khi-su-dung-react-hook-voi-memo-va-usecallback-1722328189/)
        
[Code Splitting with React Suspense](https://alligator.io/react/code-splitting-with-react-suspense/)
        
[Keep react fast](https://alligator.io/react/keep-react-fast/)