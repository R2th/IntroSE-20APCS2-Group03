Xin chÃ o cÃ¡c báº¡n, láº¡i lÃ  Quang Ä‘Ã¢y ğŸ˜

HÃ´m nay, mÃ¬nh láº¡i lÃªn Ä‘Ã¢y vÃ  chia sáº» cho cÃ¡c báº¡n vá» cÃ¡ch mÃ¬nh dÃ¹ng Telegram nháº­n tin nháº¯n dá»± bÃ¡o thá»i tiáº¿t thÃ´ng qua Telegram Bot API.

VÃ  khÃ´ng Ä‘á»ƒ cÃ¡c báº¡n Ä‘á»£i lÃ¢u, mÃ¬nh xin báº¯t Ä‘áº§u ngay!

Äáº§u tiÃªn, báº¡n cáº§n cÃ³ 1 tÃ i khoáº£n telegram, viá»‡c Ä‘Äƒng kÃ½ khÃ¡ Ä‘Æ¡n giáº£n, vÃ¬ háº§u nhÆ° telegram thÃ¬ nÃ³ cÅ©ng Ä‘Ã£ khÃ¡ phá»• biáº¿n rá»“i, nháº¥t lÃ  Ä‘á»‘i vá»›i cÃ¡c dev, dÃ¢n chÆ¡i coin... thÃ¬ telegram cÃ ng gáº§n gÅ©i, ngoÃ i cÃ¡c lá»›p há»c chia sáº» tÃ i liá»‡u há»c táº­p Ä‘Ãªm khuya, thÃ¬ trÃªn telegram cÃ²n cÃ³ nhiá»u thá»© hay ho Ä‘á»ƒ cho cÃ¡c báº¡n tÃ¬m hiá»ƒu, thÃ´i mÃ¬nh nÃ³i váº­y lÃ  cÃ¡c báº¡n hiá»ƒu rá»“i chá»© khÃ´ng máº¥t cÃ´ng láº¡i nÃ³i mÃ¬nh nhiá»u chuyá»‡n ğŸ¤£

Gáº¡t qua cÃ¡c váº¥n Ä‘á» lan man trÃªn, khi báº¡n Ä‘Ã£ cÃ³ má»™t tÃ i khoáº£n trÃªn telegram rá»“i thÃ¬ Ä‘iá»u tiáº¿p theo, lÃ  chÃºng ta cáº§n táº¡o 1 channel trÃªn tÃ i khoáº£n telegram cá»§a mÃ¬nh, channel nÃ y sáº½ dÃ¹ng Ä‘á»ƒ sá»­ dá»¥ng chá»©c nÄƒng nháº­n tin nháº¯n khi tele bot gá»­i lá»‡nh vÃ o ğŸ˜ƒ

CÃ¡ch táº¡o channel thÃ¬ cÅ©ng khÃ¡ Ä‘Æ¡n giáº£n, cÃ¡c báº¡n má»Ÿ telegram lÃªn, á»Ÿ Ä‘Ã¢y mÃ¬nh lÃ m trÃªn telegram phiÃªn báº£n desktop ( mÃ¡y tÃ­nh cÃ¡ nhÃ¢n) nhÃ©, trÃªn mobile cÅ©ng tÆ°Æ¡ng tá»± thÃ´i.

![](https://images.viblo.asia/4850600e-4a72-4844-a421-f4c28d6e5478.jpg)

VÃ  sau khi nháº¥n vÃ o, cÃ¡c báº¡n Ä‘áº·t tÃªn cho channel cá»§a mÃ¬nh, upload áº£nh Ä‘áº¡i diá»‡n, thÃªm mÃ´ táº£ (náº¿u cáº§n) tháº¿ lÃ  xong, chÃºng ta Ä‘Ã£ táº¡o ra má»™t channel thÃ nh cÃ´ng.

Tiáº¿p theo, chÃºng ta cáº§n táº¡o má»™t con bot trÃªn telegram, viá»‡c táº¡o bot trÃªn telegram thÃ¬ sau khi báº¡n Ä‘Äƒng nháº­p vÃ o Telegram thÃ¬ á»Ÿ Ã´ tim kiáº¿m, tÃ¬m BotFather, sau Ä‘Ã³ gÃµ /newbot Ä‘á»ƒ táº¡o,

![](https://images.viblo.asia/316df0f1-e18a-4d0a-9fd1-7fb0b3ff3653.jpg)

Sau khi táº¡o xong, báº¡n chá»‰ cáº§n láº¥y API Token cá»§a bot Ä‘á»ƒ sá»­ dá»¥ng.

Tiáº¿p tá»¥c, chÃºng ta sáº½ tÃ¬m Ä‘áº¿n tÃ i liá»‡u api Ä‘á»ƒ xem cÃ¡ch sá»­ dá»¥ng, tÃ i liá»‡u api: https://core.telegram.org/bots/api

á» Ä‘Ã¢y, mÃ¬nh dÃ¹ng chá»©c nÄƒng gá»­i tin nháº¯n kÃ¨m áº£nh nÃªn mÃ¬nh Ä‘Ã£ tÃ¬m Ä‘áº¿n api nÃ y: https://core.telegram.org/bots/api#sendphoto

Xem cÃ¡c tham sá»‘ cáº§n dÃ¹ng lÃ  gÃ¬ nÃ o? MÃ¬nh gá»­i thÃ´ng tin thá»i tiáº¿t nÃªn mÃ¬nh chá»‰ cáº§n dÃ¹ng 3 tham sá»‘ lÃ  `chat_id`, `photo`, `caption`. Tham sá»‘ chat_id lÃ  dÃ£y sá»‘ id cá»§a group chat, hoáº·c lÃ  username cá»§a channel, cÃ¡i channel mÃ¬nh táº¡o á»Ÿ tÃªn sáº½ cÃ³ dáº¡ng @ten_channel thÃ¬ tham sá»‘ nÃ y cháº¥p nháº­n kiá»ƒu sá»‘ hoáº·c chuá»—i. Váº­y Ä‘á»ƒ láº¥y cÃ¡i username cá»§a channel thÃ¬ láº¥y kiá»ƒu gÃ¬? Ráº¥t Ä‘Æ¡n giáº£n, báº¡n báº¥m vÃ o tÃªn cá»§a channel thÃ¬ sáº½ tháº¥y thÃ´ng tin, á»Ÿ cá»­a sá»‘ Channel Info thÃ¬ báº¡n sáº½ láº¥y pháº§n username á»Ÿ pháº§n link. VÃ­ dá»¥:  https://t.me/codedaokysu => @codedaokysu (Ä‘Ã¢y lÃ  username)

![](https://images.viblo.asia/7304b20a-ac88-4e57-b9c4-4158925ba4f5.jpg)

Khi Ä‘Ã£ cÃ³ thÃ´ng tin, thÃ¬ báº¡n cáº§n viáº¿t code Ä‘á»ƒ gá»­i tin nháº¯n, káº¿t há»£p vá»›i Bot Token khi táº¡o bot Ä‘á»ƒ sá»­ dá»¥ng gá»­i tin nháº¯n vÃ o channel. CÃ¡c báº¡n xem code tham kháº£o cá»§a mÃ¬nh á»Ÿ bÃªn dÆ°á»›i.

```
<?php 
header('Content-Type: application/json; charset=utf-8');

$url_qtri = 'http://api.openweathermap.org/data/2.5/weather?id=1582926&appid=**APIKEY_Cá»¦A_OPENWEATHERMAP_API**&units=metric&lang=vi';
$content_tri = file_get_contents($url_qtri);
$json_qtri = json_decode($content_tri, true);

$token = "**Äá»‚ TOKEN TELEBOT VÃ€O ÄÃ‚Y**";

$icon_qtri = $json_qtri['weather'][0]['icon'];
switch ($icon_qtri) {
	case '01d':
	case '01n':
		$icon_qtri_url = 'https://i.imgur.com/9CGjkOE.jpg';
		break;
	case '02d':
	case '02n':
		$icon_qtri_url = 'https://i.imgur.com/CRh04K2.jpg';
		break;
	case '03d':
	case '03n':
		$icon_qtri_url = 'https://i.imgur.com/zHuhzVo.jpg';
		break;
	case '04d':
	case '04n':
		$icon_qtri_url = 'https://i.imgur.com/riGvdrP.jpg';
		break;
	case '09d':
	case '09n':
		$icon_qtri_url = 'https://i.imgur.com/XHUnTV6.jpg';
		break;
	case '10d':
	case '10n':
		$icon_qtri_url = 'https://i.imgur.com/7ECPQGA.jpg';
		break;
	case '11d':
		$icon_qtri_url = 'https://i.imgur.com/dMj6Rt9.jpg';
		break;
	case '50d':
	case '50n':
		$icon_qtri_url = 'https://i.imgur.com/j4jSE6N.jpg';
		break;
	default:
		$icon_qtri_url = 'http://openweathermap.org/img/wn/' . $json_qtri['weather'][0]['icon'] . '@2x.png';
		break;
}

$data_qtri = [
	'chat_id' => '@codedaokysu',
	'photo'   => $icon_qtri_url,
	'caption' => 'Thá»i tiáº¿t ngÃ y ' . date('d/m/Y') . ' táº¡i ÄÃ´ng HÃ , Quáº£ng Trá»‹ cÃ³ ' . $json_qtri['weather'][0]['description'] . '. Nhiá»‡t Ä‘á»™ lÃ  ' . round($json_qtri['main']['temp']) . 'â„ƒ'
];
file_get_contents("https://api.telegram.org/bot$token/sendPhoto?" . http_build_query($data_qtri));

$url_hue = 'http://api.openweathermap.org/data/2.5/weather?id=1580240&appid=**APIKEY_Cá»¦A_OPENWEATHERMAP_API**&units=metric&lang=vi';
$content_hue = file_get_contents($url_hue);
$json_hue = json_decode($content_hue, true);

$icon_hue = $json_hue['weather'][0]['icon'];
switch ($icon_hue) {
	case '01d':
	case '01n':
		$icon_hue_url = 'https://i.imgur.com/9CGjkOE.jpg';
		break;
	case '02d':
	case '02n':
		$icon_hue_url = 'https://i.imgur.com/CRh04K2.jpg';
		break;
	case '03d':
	case '03n':
		$icon_hue_url = 'https://i.imgur.com/zHuhzVo.jpg';
		break;
	case '04d':
	case '04n':
		$icon_hue_url = 'https://i.imgur.com/riGvdrP.jpg';
		break;
	case '09d':
	case '09n':
		$icon_hue_url = 'https://i.imgur.com/XHUnTV6.jpg';
		break;
	case '10d':
	case '10n':
		$icon_hue_url = 'https://i.imgur.com/7ECPQGA.jpg';
		break;
	case '11d':
		$icon_hue_url = 'https://i.imgur.com/dMj6Rt9.jpg';
		break;
	case '50d':
	case '50n':
		$icon_hue_url = 'https://i.imgur.com/j4jSE6N.jpg';
		break;
	default:
		$icon_hue_url = 'http://openweathermap.org/img/wn/' . $json_hue['weather'][0]['icon'] . '@2x.png';
		break;
}

$data_hue = [
	'chat_id' => '**Äá»‚ USERNAME Cá»¦A TELEBOT VÃ€O ÄÃ‚Y**',
	'photo'   => $icon_hue_url,
	'caption' => 'Thá»i tiáº¿t ngÃ y ' . date('d/m/Y') . ' táº¡i TP.Huáº¿, Thá»«a ThiÃªn Huáº¿ cÃ³ ' . $json_hue['weather'][0]['description'] . '. Nhiá»‡t Ä‘á»™ lÃ  ' . round($json_hue['main']['temp']) . 'â„ƒ'
];
file_get_contents("https://api.telegram.org/bot$token/sendPhoto?" . http_build_query($data_hue));
```

Khi thiáº¿t láº­p xong, báº¡n cháº¡y code thÃ¬ nÃ³ sáº½ gá»­i nhÆ° hÃ¬nh dÆ°á»›i ğŸ˜ƒ

![](https://images.viblo.asia/7fb93a60-57a7-414d-b539-10d2b42493ec.jpg)

VÃ  Ä‘á»ƒ tá»± Ä‘á»™ng gá»­i tin, báº¡n cáº§n sá»­ dá»¥ng chá»©c nÄƒng cronjob cá»§a hosting, á»Ÿ Ä‘Ã¢y mÃ¬nh thiáº¿t láº­p gá»­i tin vÃ o 7h sÃ¡ng má»—i ngÃ y, ngÃ y nÃ o cÅ©ng gá»­i ğŸ˜

![](https://images.viblo.asia/49eb8086-773e-4ca9-8b2c-938f1d381293.jpg)

Váº­y lÃ  xong, cÃ¡m Æ¡n báº¡n Ä‘Ã£ Ä‘á»c bÃ i viáº¿t, náº¿u cÃ³ gÃ¬ tháº¯c máº¯c hÃ£y Ä‘á»ƒ láº¡i bÃ¬nh luáº­n bÃªn dÆ°á»›i Ä‘á»ƒ trao Ä‘á»•i nhÃ© ğŸ˜‰