![](https://images.viblo.asia/bd2c6280-1cc6-4b12-9d17-c0ca7b47b759.jpg)
LÃ  má»™t quáº£n trá»‹ viÃªn cá»§a há»‡ thá»‘ng Ä‘iá»u Ä‘áº§u tiÃªn báº¡n nghÄ© Ä‘áº¿n cháº¯c cháº¯n lÃ  báº£o máº­t vÃ  á»•n Ä‘á»‹nh. VÃ  cÃ¢u há»i Ä‘áº·t ra lÃ  báº¡n cáº§n lÃ m gÃ¬ Ä‘á»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u nÃ y? DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ cÃ¡ch hy vá»ng giÃºp Ã­ch Ä‘Æ°á»£c cÃ¡c báº¡n ğŸ˜‹ğŸ˜‹ğŸ˜‹

## 1.LuÃ´n cáº­p nháº­p pháº§n má»m má»›i nháº¥t
ÄÃ¢y lÃ  Ä‘iá»u cÆ¡ báº£n vÃ  Ä‘Æ¡n giáº£n nháº¥t mÃ  báº¡n luÃ´n nÃªn lÃ m! ÄÃ¢y cÅ©ng lÃ  cÃ¡ch hiá»‡u quáº£ nháº¥t Ä‘á»ƒ báº£o vá»‡ MÃ¡y chá»§ Linux cá»§a báº¡n. Bá»Ÿi vÃ¬ Ä‘á»‘i vá»›i háº§u háº¿t cÃ¡c lá»— há»•ng báº£o máº­t Ä‘Ã£ cÃ³ sáºµn má»™t báº£n vÃ¡, má»™t khi chÃºng Ä‘Æ°á»£c cÃ´ng khai. VÃ¬ váº­y, báº¡n cÃ³ thá»ƒ muá»‘n nÃ¢ng cáº¥p pháº§n má»m cá»§a mÃ¬nh ngay khi cÃ³ báº£n vÃ¡ báº£o máº­t má»›i.

MÃ¬nh vÃ­ dá»¥ nhÆ° trÃªn mÃ¡y chá»§ **[Ubuntu](https://ubuntu.com/download)**  mÃ¬nh sá»­ dá»¥ng gÃ³i â€œ**unattended-upgrades**â€œ, gÃ³i nÃ y Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t sáºµn. Báº¡n chá»‰ cáº§n cáº¥u hÃ¬nh nÃ³ báº±ng hai lá»‡nh nÃ y.
```
sudo apt install unattended-upgrades
sudo dpkg-reconfigure --priority=low unattended-upgrades
```
![](https://images.viblo.asia/62270da2-70ba-4902-969c-09b2106fa700.png)
## 2.Äá»«ng quÃªn cáº­p nháº­t Docker Containers cá»§a báº¡n
Má»™t thá»±c táº¿ quan trá»ng khÃ¡c mÃ  háº§u háº¿t má»i ngÆ°á»i hay quÃªn, lÃ  hÃ£y cáº­p nháº­t cÃ¡c [Container Docker](https://www.docker.com/resources/what-container) cá»§a báº¡n.  Bá»Ÿi vÃ¬ **Docker Containers** khÃ´ng tá»± Ä‘á»™ng lÆ°u trá»¯ vÃ  táº£i xuá»‘ng báº¥t ká»³ báº£n cáº­p nháº­t nÃ o. CÃ¡ch Ä‘Æ¡n giáº£n Ä‘á»ƒ nÃ¢ng cáº¥p chÃºng lÃ  **Destroy** vÃ  **Deploy** láº¡i nÃ³ báº±ng má»™t Images má»›i (***note***: nhá»› backup ğŸ˜€ğŸ˜€ğŸ˜€)

Náº¿u khÃ´ng muá»‘n lÃ m viá»‡c nÃ y theo cÃ¡ch thá»§ cÃ´ng á»Ÿ trÃªn, báº¡n tham kháº£o tool nÃ y  [Watchtower](https://github.com/containrrr/watchtower).

## 3.Báº£o máº­t SSH server cá»§a báº¡n
CÃ³ ráº¥t nhiá»u hÆ°á»›ng dáº«n vá» cÃ¡ch báº£o máº­t **SSH Server** trÃªn **Google**. VÃ  vÃ¬ Ä‘Ã¢y lÃ  cÃ´ng cá»¥ quáº£n lÃ½ chÃ­nh mÃ  má»i ngÆ°á»i Ä‘ang sá»­ dá»¥ng trÃªn **Linux**, nÃªn viá»‡c báº£o vá»‡ MÃ¡y chá»§ Linux cá»§a báº¡n chá»‘ng láº¡i cÃ¡c cuá»™c táº¥n cÃ´ng **SSH** lÃ  ráº¥t quan trá»ng. NhÆ°ng Ä‘iá»u quan trá»ng lÃ  pháº£i hiá»ƒu ráº±ng báº£n thÃ¢n **SSH** lÃ  má»™t giao thá»©c ráº¥t an toÃ n theo máº·c Ä‘á»‹nh náº¿u báº¡n khÃ´ng thay Ä‘á»•i cáº¥u hÃ¬nh. Háº§u háº¿t cÃ¡c váº¥n Ä‘á» vá»›i **SSH** chá»‰ lÃ  káº¿t quáº£ cá»§a nhá»¯ng thÃ³i quen xáº¥u ğŸ¤—ğŸ¤—

Náº¿u báº¡n Ä‘ang sá»­ dá»¥ng thÃ´ng tin Ä‘Äƒng nháº­p Ä‘á»ƒ xÃ¡c thá»±c vá»›i mÃ¡y chá»§ cá»§a mÃ¬nh, hÃ£y luÃ´n chá»n má»™t máº­t kháº©u máº¡nh. NhÆ°ng vá»›i mÃ¬nh, mÃ¬nh thÃ­ch táº¡o má»™t ngÆ°á»i dÃ¹ng riÃªng vÃ  thiáº¿t láº­p cáº·p khÃ³a **SSH privatekey** vÃ  **publickey**. Äiá»u Ä‘Ã³ cÃ³ hai lá»£i tháº¿:

> Thá»© nháº¥t, nÃ³ thoáº£i mÃ¡i hÆ¡n so vá»›i viá»‡c sá»­ dá»¥ng máº­t kháº©u.
> 
> Thá»© hai, trÃ¡nh vÃ´ tÃ¬nh sá»­ dá»¥ng láº¡i máº­t kháº©u cá»§a mÃ¬nh.
## 4.Táº¡o má»™t ngÆ°á»i dÃ¹ng riÃªng trÃªn Linux
HÃ£y táº¡o má»™t ngÆ°á»i dÃ¹ng riÃªng trÃªn Linux. 
```
useradd <username> -m -s /bin/bash
```
***Note***: *Vá»›i -m sáº½ tá»± Ä‘á»™ng táº¡o má»™t thÆ° má»¥c chÃ­nh cÃ¡ nhÃ¢n vÃ  -s sáº½ Ä‘áº·t trÃ¬nh máº·c Ä‘á»‹nh thÃ nh bash.*

Äá»“ng thá»i thÃªm ngÆ°á»i dÃ¹ng vÃ o báº¥t ká»³ nhÃ³m quáº£n trá»‹ nÃ o, nhÆ° **sudo** vÃ  **adm**. VÃ­ dá»¥: Báº¡n Ä‘ang sá»­ dá»¥ng **docker**, báº¡n cÃ³ thá»ƒ thÃªm ngÆ°á»i dÃ¹ng vÃ o nhÃ³m nÃ y
```
usermod -aG sudo, adm, docker
```
LÆ°u Ã½: VÃ¬ thá»±c hiá»‡n cÃ¡c lá»‡nh **sudo**, nÃªn báº¡n pháº£i thiáº¿t láº­p má»™t máº­t kháº©u máº¡nh cho ngÆ°á»i dÃ¹ng nÃ y.
```
passwd <username>
```
## 5.Táº¯t tÃ­nh nÄƒng Ä‘Äƒng nháº­p root vÃ  xÃ¡c thá»±c máº­t kháº©u trong SSH
Báº¡n cÅ©ng nÃªn vÃ´ hiá»‡u hÃ³a Ä‘Äƒng nháº­p root vÃ  buá»™c táº¥t cáº£ ngÆ°á»i dÃ¹ng xÃ¡c thá»±c báº±ng khÃ³a **riÃªng tÆ°** vÃ  khÃ³a **cÃ´ng khai**. Chá»‰ cáº§n thay Ä‘á»•i hai dÃ²ng nÃ y trong tá»‡p â€œ**/ etc/ssh/sshd_config**â€œ.
```
...
 # Authentication:
PermitRootLogin no
...
# To disable tunneled clear text passwords, change to no here!
PasswordAuthentication no
....
```
Sau khi thay Ä‘á»•i tá»‡p cáº¥u hÃ¬nh, khá»Ÿi Ä‘á»™ng láº¡i mÃ¡y chá»§ SSH cá»§a mÃ¬nh.
```
sudo systemctl restart ssh
```
## 6.Sá»­ dá»¥ng proxy truy cáº­p vÃ  xÃ¡c thá»±c hai yáº¿u tá»‘
Náº¿u báº¡n muá»‘n quáº£n lÃ½ quyá»n truy cáº­p shell trong má»™t nhÃ³m, cÃ³ ghi nháº­t kÃ½ kiá»ƒm tra tá»‘t hÆ¡n, mÃ¬nh khuyÃªn báº¡n nÃªn tham kháº£o dÃ¹ng proxy truy cáº­p vÃ  **2FA**.
Báº¡n tham kháº£o bÃ i viáº¿t [xÃ¡c thá»±c báº±ng 2FA](https://vietcalls.com/tim-hieu-va-su-dung-ssh-key/)
## 7.Chá»‰ má»Ÿ cÃ¡c dá»‹ch vá»¥ mÃ  báº¡n cáº§n
Má»i á»©ng dá»¥ng muá»‘n nháº­n dá»¯ liá»‡u tá»« mÃ¡y khÃ¡ch cáº§n láº¯ng nghe trÃªn má»™t cá»•ng riÃªng biá»‡t. Háº§u háº¿t chÃºng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a lÃ  cá»•ng **80** cho **HTTP**, **443** cho  **HTTPS**, **22** cho **SSH**â€¦

Báº¡n cÃ³ thá»ƒ dá»… dÃ ng kiá»ƒm tra thÃ´ng qua lá»‡nh â€œ**ss -lptn**â€ trong dÃ²ng lá»‡nh **Linux**, sau Ä‘Ã³ báº¡n sáº½ nháº­n Ä‘Æ°á»£c danh sÃ¡ch táº¥t cáº£ cÃ¡c á»©ng dá»¥ng hiá»‡n Ä‘ang láº¯ng nghe trÃªn cÃ¡c cá»•ng máº¡ng.

VÃ  báº¡n nÃªn xem qua táº¥t cáº£ chÃºng vÃ  tÃ¬m hiá»ƒu xem cÃ³ thá»±c sá»± cáº§n chÃºng khÃ´ng, chÃºng Ä‘á»ƒ lÃ m gÃ¬ vÃ  chÃ­nh xÃ¡c lÃ  chÃºng Ä‘ang lÃ m gÃ¬.

VÃ­ dá»¥: Báº¡n cÃ³ thá»ƒ tháº¥y ráº±ng tÃ´i cÃ³ má»™t mÃ¡y chá»§ SSH Ä‘ang láº¯ng nghe trÃªn cá»•ng 22 vÃ  táº¥t cáº£ cÃ¡c Äá»‹a chá»‰ IP cÃ³ 0.0.0.0 lÃ  cÃ¡c á»©ng dá»¥ng láº¯ng nghe trÃªn táº¥t cáº£ cÃ¡c giao diá»‡n Ä‘áº¿n.
![](https://images.viblo.asia/6d94ce0a-cb46-458e-89bf-7f536da2e855.png)
## 8.Sá»­ dá»¥ng há»‡ thá»‘ng tÆ°á»ng lá»­a
TÆ°á»ng lá»­a dá»±a trÃªn cÃ¡c quy táº¯c **[IPtables](https://vietcalls.com/iptables-trong-linux/)** trÃªn MÃ¡y chá»§ Linux cá»§a báº¡n cÃ³ thá»ƒ dá»… dÃ ng báº­t trÃªn mÃ¡y chá»§ cá»§a mÃ¬nh vÃ  sau Ä‘Ã³ nÃ³ sáº½ loáº¡i bá» táº¥t cáº£ lÆ°u lÆ°á»£ng truy cáº­p vÃ  chá»‰ cho phÃ©p nhá»¯ng lÆ°u lÆ°á»£ng cáº§n thiáº¿t.
![](https://images.viblo.asia/83e9bc08-cbfd-45d8-a5de-cb4c95ee4b71.png)

## 9.Sá»­ dá»¥ng há»‡ thá»‘ng ngÄƒn cháº·n xÃ¢m nháº­p
CÃ³ má»™t sá»‘ há»‡ thá»‘ng IPS mÃ£ nguá»“n má»Ÿ phá»• biáº¿n cÃ³ sáºµn, phá»• biáº¿n nháº¥t lÃ  **fail2ban**. **[Fail2ban](https://www.fail2ban.org/wiki/index.php/Main_Page)** ráº¥t Ä‘Æ¡n giáº£n vÃ  dá»… thiáº¿t láº­p vÃ¬ Ä‘Ã¢y lÃ  má»™t dá»‹ch vá»¥ duyá»‡t qua cÃ¡c tá»‡p nháº­t kÃ½ cá»§a cÃ¡c á»©ng dá»¥ng cá»§a báº¡n vÃ  tá»« chá»‘i cÃ¡c Ä‘á»‹a chá»‰ IP Ä‘Ã£ cá»‘ gáº¯ng truy cáº­p vÃ o mÃ¡y chá»§ cá»§a báº¡n vÃ  thá»±c hiá»‡n quÃ¡ nhiá»u máº­t kháº©u sai.
![](https://images.viblo.asia/7611d4d4-9530-4085-9e5c-289227289cab.jpeg)

Báº¡n xem thÃªm cÃ¡ch thiáº¿t láº­p [trong bÃ i viáº¿t nÃ y](https://hocvps.com/cai-dat-fail2ban-tren-centos/)
## Lá»i káº¿t
TrÃªn Ä‘Ã¢y lÃ  9 cÃ¡ch giÃºp báº£o vá»‡ há»‡ thá»‘ng mÃ¡y chá»§ Linux báº¡n tá»‘t hÆ¡n. ChÃºc cÃ¡c báº¡n thÃ nh cÃ´ng.!

Tham kháº£o:
- [Báº£o máº­t Server Linux](https://vietcalls.com/bao-ve-server-linux-cua-ban-chong-hacker-va-malware/)
- [Watchtower](https://github.com/containrrr/watchtower)
-  [How To Set up SSH Keys on a Linux](https://www.cyberciti.biz/faq/how-to-set-up-ssh-keys-on-linux-unix/)
- [Fail2Ban](https://hocvps.com/cai-dat-fail2ban-tren-centos/)