ChÃ o cÃ¡c báº¡n Ä‘áº¿n vá»›i bÃ i Ä‘áº§u tiÃªn trong series tÃ¬m hiá»ƒu vá» Docker cá»§a mÃ¬nh :)

á» bÃ i Ä‘áº§u tiÃªn trong series nÃ y chÃºng ta sáº½ cÃ¹ng tráº£i qua 10-15 phÃºt quáº£ng cÃ¡o Ä‘á»ƒ biáº¿t Docker lÃ  gÃ¬, nhá»¯ng gÃ¬ nÃ³ mang láº¡i, táº¡i sao nÃªn dÃ¹ng vÃ  nhá»¯ng ai Ä‘ang dÃ¹ng nÃ³ nhÃ©.

DÃ¹ nhá»¯ng bÃ i sau sáº½ lÃ  optional, cÃ¡c báº¡n cÃ³ thá»ƒ Ä‘á»c bÃ i mÃ  cÃ¡c báº¡n muá»‘n xem, nhÆ°ng Ä‘áº·c biá»‡t mÃ¬nh "xin" vÃ  yÃªu cáº§u lÃ  **báº¯t buá»™c** cÃ¡c báº¡n Ä‘á»c háº¿t bÃ i nÃ y :joy:, náº¿u khÃ´ng cÃ³ thá»ƒ cÃ¡c báº¡n sáº½ nháº­n ra dÃ¹ng Docker xong mÃ  khÃ´ng tháº¥y nÃ³ hÆ¡n bÃ¬nh thÆ°á»ng tÃ­ nÃ o :-D

> Xem thÃªm pháº§n cuá»‘i Ä‘á»ƒ tháº¥y Docker vÃ  kiáº¿n thá»©c vá» container nÃ³i chung giÃºp Ã­ch cho mÃ¬nh nhÆ° tháº¿ nÃ o trong cÃ´ng viá»‡c nhÃ©

# Docker - Hello beauty
## Chuyá»‡n lÃ ...

CÃ³ má»™t anh tÃªn lÃ  Äáº§u To má»›i join vÃ o 1 cÃ´ng ty, khi má»›i vÃ o team, chÃ¢n Æ°á»›t chÃ¢n rÃ¡o nhÆ°ng Ä‘Ã£ Ä‘Æ°á»£c leader Ä‘Æ°a cho project vÃ  báº£o cÃ i Ä‘áº·t, cháº¡y thá»­ vÃ  xem tá»•ng quan project nhÆ° tháº¿ nÃ o. Rá»“i thÃ¬ cÃ i. NÃ o lÃ  PHP, rá»“i Laravel, MySQL, ok cháº¡y thá»­ vÃ  :boom: BUILD FAILED :boom:. Rá»“i anh cháº¡y Ä‘i há»i Leader, leader báº£o a cáº§n cÃ i thÃªm Redis. Rá»“i thÃ¬ cÃ i Redis. Láº¡i loay hoay cáº£ buá»•i vÃ  cÃ i cÃ i Ä‘áº·t Ä‘áº·t, anh nháº­n ra cÃ i Redis trÃªn Windows khÃ³ hÆ¡n lÃªn trá»i, trong khi á»Ÿ Ubuntu hay Mac thÃ¬ dá»… nhÆ° xá»‰a rÄƒng :-D. Váº­y lÃ  tá»‘i hÃ´m Ä‘Ã³ a vá» cÃ i Ubuntu vÃ o mÃ¡y. Rá»“i láº¡i build vÃ  láº¡i :boom: BUILD FAILED :boom:, anh láº¡i nháº¯n há»i Leader vÃ  láº¡i biáº¿t lÃ  mÃ¬nh chÆ°a cháº¡y `composer dump:autoload` Ä‘á»ƒ load cÃ¡c thÆ° viá»‡n cá»§a PHP, vÃ  anh cÅ©ng khÃ´ng biáº¿t lÃ  pháº£i cháº¡y `php artisan storage:link`. Cháº¡y xong nhá»¯ng cÃ¡i trÃªn ok rá»“i má»Ÿ web lÃªn thÃ¬ láº¡i khÃ´ng tháº¥y chá»©c nÄƒng realtime cháº¡y, láº¡i Ä‘i há»i leader vÃ  láº¡i biáº¿t lÃ  do anh chÆ°a cháº¡y `laravel echo server`. Anh tháº¥y buá»“n vÃ  á»©c cháº¿ :-D

Rá»“i láº¡i cÃ³ anh tÃªn Máº¯t Nhá» khi pháº£i maintain 3-4 project, má»—i project láº¡i cáº§n Ä‘á»§ thá»© nhÆ° PHP, NodeJS, MySQL, MongoDB, rá»“i cÃ³ ngÃ y anh cÃ i cÃ i Ä‘áº·t Ä‘áº·t vÃ  bÃ¹m, MySQL lÄƒn ra cháº¿t, a cháº³ng biáº¿t cÃ¡ch nÃ o Ä‘á»ƒ xÃ³a "tráº¯ng" Ä‘i vÃ  cÃ i láº¡i, lá»—i váº«n in ra nhÆ° tháº¿, Ä‘á» lÃ²m :rage:, cÃ¡c project liÃªn quan thÃ¬ ngá»m cá»§ tá»i vÃ¬ Ä‘á»u cáº§n DB Ä‘á»ƒ cháº¡y. Anh buá»“n, vÃ  tá»« Ä‘Ã³ trá»Ÿ Ä‘i má»—i khi cÃ i báº¥t kÃ¬ cÃ¡i gÃ¬ vÃ o server tay anh láº¡i run nhÆ° ngÃ y Ä‘áº§u Ä‘áº¿n trÃ¬nh diá»‡n nhÃ  bá»‘ vá»£. :-D

Qua 2 cÃ¢u chuyá»‡n trÃªn ta tháº¥y cÃ³ nhá»¯ng ná»—i sá»£ nhÆ° sau:
- á»Ÿ cÃ¢u chuyá»‡n Ä‘áº§u tiÃªn: má»—i project cáº§n pháº£i cÃ i nhiá»u thá»©, nhiá»u thÆ° viá»‡n Ä‘á»ƒ cháº¡y, trong khi document láº¡i khÃ´ng rÃµ rÃ ng, vÃ  Ä‘Ã´i khi cÃ³ document nhÆ°ng ta láº¡i khÃ´ng thá»ƒ cÃ i vÃ  cháº¡y thÃ nh cÃ´ng do sá»± khÃ¡c nhau giá»¯a nhá»¯ng mÃ´i trÆ°á»ng cháº¡y. Local thÃ¬ dÃ¹ng Win trong khi á»Ÿ server thÃ¬ 96,69% lÃ  Linux
- á» cÃ¢u chuyá»‡n thá»© 2, viá»‡c dÃ¹ng chung cÃ¡c tÃ i nguyÃªn giá»¯a cÃ¡c project, Ä‘á»“ng thá»i sá»± láº±ng nháº±ng khi sá»‘ project tÄƒng lÃªn lÃ m cho má»—i quyáº¿t Ä‘á»‹nh cÃ i thÃªm hay xÃ³a Ä‘i má»™t tÃ i nguyÃªn nÃ o Ä‘Ã³ Ä‘á»u thá»±c sá»± Ä‘au Ä‘áº§u. MÃ  sáº½ ráº¥t cÃ³ thá»ƒ xáº£y ra trÆ°á»ng há»£p " em xÃ³a Ä‘i xong nhÆ°ng khÃ´ng cÃ i láº¡i Ä‘Æ°á»£c ná»¯a" :-D

Ai tháº¥y mÃ¬nh Ä‘Ã£ rÆ¡i vÃ o trÆ°á»ng há»£p nhÆ° á»Ÿ trÃªn dÆ¡ tay. :raised_hand:. Ok bá» tay xuá»‘ng mÃ¬nh báº¯t Ä‘áº§u pháº§n tiáº¿p nhÃ© :-D

## Docker lÃ  gÃ¬
Tá»« nhá»¯ng thá»±c trang nhÆ° á»Ÿ trÃªn vÃ  hÃ ng tÃ¡ nhá»¯ng lÃ­ do khÃ¡c, mÃ  Docker Ä‘Æ°á»£c ra Ä‘á»i.

![Docker](https://www.docker.com/sites/default/files/social/docker_facebook_share.png)

Äá»‹nh nghÄ©a vá» Docker theo 1 cÃ¡ch "mÃ¡y mÃ³c":
> Docker lÃ  má»™t dá»± Ã¡n mÃ£ nguá»“n má»Ÿ giÃºp tá»± Ä‘á»™ng triá»ƒn khai cÃ¡c á»©ng dá»¥ng Linux vÃ  Windows vÃ o trong cÃ¡c container áº£o hÃ³a. Docker cung cáº¥p má»™t lá»›p trá»«u tÆ°á»£ng vÃ  tá»± Ä‘á»™ng áº£o hÃ³a dá»±a trÃªn LinuxDocker lÃ  má»™t dá»± Ã¡n mÃ£ nguá»“n má»Ÿ giÃºp tá»± Ä‘á»™ng triá»ƒn khai cÃ¡c á»©ng dá»¥ng Linux vÃ  Windows vÃ o trong cÃ¡c container áº£o hÃ³a. Docker cung cáº¥p má»™t lá»›p trá»«u tÆ°á»£ng vÃ  tá»± Ä‘á»™ng áº£o hÃ³a dá»±a trÃªn Linux

Äá»‹nh nghÄ©a Ä‘Æ°á»£c Ä‘Æ¡n giáº£n hÃ³a theo cÃ¡ nhÃ¢n mÃ¬nh:
> Docker lÃ  cÃ´ng cá»¥ giÃºp ta cÃ³ thá»ƒ cháº¡y project á»Ÿ má»™t mÃ´i trÆ°á»ng cá»¥ thá»ƒ, Ä‘Æ°á»£c Ä‘á»‹nh sáºµn rÃµ rÃ ng, Ä‘á»™c láº­p vá»›i mÃ´i trÆ°á»ng gá»‘c. CÃ¡c á»©ng dá»¥ng cháº¡y trong Docker Ä‘Æ°á»£c gá»i lÃ  cÃ¡c Container ("Cá»n tÃªn nÆ¡")

MÃ¬nh biáº¿t lÃ  cÃ¡c báº¡n Ä‘á»c xong Ä‘á»‹nh nghÄ©a cháº¯c cÅ©ng váº«n cÃ²n nhiá»u tháº¯c máº¯c. Cá»© tá»« tá»« rá»“i thá»i gian sáº½ tráº£ lá»i dáº§n dáº§n nhÃ© ;). CÃ¹ng xem Docker cÃ³ gÃ¬ hay nhÃ©

## Nhá»¯ng Ä‘iá»u Docker mang láº¡i
DÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng thá»© mÃ¬nh tá»•ng há»£p láº¡i vá» nhá»¯ng Ä‘iá»u tá»‘t Ä‘áº¹p cá»§a Docker:
1. Docker cho cÃ¡c báº¡n 1 mÃ´i trÆ°á»ng má»¥c tiÃªu cá»¥ thá»ƒ, vÃ­ dá»¥ cÃ¡c báº¡n cáº§n mÃ´i trÆ°á»ng Ubuntu, cÃ³ PHP 7.2 cÃ³ NodeJS 8.0, cÃ³ mysql 5.2. Docker sáº½ giÃºp báº¡n cÃ³ Ä‘Æ°á»£c Ä‘iá»u Ä‘Ã³.
2. MÃ´i trÆ°á»ng trong Docker Ä‘á»™c láº­p so vá»›i mÃ´i trÆ°á»ng gá»‘c: Docker sáº½ táº¡o ra cho cÃ¡c báº¡n mÃ´i trÆ°á»ng "áº£o" trong Ä‘Ã³ cÃ¡c báº¡n cÃ³ thá»ƒ cháº¡y project cá»§a mÃ¬nh, báº¥t ká»ƒ há»‡ Ä‘iá»u hÃ nh gá»‘c cá»§a cÃ¡c báº¡n cÃ³ lÃ  gÃ¬. Do Ä‘Ã³, ká»ƒ cáº£ báº¡n á»Ÿ Win hay Mac thÃ¬ váº«n cÃ³ thá»ƒ cháº¡y project dÆ°á»›i mÃ´i trÆ°á»ng Ubuntu hay báº¥t cá»© mÃ´i trÆ°á»ng nÃ o (mÃ  hiá»‡n táº¡i Docker support) báº¡n cáº§n.
3. Má»™t mÃ´i trÆ°á»ng Docker sau khi Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nÃ³ sáº½ lÃ  "báº¥t biáº¿n". Báº¡n cÃ³ thá»ƒ setup á»Ÿ báº¥t kÃ¬ Ä‘Ã¢u báº¥t kÃ¬ mÃ¡y nÃ o vá»›i mÃ´i trÆ°á»ng giá»‘ng há»‡t báº¡n Ä‘Ã£ Ä‘á»‹nh nghÄ©a.
4. Má»—i má»™t project sáº½ cÃ³ má»™t file cáº¥u hÃ¬nh cá»¥ thá»ƒ, 10 nÄƒm sau báº¡n Ä‘á»c láº¡i project thÃ¬ váº«n biáº¿t Ä‘á»ƒ cháº¡y Ä‘Æ°á»£c project Ä‘Ã³ thÃ¬ cáº§n nhá»¯ng gÃ¬ vÃ  cáº§n lÃ m gÃ¬. Báº¡n chá»‰ cáº§n Ä‘Æ°a file cáº¥u hÃ¬nh cho ngÆ°á»i khÃ¡c lÃ  há» sáº½ tá»± biáº¿t pháº£i lÃ m gÃ¬ Ä‘á»ƒ cháº¡y ;)
5. VÃ¬ má»—i project chÃºng ta cÃ³ thá»ƒ setup á»Ÿ má»™t mÃ´i trÆ°á»ng riÃªng, nÃªn cÃ¡c project sáº½ khÃ´ng bá»‹ xung Ä‘á»™t, chia sáº» tÃ i nguyÃªn láº±ng nháº±ng (náº¿u nhÆ° ta khÃ´ng muá»‘n). Tá»« Ä‘Ã³ giáº£m thiá»ƒu tá»‘i Ä‘a sá»± phá»¥ thuá»™c láº«n nhau, cÃ i Ä‘áº·t, thÃªm bá»›t sá»­a xÃ³a cÃ¡c thÆ° viá»‡n, cáº¥u hÃ¬nh cÅ©ng sáº½ khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng tá»›i cÃ¡c project khÃ¡c.
6. Docker cÃ³ thá»ƒ giÃºp tá»± Ä‘á»™ng Heal (tá»± há»“i phá»¥c, khá»Ÿi Ä‘á»™ng láº¡i) náº¿u trong trÆ°á»ng há»£p cÃ³ lá»—i.

## Dá»«ng! TrÆ°á»›c Ä‘Ã¢y Ä‘Ã£ cÃ³ mÃ¡y áº£o rá»“i mÃ ??
Nghe xong pháº§n bÃªn trÃªn cÃ³ thá»ƒ cÃ¡c báº¡n nháº­n ra sá»± na nÃ¡ mÃ  trÆ°á»›c Ä‘Ã¢y nhá»¯ng mÃ¡y áº£o nhÆ° VMWare hay Virtual Box cÅ©ng cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c nhÆ°: táº¡o ra cÃ¡c mÃ´i trÆ°á»ng áº£o, Ä‘á»™c láº­p vá»›i há»‡ Ä‘iá»u hÃ nh gá»‘c.

NhÆ°ng 1 trong nhá»¯ng trá»Ÿ ngáº¡i lá»›n nháº¥t cá»§a mÃ¡y áº£o theo mÃ¬nh tháº¥y Ä‘Ã³ lÃ  sá»± náº·ng ná», cÃ i Ä‘áº·t ráº¥t phá»©c táº¡p, vÃ  ráº¥t cháº­m. DÃ¹ng mÃ¡y áº£o ta pháº£i cáº¯t cá»©ng 1 lÆ°á»£ng tÃ i nguyÃªn cho nÃ³, dáº«n tá»›i há»‡ Ä‘iá»u hÃ nh gá»‘c vÃ  mÃ¡y áº£o pháº£i chia sáº» pháº§n cá»©ng vÃ  lÃ m giáº£m hiá»‡u nÄƒng cá»§a cáº£ 2. Viá»‡c cÃ i Ä‘áº·t mÃ´i trÆ°á»ng á»Ÿ mÃ¡y áº£o tá»•n nhiá»u thá»i gian, khi gáº·p lá»—i pháº£i cÃ i láº¡i thÃ¬ cÃ¡c báº¡n sáº½ tháº¥m ná»—i Ä‘au :-D.

Vá»›i Docker, Docker sáº½ táº¡o ra "mÃ´i trÆ°á»ng áº£o" chá»© khÃ´ng pháº£i háº³n 1 mÃ¡y áº£o ná»¯a, do Ä‘Ã³ sáº½ chia sáº» pháº§n cá»©ng vá»›i mÃ´i trÆ°á»ng gá»‘c bÃªn ngoÃ i, RAM, CPU,.. tá»‘c Ä‘á»™ sáº½ nhÆ° nhau, chia sáº» file (náº¿u ta muá»‘n) vá»›i mÃ´i trÆ°á»ng gá»‘c. Äá»“ng thá»i viá»‡c táº¡o má»™t mÃ´i trÆ°á»ng "áº£o" trong Docker cÅ©ng ráº¥t nhanh chÃ³ng vÃ  dá»… dÃ ng Ä‘á»ƒ lÃ m vá»›i chá»‰ 1 hoáº·c 1 vÃ i command.

Do Ä‘Ã³ cÃ¡c báº¡n cáº§n rÃµ rÃ ng vá» cÃ¡i mÃ  Docker mang láº¡i vÃ  cÃ¡i mÃ  mÃ¡y áº£o mang láº¡i: 1 thá»© táº¡o ra cho ta mÃ´i trÆ°á»ng áº£o chia sáº» pháº©n cá»©ng vá»›i mÃ´i trÆ°á»ng gá»‘c, má»™t thá»© táº¡o ra cho chÃºng ta cáº£ 1 chiáº¿c mÃ¡y áº£o vá»›i má»i thá»© tá»« pháº§n cá»©ng, Ä‘áº¿n file system,... tÃ¡ch biá»‡t so vá»›i mÃ¡y tháº­t. (xá»“i, nghe xong Ä‘áº§u Ã³c cá»© tháº¥y áº£o áº£o tháº­t tháº­t :-D :-D). CÃ¡c báº¡n xem hÃ¬nh dÆ°á»›i Ä‘á»ƒ tháº¥y so sÃ¡nh vui, nhÆ°ng thá»±c táº¿ vá» viá»‡c dÃ¹ng Docker so vá»›i dÃ¹ng mÃ¡y áº£o nhÃ©.

![Docker](https://images.viblo.asia/0f195568-88a2-4a2d-af5d-36d8256ffdfc.png)

## Táº¡i sai tÃ´i cáº§n Docker?
DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ suy nghÄ© cá»§a mÃ¬nh vÃ¬ sao cÃ¡c báº¡n nÃªn yÃªu Docker <3:
- Khi project cá»§a chÃºng ta cÃ³ nhiá»u ngÆ°á»i cÃ¹ng lÃ m, ngÆ°á»i dÃ¹ng Win, ngÆ°á»i dÃ¹ng Mac, ngÆ°á»i dÃ¹ng Linux, nhÆ°ng cÃ¡ch Ä‘á»ƒ cÃ i cÃ¡c pháº§n má»m, thÆ° viá»‡n Ä‘á»ƒ cÃ³ thá»ƒ cháº¡y Ä‘Æ°á»£c project láº¡i khÃ¡c nhau á»Ÿ má»—i ná»n táº£ng, Ä‘á»“ng thá»i khi cÃ i cÃ³ thá»ƒ lÃ m thay Ä‘á»•i project. Dáº«n tá»›i viá»‡c project cháº¡y khÃ´ng Ä‘Ãºng, sai á»Ÿ cÃ¡c ná»n táº£ng khÃ¡c nhau.
- Sá»± sá»£ hÃ£i nháº¥t cá»§a mÃ¬nh ngÃ y xÆ°a Ä‘Ã³ lÃ  code Local ngon láº¯m rá»“i, nhÆ°ng lÃªn server thÃ¬ ngá»§m cá»§ tá»i :-D.
- Má»—i project cáº§n ráº¥t nhiá»u thá»© Ä‘i kÃ¨m: MySQL, Redis, cÃ¡c extensions,... VÃ  viá»‡c nhá»› cÃ i cho Ä‘Ãºng tá»«ng cÃ¡i Ä‘Ã£ ráº¥t má»‡t, nhá»› cÃ¡ch cáº¥u hÃ¬nh cho Ä‘Ãºng láº¡i cÃ ng má»‡t hÆ¡n. VÃ  sá»± Sá»¢ HÃƒI lá»›n nháº¥t lÃ  khi cÃ i mÃ  bá»‹ lá»—i, mÃ  lá»—i xong xÃ³a Ä‘i cÃ i láº¡i láº¡i khÃ´ng Ä‘Æ°á»£c nhÆ° cÅ©.
- Khi chÃºng ta cÃ³ nhiá»u project, dÃ¹ng chung nhiá»u thá»©, dáº«n tá»›i khi muá»‘n thay Ä‘á»•i, sá»­a Ä‘á»•i 1 tÃ i nguyÃªn dÃ¹ng chung nÃ o Ä‘Ã³ sáº½ lÃ m cÃ¡c project liÃªn quan áº£nh hÆ°á»Ÿng.
- VÃ  1 trÆ°á»ng há»£p mÃ¬nh tháº¥y Ä‘au khá»• nháº¥t. ÄÃ³ lÃ  khi ta chuyá»ƒn mÃ´i trÆ°á»ng (chuyá»ƒn server cháº³ng háº¡n), ta cáº§n bÃª nguyÃªn cá»¥c project cÅ© vÃ  chuyá»ƒn sang mÃ´i trÆ°á»ng má»›i. LÃºc nÃ y Ná»–I Sá»¢ :smiling_imp: má»›i thá»±c sá»± hiá»‡n rÃµ. LÃ m sao Ä‘á»ƒ cÃ³ thá»ƒ chuyá»ƒn toÃ n bá»™ data, cáº¥u hÃ¬nh láº¡i tá»« Ä‘áº§u vá»›i hÃ ng tá»‰ bÆ°á»›c, cÃ i hÃ ng tá»‰ thá»©
- .... bla vÃ  blo

Táº¥t cáº£ nhá»¯ng Ä‘iá»u trÃªn Docker sáº½ giÃºp cÃ¡c báº¡n giáº£i quyáº¿t má»™t cÃ¡c ráº¥t chi lÃ  Ä‘Æ¡n giáº£n, dá»… dÃ ng vÃ  cute (nhÆ° ngÆ°á»i viáº¿t bÃ i nÃ y váº­y :-D)
## Ai Ä‘ang dÃ¹ng Docker
Dá»±a vÃ o nhá»¯ng gÃ¬ mÃ¬nh Ä‘Æ°á»£c biáº¿t, nhá»¯ng buá»•i seminar hay event mÃ¬nh Ä‘i thÃ¬ Docker Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ háº§u háº¿t nhá»¯ng cty mÃ¬nh gáº·p. Tá»« Google, Facebook, Amazon, Tiki, Ä‘áº¿n cÃ´ng ty cÅ© cá»§a mÃ¬nh vÃ  ráº¥t ráº¥t nhiá»u mÃ¬nh khÃ´ng ká»ƒ háº¿t Ä‘Æ°á»£c á»Ÿ Ä‘Ã¢y

Ráº¥t cÃ³ thá»ƒ cÃ´ng ty cá»§a báº¡n cÅ©ng Ä‘ang dÃ¹ng Docker Ä‘áº¥y, thá»­ há»i Leader xem ;).

Thá»i Ä‘iá»ƒm hiá»‡n táº¡i viá»‡c dÃ¹ng Docker sáº½ giÃºp ta sá»­ dá»¥ng Ä‘Æ°á»£c ráº¥t nhiá»u tiá»‡n Ã­ch Ä‘i kÃ¨m:
- Kubernetes: Tool Ä‘á»ƒ quáº£n lÃ½ cÃ¡c project cháº¡y báº±ng Docker, tá»± Ä‘á»™ng Heal khi cÃ³ lá»—i, tá»± Ä‘á»™ng scale, tá»± Ä‘á»™ng deploy, tá»± Ä‘á»™ng vÃ  tá»± Ä‘á»™ng :-D
- CI/CD: Pháº§n nÃ y mÃ¬nh sáº½ trÃ¬nh bÃ y trong series nÃ y, Ã¡p dá»¥ng CI CD giÃºp ta chá»‰ cáº§n code, vÃ  commit, cÃ²n láº¡i cÃ¡c viá»‡c nhÆ° test, check lá»—i, vÃ  triá»ƒn khai (deploy) ra mÃ´i trÆ°á»ng thá»±c táº¿ Ä‘á»u Ä‘Æ°á»£c lÃ m tá»± Ä‘á»™ng, khÃ´ng cáº§n pháº£i cÃ i cÃ¡c tool láº±ng nháº±ng Ä‘á»ƒ auto-deploy ná»¯a.
- Sá»± há»— trá»£ Ä‘áº¿n táº­n chÃ¢n rÄƒng cá»§a cÃ¡c ná»n táº£ng quáº£n lÃ½ source code nhÆ° Github, Gitlab, Bitbucket,... cho cÃ¡c á»©ng dá»¥ng Docker láº¡i cÃ ng lÃ m tÄƒng thÃªm giÃ¡ trá»‹ cho Docker ;)

Vá»›i nhá»¯ng Ä‘iá»u tuyá»‡t vá»i mÃ  Docker mang láº¡i thÃ¬ mÃ¬nh nghÄ© Ä‘Ã³ cÅ©ng lÃ  lÃ­ do vÃ¬ sao Docker hiá»‡n táº¡i cá»±c kÃ¬ phá»• biáº¿n á»©ng dá»¥ng rá»™ng Ä‘á»ƒ cháº¡y project trong mÃ´i trÆ°á»ng "áº£o hÃ³a" thay vÃ¬ cháº¡y theo kiá»ƒu truyá»ƒn thá»‘ng.
# CÃ¡c khÃ¡i niá»‡m cáº§n náº¯m
VÃ¬ khi nháº£y vÃ o Docker sáº½ cÃ³ ráº¥t nhiá»u thá»© chÃºng ta cáº§n biáº¿t, nhÆ°ng náº¿u nÃ³i ngay trong 1 bÃ i nÃ y thÃ¬ má»i ngÆ°á»i sáº½ bá»‹ bá»™i thá»±c máº¥t :-D. Do Ä‘Ã³ mÃ¬nh sáº½ chá»‰ Ä‘á» cáº­p 1 vÃ i khÃ¡i niá»‡m cÆ¡ báº£n mÃ¬nh tháº¥y lÃ  cáº§n thiáº¿t vÃ  ta hay dÃ¹ng Ä‘áº¿n, nhá»¯ng Ä‘iá»u khÃ¡c ta sáº½ dáº§n dáº§n khÃ¡m phÃ¡ á»Ÿ cÃ¡c bÃ i sau nhÃ©.
## Image
`Image` lÃ  1 trong nhá»¯ng Ä‘Æ¡n vá»‹ cÆ¡ báº£n nháº¥t trong Docker. 1 Image sáº½ Ä‘á»‹nh nghÄ©a cho 1 mÃ´i trÆ°á»ng vÃ  nhá»¯ng thá»© cÃ³ trong mÃ´i trÆ°á»ng Ä‘Ã³. á»¨ng dá»¥ng cá»§a ta muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ cáº§n pháº£i cÃ³ `Image`

![Docker image](https://images.viblo.asia/6046e83c-0742-4538-993a-78e9802839b2.png)

VÃ­ dá»¥ trong Image ta cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a cÃ¡c thÃ nh pháº§n nhÆ° sau:
- MÃ´i trÆ°á»ng: Ubuntu 16.04
- PHP 7.2
- MySQL 5.2

ThÃ¬ toÃ n bá»™ nhá»¯ng thá»© bÃªn trÃªn (Ubuntu, PHP, MySQL) ta cÃ³ thá»ƒ Ä‘Ã³ng gÃ³i láº¡i thÃ nh 1 Image. CÃ³ thá»ƒ giá»¯ lÃ m cá»§a há»“i mÃ´n, hoáº·c Ä‘em public cho ngÆ°á»i khÃ¡c cÃ³ thá»ƒ dÃ¹ng Ä‘Æ°á»£c. ;)

## Container
Má»™t `Container` lÃ  1 thá»±c thá»ƒ cá»§a `Image`. CÃ¡ch hiá»ƒu Ä‘Æ¡n giáº£n nháº¥t Ä‘Ã³ lÃ : `Image` cÃ¡c báº¡n xem nhÆ° 1 class, cÃ²n `Container` xem nhÆ° 1 Object Ä‘Æ°á»£c khá»Ÿi táº¡o tá»« class Ä‘Ã³.

Tá»« má»™t Image ta cÃ³ thá»ƒ khá»Ÿi táº¡o cáº£ chá»¥c, trÄƒm container.Má»—i project cÃ³ thá»ƒ chá»©a 1 hoáº·c nhiá»u container Ä‘Æ°á»£c táº¡o ra tá»« 1 hoáº·c nhiá»u image. VÃ­ dá»¥, ta cÃ³ project PHP:
- MÃ´i trÆ°á»ng Ubuntu -> cáº§n cÃ³ image Ubuntu 16.04
- CÃ³ thÃªm php -> cáº§n cÃ³ image php7.2

Do Ä‘Ã³ khi cháº¡y project trÃªn ta sáº½ cáº§n táº¡o 2 container: 1 lÃ  container Ubuntu, 1 container PHP7.2
## Port (cá»•ng)
VÃ¬ mÃ´i trÆ°á»ng trong Docker Ä‘á»™c láº­p hoÃ n toÃ n so vá»›i mÃ´i trÆ°á»ng gá»‘c. NÃªn Ä‘á»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c á»©ng dá»¥ng cháº¡y trong Docker thÃ¬ ta cáº§n má»Ÿ port tá»« Docker Ä‘á»ƒ bÃªn ngoÃ i cÃ³ thá»ƒ gá»i vÃ o Ä‘Æ°á»£c.

Hay gá»i Ä‘Ãºng thÃ¬ lÃ  ta "map port". Tá»©c lÃ  ta sáº½ má»Ÿ 1 port á»Ÿ há»‡ Ä‘iá»u hÃ nh gá»‘c, sau Ä‘Ã³ Ä‘iá»u hÆ°á»›ng tá»›i port Ä‘Æ°á»£c á»Ÿ trong Docker. NhÆ° tháº¿ ta má»›i cÃ³ thá»ƒ gá»i Ä‘áº¿n á»©ng dá»¥ng cháº¡y trong Docker Ä‘Æ°á»£c

![Docker map port](https://images.viblo.asia/a0e89f7d-7487-4503-a1c8-aef57e8b34b6.png)

NhÆ° á»Ÿ áº£nh trÃªn ta cÃ³ 1 server Tomcat cháº¡y trong 1 container Docker, á»Ÿ container ta má»Ÿ port 8080 cho mÃ´i trÆ°á»ng ngoÃ i truy cáº­p, tá»« mÃ´i trÆ°á»ng ngoÃ i ta má»Ÿ cá»•ng 8888 Ä‘á»ƒ user tháº­t cÃ³ thá»ƒ truy váº¥n. Do Ä‘Ã³ user sáº½ gá»i Ä‘áº¿n cá»•ng 8888 Ä‘á»ƒ giao tiáº¿p vá»›i á»©ng dá»¥ng cháº¡y trong Docker container. 
## Volume
VÃ¬ mÃ´i trÆ°á»ng Docker Ä‘á»™c láº­p nÃªn há»‡ thá»‘ng file cá»§a á»©ng dá»¥ng cháº¡y trong Docker cÅ©ng Ä‘á»™c láº­p, mÃ  thá»±c táº¿ thÃ¬ háº§u nhÆ° ta luÃ´n cáº§n lÆ°u láº¡i file: lÆ°u trá»¯ DB, lÆ°u trá»¯ log, áº£nh,... Do Ä‘Ã³ Ä‘á»ƒ mÃ´i trÆ°á»ng gá»‘c truy cáº­p Ä‘Æ°á»£c vÃ o file system cá»§a á»©ng dá»¥ng cháº¡y trong Docker thÃ¬ ta cáº§n tá»›i `Volume`

DÃ¹ng `Volume` Ä‘á»ƒ mÃ´i trÆ°á»ng gá»‘c cÃ³ thá»ƒ nÃ³i cho Docker biáº¿t ráº±ng: náº¿u anh cÃ³ sinh ra file log má»›i thÃ¬ anh nhá»› lÆ°u cho anh xong thÃ¬ nhá»› táº¡o 1 "hÃ¬nh chiáº¿u" cá»§a file log cho tÃ´i nhÃ©, khi tÃ´i sá»­a/xÃ³a á»Ÿ bÃªn tÃ´i (bÃªn ngoÃ i), hoáº·c anh sá»­a/xÃ³a á»Ÿ bÃªn anh thÃ¬ file log Ä‘Ã³ Ä‘á»u pháº£i máº¥t á»Ÿ cáº£ 2 mÃ´i trÆ°á»ng (gá»i Ä‘Ãºng thuáº­t ngá»¯ thÃ¬ lÃ  **mount** tá»« mÃ´i trÆ°á»ng ngoÃ i vÃ o trong Docker)

# KhÃ¡i niá»‡m Ä‘Ã£ náº¯m, setup thÃ´i
## Setup gitlab
á» Series nÃ y mÃ¬nh khuyáº¿n khÃ­ch cÃ¡c báº¡n dÃ¹ng Gitlab Ä‘á»ƒ lÆ°u trá»¯ source code, vÃ¬ gitlab cho free private repo Ä‘á»“ng thá»i free CICD, vÃ  cÅ©ng free container registry (nÆ¡i Ä‘á»ƒ ta Ä‘áº©y Image lÃªn vÃ  lÆ°u trá»¯ sau nÃ y). VÃ  Gitlab cÃ²n support ráº¥t nhiá»u thá»© hay ho ná»¯a cÅ©ng free luÃ´n, mÃ¬nh hi vá»ng cÃ³ thá»ƒ chia sáº» Ä‘Æ°á»£c cÃ ng nhiá»u cÃ ng tá»‘t cho cÃ¡c báº¡n :-D

Do Ä‘Ã³ cÃ¡c báº¡n táº¡o cho mÃ¬nh 1 tÃ i khoáº£n Gitlab nhÃ© (yÃªn tÃ¢m free khÃ´ng báº¯t nháº­p credit card Ä‘Ã¢u :-D :D). Truy cáº­p Ä‘á»‹a chá»‰ gitlab.com Ä‘á»ƒ táº¡o tÃ i khoáº£n má»›i nhÃ© cÃ¡c báº¡n
## Setup Docker vÃ  Docker-compose
### Docker
TiÃªp theo cÃ¡c báº¡n cáº§n cÃ i Ä‘áº·t Docker (táº¥t nhiÃªn rá»“i :-D):
 - CÃ i Ä‘áº·t cho Windows á»Ÿ [Ä‘Ã¢y](https://docs.docker.com/docker-for-windows/install/). Nhá»› Ä‘á»c pháº§n `System Requirements` vÃ  search google náº¿u cÃ³ tháº¯c máº¯c nhÃ©
 - CÃ i Ä‘áº·t cho Ubuntu [á»Ÿ Ä‘Ã¢y](https://docs.docker.com/install/linux/docker-ce/ubuntu/)
 - CÃ i Ä‘áº·t cho Mac [á»Ÿ Ä‘Ã¢y](https://docs.docker.com/v17.12/docker-for-mac/install/)

CÃ i xong nhá»› check xem Ä‘Ã£ thÃ nh cÃ´ng hay chÆ°a nhÃ©. Cháº¡y thá»­ command Ä‘á»ƒ check:
```shell
docker --version
```
Mong cÃ¡c báº¡n Ä‘á»«ng comment há»i cÃ¡ch cÃ i ra sao vÃ¬ á»Ÿ trÃªn Google cÃ³ nhiá»u káº¿t quáº£ tá»‘t hÆ¡n nhiá»u ;)
### Docker-compose
Äá»ƒ cháº¡y cÃ¡c project trong Docker thÃ¬ ta cÃ³ thá»ƒ dÃ¹ng command sau Ä‘á»ƒ cháº¡y tá»«ng container cáº§n thiáº¿t:
```python
docker run containerA
docker run containerB
....
```
NHÆ¯NG khi cháº¡y dá»± Ã¡n thá»±c táº¿ thÃ¬ háº§u nhÆ° ta sáº½ sá»­ dá»¥ng docker-compose Ä‘á»ƒ cháº¡y project, vÃ¬ thá»±c táº¿ háº§u nhÆ° ta luÃ´n cáº§n nhiá»u hÆ¡n 1 container cho 1 project. Do Ä‘Ã³ trong series nÃ y mÃ¬nh sáº½ dÃ¹ng `docker-compose` Ä‘á»ƒ cháº¡y cÃ¡c project demo trong cÃ¡c bÃ i. YÃªn tÃ¢m Ä‘i dÃ¹ng docker-compose khÃ´ng cáº§n thÃªm nhiá»u nÃ£o Ä‘Ã¢u cÃ¡c báº¡n nhÃ©, giá»‘ng nhau cáº£ thÃ´i ;)

Docker-compose lÃ  tool Ä‘á»ƒ cáº¥u hÃ¬nh vÃ  cháº¡y nhiá»u docker container cÃ¹ng lÃºc. DÃ¹ng docker-compose sáº½ giÃºp ta dá»… dÃ ng hÆ¡n trong viá»‡c cháº¡y cÃ¹ng lÃºc 1 hoáº·c 1 sá»‘ container cáº§n thiáº¿t cho project, Ä‘á»“ng thá»i giÃºp ta dá»… dÃ ng visualize (nhÃ¬n) tá»•ng quan vá» project. 

CÃ i Ä‘áº·t:
- Vá»›i Win vÃ  Mac thÃ¬ Docker-compose Ä‘Ã£ Ä‘Æ°á»£c tÃ­ch há»£p sáºµn vá»›i Docker á»Ÿ trÃªn, cÃ¡c báº¡n khÃ´ng cáº§n lÃ m gÃ¬ thÃªm
- Vá»›i Ubuntu, cÃ¡c báº¡n xem hÆ°á»›ng dáº«n [á»Ÿ Ä‘Ã¢y](https://www.digitalocean.com/community/tutorials/how-to-install-docker-compose-on-ubuntu-16-04) (nhá»› Ä‘á»c tháº­t kÄ© pháº§n hÆ°á»›ng dáº«n, cÃ i báº£n má»›i nháº¥t vÃ  lÃ m háº¿t Step 1 lÃ  xong nhÃ©)

CÃ i xong cÅ©ng check xem Ä‘Ã£ thÃ nh cÃ´ng hay chÆ°a nhÃ©. Cháº¡y thá»­ command Ä‘á»ƒ check:
```shell
docker-compose --version
```
# Update 2022
Sau má»™t vÃ i nÄƒm Ä‘i lÃ m, mÃ¬nh má»›i tháº¥y Ä‘Æ°á»£c lá»£i Ã­ch mÃ  nhá»¯ng kiáº¿n thá»©c vá» Docker, Kubernetes (k8s),... nhiá»u nhÆ° nÃ o.

Máº·c dÃ¹ title lÃ  frontend engineer nhÆ°ng gáº§n nhÆ° mÃ¬nh lÃ m má»i thá»©: viáº¿t dockerfile, deploy lÃªn k8s, openshift, tá»± exec vÃ o pod debug, tá»± dockerize project cá»§a mÃ¬nh vÃ  cá»§a ngÆ°á»i khÃ¡c (tá»« nodejs Ä‘áº¿n python java,..)

LÃ m viá»‡c vá»›i docker, deploy nhiá»u dáº¡y cho mÃ¬nh hiá»ƒu thÃªm nhiá»u vá» network, khÃ´ng sÃ¢u nhÆ° dÃ¢n chuyÃªn network, nhÆ°ng cÅ©ng khÃ¡ lÃ  Ä‘áº§y Ä‘á»§ Ä‘á»ƒ mÃ¬nh hiá»ƒu Ä‘Æ°á»£c flow request Ä‘i tá»« phÃ­a user, rá»“i tá»›i cÃ¡c layer trong há»‡ thá»‘ng cá»§a mÃ¬nh (load balancer, ingress, gateway,...) tá»« Ä‘Ã³ khi cÃ³ váº¥n Ä‘á» gÃ¬ mÃ¬nh cÃ³ thá»ƒ tá»± debug Ä‘Æ°á»£c lÃ  lá»—i náº±m á»Ÿ pháº§n nÃ o.

NÃ³i chÃºng lÃ  ráº¥t nhiá»u thá»© mÃ  khi há»c Docker mang láº¡i cho mÃ¬nh, gáº§n nhÆ° mÃ¬nh ráº¥t Ã­t khi pháº£i chá» ngÆ°á»i khÃ¡c dockerize rá»“i deploy app cho mÃ¬nh, rá»“i debug khi gáº·p lá»—i ná»¯a,...kháº£ nÄƒng lÃ m viá»‡c Ä‘á»™c láº­p tÄƒng cao háº³n.

Váº­y nÃªn há»c Docker tháº­t chÄƒm chá»‰ nhÃ© cÃ¡c báº¡n, kiáº¿n thá»©c vá» Docker lÃ  ná»n táº£ng cho cÃ¡c thá»© sau nÃ y Kubernetes, Openshift vÃ  tháº¿ giá»›i Container

> Nhá»› cÃ³ láº§n deploy production cÃ¹ng 1 anh bÃªn team SRE (chuyÃªn lÃ m deploy cÃ¡c kiá»ƒu), mÃ¬nh cÃ³ dá»‹p thá»ƒ hiá»‡n phÃ´ng báº¡t skill Docker cÃ¡c kiá»ƒu, á»•ng pháº£i ngáº¡c nhiÃªn há»i sao em há»c á»Ÿ Ä‘Ã¢y váº­y, anh deploy suá»‘t mÃ  cÅ©ng ko rÃµ vÃ  ko biáº¿t máº¥y cÃ¡i nÃ y. Tá»± tháº©m du tinh tháº§n tháº¥y sÆ°á»›ng ğŸ¤£ğŸ¤£ğŸ¤£ğŸ¤£

# Káº¿t bÃ i
Qua bÃ i nÃ y mÃ¬nh cÅ©ng Ä‘Ã£ giá»›i thiá»‡u sÆ¡ bá»™ vá»›i cÃ¡c báº¡n vá» Docker vÃ  nhá»¯ng lá»£i Ã­ch mÃ  Docker mang láº¡i, cÃ¹ng vá»›i Ä‘Ã³ lÃ  setup "Ä‘áº¡n dÆ°á»£c" cáº§n thiáº¿t Ä‘á»ƒ chÃºng ta cÃ³ thá»ƒ báº¯t Ä‘áº§u vÃ o cÃ¡c bÃ i tiáº¿p theo.

á» cÃ¡c bÃ i sau má»—i bÃ i mÃ¬nh sáº½ hÆ°á»›ng dáº«n cÃ¡c báº¡n cÃ¡ch `dockerize` cÃ¡c á»©ng dá»¥ng (cháº¡y á»©ng dá»¥ng trong mÃ´i trÆ°á»ng Docker) cá»¥ thá»ƒ (NodeJS, Laravel, Vue, Python,...). Tá»« giá» mÃ¬nh sáº½ dÃ¹ng tá»« `dockerize` Ä‘á»ƒ chá»‰ viá»‡c chÃºng ta cháº¡y project bÃªn trong Docker nhÃ© (cho giá»‘ng vá»›i báº¡n bÃ¨ quá»‘c táº¿ ;))

á» cÃ¡c bÃ i tiáº¿p theo má»—i bÃ i sáº½ lÃ  má»™t vÃ­ dá»¥ cá»¥ thá»ƒ, Ä‘á»ƒ cÃ¡c báº¡n vá»«a cÃ³ thá»ƒ lÃ m vÃ  há»c Ä‘á»“ng thá»i tháº¥y Ä‘Æ°á»£c káº¿t quáº£, mÃ¬nh sáº½ táº­p trung nhiá»u vÃ o thá»±c hÃ nh vÃ¬ vá»›i mÃ¬nh cÃ¡ch há»c nhanh nháº¥t lÃ  thá»±c hÃ nh. NhÆ° trang chá»§ cá»§a Laradock cÃ³ nÃ³i: 
```sql
Use Docker First - Then Learn About It Later ( dÃ¹ng Docker trÆ°á»›c, há»c vá» nÃ³ sau, Ã½ lÃ  cÃ¡c báº¡n sáº½ dáº§n hiá»ƒu ra nÃ³ lÃ  gÃ¬ vÃ  cÃ¡ch váº­n dá»¥ng sao cho Ä‘Ãºng)
```

Náº¿u cÃ³ gÃ¬ tháº¯c máº¯c thÃ¬ cÃ¡c báº¡n cá»© Ä‘á»ƒ láº¡i comment cho mÃ¬nh nhÃ©. Háº¹n gáº·p cÃ¡c báº¡n á»Ÿ cÃ¡c bÃ i sau ;) ([bÃ i sau](https://viblo.asia/p/dockerize-ung-dung-nodejs-RnB5pxEG5PG) lÃ  bÃ i thá»±c hÃ nh Ä‘áº§u tiÃªn cÃ³ nhiá»u thá»© quan trá»ng mÃ¬nh muá»‘n chia sáº» nÃªn cÃ¡c báº¡n nhá»› Ä‘á»c nhÃ© ;))