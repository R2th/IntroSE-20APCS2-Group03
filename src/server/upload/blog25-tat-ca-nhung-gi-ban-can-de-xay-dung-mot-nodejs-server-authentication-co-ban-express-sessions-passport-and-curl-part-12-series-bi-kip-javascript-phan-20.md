![image.png](https://images.viblo.asia/b3ffc1fd-ce83-4f7e-b33e-18e7a02608a7.png)

M√¨nh l√† TU·∫§N hi·ªán ƒëang l√† m·ªôt Full-stack Developer t·∫°i Tokyo üòâ.
N·∫øu b·∫°n th·∫•y Blog n√†y hay xin h√£y cho m√¨nh m·ªôt like v√† ƒëƒÉng k√Ω ƒë·ªÉ ·ªßng h·ªô m√¨nh nh√© üòä.

Ng√†y x∆∞a l√∫c m√¨nh m·ªõi ti·∫øp c·∫≠n v·ªõi Nodejs v√† ƒë·ªçc c√°c tutorial h∆∞·ªõng d·∫´n tr√™ng m·∫°ng, m√¨nh lu√¥n ph·∫£i v·∫≠t l·ªôn v·ªõi vi·ªác hi·ªÉu ph·∫ßn **Authentication** c·ªßa n√≥. Thay v√¨ th·ª±c s·ª± gi·∫£i th√≠ch c∆° ch·∫ø v√† nh·ªØng g√¨ ƒëang x·∫£y ra, m√¨nh ch·ªâ c·∫£m th·∫•y nh∆∞ t√°c gi·∫£ ch·ªâ ƒë∆°n gi·∫£n l√† cung c·∫•p m·ªôt h∆∞·ªõng d·∫´n v·ªÅ c√°ch sao ch√©p/d√°n t·ª´ t√†i li·ªáu. B√†i vi·∫øt n√†y nh·∫±m th·ª±c s·ª± h∆∞·ªõng d·∫´n b·∫°n qua quy tr√¨nh **authentication** v√† gi·∫£i th√≠ch t·ª´ng c∆° ch·∫ø m·ªôt.

B√†i n√†y m√¨nh s·∫Ω chia l√†m 2 ph·∫ßn ƒë·ªÉ c√°c b·∫°n gi·ªÖ d√†ng tham kh·∫£o. (PH·∫¶N 2)

**L·ªúI KHUY√äN: B·∫°n N√äN v·ª´a ƒë·ªçc v·ª´a ƒë·ªëi chi√™u v·ªõi code n·∫øu c√≥ th·ªÉ th√¨ h√£y code n√≥ ra l√† t·ªët nh·∫•t. Vi·ªác ƒë√≥ gi·∫Ω gi√∫p b·∫°n hi·ªÉu h∆°n khi ƒë·ªçc gi·∫£i th√≠ch. N·∫øu ch·ªâ ƒë·ªçc gi√†i th√≠ch c√≥ th·ªÉ b·∫°n s·∫Ω c·∫£m th·∫•y c√≥ l√∫c r·∫•t kh√≥ hi·ªÉu.**

ƒêi·ªÅu ki·ªán ti·ªÅn quy·∫øt: m√¨nh gi·∫£ s·ª≠ nh∆∞ c√°c b·∫°n ƒë√£ c√≥ th·∫ø s·ª≠ d·ª•ng c∆° b·∫£n v·ªõi `Terminal`/`command-line interface (CLI)` v√† `Javascript`/`Node.js.`

PH·∫¶N 1
========

B∆∞·ªõc 1. Thi·∫øt l·∫≠p c·∫•u tr√∫c t·ªáp
------------------------------

ƒê·∫ßu ti√™n, ch√∫ng ta s·∫Ω t·∫°o m·ªôt th∆∞ m·ª•c c·∫•p cao nh·∫•t c√≥ t√™n l√† `‚ÄúauthTut‚Äù` ch·ªâ ƒë·ªÉ ch·ª©a 2 folder c·ªßa project l√† `server` v√† `client`. Trong tr∆∞·ªùng h·ª£p n√†y, ch√∫ng ta s·∫Ω s·ª≠ d·ª•ng [cURL](https://en.wikipedia.org/wiki/CURL) l√†m `client interface` thay v√¨ tr√¨nh duy·ªát (*Chrome ho·∫∑c tr√¨nh duy·ªát n√†o kh√°c*), v√¨ m√¨nh nghƒ© n√≥ s·∫Ω gi√∫p b·∫°n hi·ªÉu r√µ h∆°n nh·ªØng g√¨ th·ª±c s·ª± x·∫£y ra trong tr√¨nh duy·ªát c·ªßa b·∫°n khi g·ªçi 1 **request**.

ƒê·ªÉ m√¥ ph·ªèng b·ªô nh·ªõ c·ªßa tr√¨nh duy·ªát, ch√∫ng ta s·∫Ω t·∫°o m·ªôt th∆∞ m·ª•c `/client` trong `/authTuts` v√† ch√∫ng ta c≈©ng s·∫Ω t·∫°o m·ªôt th∆∞ m·ª•c `/server` n∆°i ch√∫ng ta s·∫Ω x√¢y d·ª±ng `server`.

Ch·∫°y c√°c l·ªánh sau trong `**terminal**` c·ªßa b·∫°n.

```
workspace $ mkdir authTut
workspace $ cd authTut
authTut $ mkdir server
authTut $ mkdir client
```

B∆∞·ªõc 2. Kh·ªüi t·∫°o `npm` v√† c√†i ƒë·∫∑t `express` trong th∆∞ m·ª•c `/server`
--------------------------------------------------------------

ƒê·∫ßu ti√™n, h√£y m·ªü Terminal tr√™n th∆∞ m·ª•c `/server` c·ªßa ch√∫ng ta, sau ƒë√≥ kh·ªüi t·∫°o `npm`. V·ªõi n√≥ ch√∫ng ta c√≥ th·ªÉ theo d√µi nh·ªØng ph·ª• thu·ªôc n√†o m√† `server` c·ªßa ch√∫ng ta c√≥. Ti·∫øp theo, h√£y ti·∫øp t·ª•c v√† c√†i ƒë·∫∑t `express` d∆∞·ªõi d·∫°ng ph·ª• thu·ªôc, sau ƒë√≥ t·∫°o t·ªáp `server.js`.

```
authTut $ cd server
server $ npm init -y
server $ npm install express --save
server $ touch server.js
```

L∆∞u √Ω, vi·ªác s·ª≠ d·ª•ng flag '`-y`' c√πng v·ªõi '`npm init`' s·∫Ω t·ª± ƒë·ªông ch·∫•p nh·∫≠n c√°c `value` m·∫∑c ƒë·ªãnh m√† `npm` kh·ªüi t·∫°o cho `project` c·ªßa ch√∫ng ta. Sau khi enter, b·∫°n s·∫Ω th·∫•y c√°c t√πy ch·ªçn m·∫∑c ƒë·ªãnh ƒë∆∞·ª£c ghi v√†o `Terminal`.

T·∫°i th·ªùi ƒëi·ªÉm n√†y, b·∫°n s·∫Ω c√≥ c·∫•u tr√∫c th∆∞ m·ª•c `folder` gi·ªëng nh∆∞ sau:

```
- /authTuts
  - /server
    - /node_modules
    - server.js
    - package.json
  - /client
```

B∆∞·ªõc 3. T·∫°o `server` Express Node.js
------------------------------

M·ªü th∆∞ m·ª•c `/authTuts` trong Editor y√™u th√≠ch c·ªßa b·∫°n (M√¨nh d√πng VsCode), sau ƒë√≥ m·ªü t·ªáp `authTuts/server/server.js`.

ƒê·∫ßu ti√™n, ch√∫ng ta s·∫Ω **request** m√¥-ƒëun `express`, sau ƒë√≥ ch√∫ng ta g·ªçi h√†m `express()` ƒë·ªÉ t·∫°o ·ª©ng d·ª•ng c·ªßa ch√∫ng ta v√† cu·ªëi c√πng ch√∫ng ta n√≥i `express` s·∫Ω ch·∫°y tr√™n Port n√†o.

```javascript
//npm modules
const express = require('express');

// create the server
const app = express();

// tell the server what port to listen on
app.listen(3000, () => {
  console.log('Listening on localhost:3000')
})
```
Ngo√†i l·ªÅ: N·∫øu b·∫°n n√†o mu·ªën hi·ªÉu s√¢u v·ªÅ vi·ªác t·∫°i sao c·ª© g·ªçi h√†m `require(...)` b·ªè c√°i t√™n v√†o l√† c√≥ m·ªôt ƒë·ªëi t∆∞·ª£ng ƒë·ªÉ s·ª≠ d·ª•ng th√¨ tham kh·∫£o b√†i vi·∫øt n√†y nh√© [Abstract Factory Pattern. Trong n√†y m√¨nh c≈©ng ƒë√£ c√≥ m·ªôt b√†i vi·∫øt chi ti·∫øt v·ªÅ c√°c Design Pattern n√†y.](https://viblo.asia/p/blog10-gioi-thieu-ve-javascript-design-patterns-kem-vi-du-truc-quan-series-bi-kip-javascript-phan-8-vlZL9NR8VQK#abstract-factory-pattern)

Ti·∫øp theo, g·ªçi '`node server.js`' t·ª´ `terminal`. ƒêi·ªÅu n√†y s·∫Ω kh·ªüi ƒë·ªông `server` c·ªßa ch√∫ng ta. B·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c c√¢u tr·∫£ l·ªùi ‚Äú`Listening on localhost:3000`‚Äù. (L·ªánh '`node`' trong `terminal` c·ªßa ch√∫ng ta c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ ch·∫°y c√°c t·ªáp `Javascript`).

```
Listening on localhost:3000
^C // C√°i d·∫•u n√†y l√† m√¨nh nh·∫•n Ctrl + C ƒë·ªÉ ng·ª´ng server. B·∫•t c·ª© khi n√†o b·∫°n mu·ªën ng·ª´ng ho·∫°t ƒë·ªông tr√™n Ternimal b·∫°n c√≥ th·ªÉ d√πng t·ªï h·ª£p ph√≠m [Ctrl + C]
server $ node server.js
Listening on localhost:3000
```

Nai s·ª´! B·∫°n v·ª´a t·∫°o m·ªôt `server`! N·∫øu b·∫°n truy c·∫≠p ‚Äú [http://localhost:3000/](http://localhost:3000/)‚Äù ngay b√¢y gi·ªù, b·∫°n s·∫Ω th·∫•y th√¥ng b√°o l·ªói cho bi·∫øt ‚ÄúCannot GET /‚Äù, nh∆∞ng v·∫´n t·ªët h∆°n l√† g·∫∑p l·ªói ‚ÄúThis site can't be reached‚Äù! (ƒêi·ªÅu n√†y l√† b·∫°n ƒë√£ c√≥ 1 `server` ch·ªâ l√† ch∆∞a c√≥ `Enpoint` n√†o th√¥i :D)

B∆∞·ªõc 4. Th√™m homepage route v√†o route `'/'`
--------------------------------------------------

C·∫≠p nh·∫≠t t·ªáp `server.js` ƒë·ªÉ th√™m h√†m `GET` v√†o route `'/'` c·ªßa ch√∫ng ta. Khi `client` (tr√¨nh duy·ªát ho·∫∑c `cURL` nh∆∞ ch√∫ng ta s·∫Ω th·∫•y ngay sau ƒë√¢y) g·ªçi h√†m `GET`, `server` c·ªßa ch√∫ng ta s·∫Ω ph·∫£n h·ªìi v√† k√®m d·ªØ li·ªáu. Trong tr∆∞·ªùng h·ª£p n√†y, ch√∫ng ta cung c·∫•p h√†m `'/'` `GET` v·ªõi **function callback** cho **server** c·ªßa ch√∫ng ta ph·∫£n h·ªìi v·ªõi c√¢u '`you just hit the home page`'.

```javascript
//npm modules
const express = require('express');

// create the server
const app = express();

// create the homepage route at '/'
app.get('/', (req, res) => {
  res.send('you just hit the home page\n')
})

// tell the server what port to listen on
app.listen(3000, () => {
  console.log('Listening on localhost:3000')
})
```
C√°c tham s·ªë '`req`' v√† '`res`' ƒë∆∞·ª£c cung c·∫•p cho h√†m **callback** `app.get('/')` c·ªßa ch√∫ng ta l√† c√°c ƒë·ªëi t∆∞·ª£ng '`request`' v√† '`response`' ƒë∆∞·ª£c t·∫°o t·ª´ c√°c `request headers`.

N·∫øu b·∫°n truy c·∫≠p [http://localhost:3000/](http://localhost:3000/) b√¢y gi·ªù, b·∫°n v·∫´n s·∫Ω th·∫•y l·ªói '`Cannot GET /`', v√¨ `server` c·ªßa ch√∫ng ta v·∫´n ho·∫°t ƒë·ªông tr√™n t·ªáp `server.js` c≈© v√† m·ªói l·∫ßn ch√∫ng ta thay ƒë·ªïi t·ªáp n√†y th√¨ c·∫ßn ph·∫£i `restart` l·∫°i `server`. Ok gi·ªù kh·ªüi ƒë·ªông l·∫°i `server` sau khi l∆∞u c√°c thay ƒë·ªïi c·ªßa m√¨nh. Ch√∫ng ta c√≥ th·ªÉ l√†m ƒëi·ªÅu n√†y b·∫±ng c√°ch nh·∫•n '`Ctrl + C`' khi ƒëang ·ªü trong `terminal` v√† sau ƒë√≥ ch·∫°y l·∫°i '`node server.js`'.

```
Listening on localhost:3000
^C
server $ node server.js
Listening on localhost:3000
```

B√¢y gi·ªù, khi b·∫°n truy c·∫≠p l·∫°i [http://localhost:3000/](http://localhost:3000/) , b·∫°n s·∫Ω th·∫•y th√¥ng b√°o '`you just hit the home page`'. M·ªü tab ho·∫∑c c·ª≠a s·ªï m·ªõi trong **terminal** c·ªßa b·∫°n v√† thay ƒë·ªïi v√†o th∆∞ m·ª•c `/client` (B·∫°n c√≥ th·ªÉ d√πng l·ªánh `cd ..` ho·∫∑c thao t√°c tr√™n `UI` ƒë·ªÉ m·ªü 1 `terminal` c·ªßa 1 th∆∞ m·ª•c n√†o ƒë√≥). Sau ƒë√≥, g·ªçi l·ªánh `cURL` v√† chuy·ªÉn v√†o m·ªôt s·ªë t√πy ch·ªçn ƒë·ªÉ truy c·∫≠p `endpoint` trang ch·ªß c·ªßa ch√∫ng ta. B·∫°n s·∫Ω th·∫•y ph·∫£n h·ªìi c·ªßa ch√∫ng ta ƒë∆∞·ª£c tr·∫£ l·∫°i.

```
server $ cd ..
authTut $ cd client
client $ cURL -X GET http://localhost:3000/
you just hit the home page
```

·ªû tr√™n s·ª≠ d·ª•ng t√πy ch·ªçn '`-X`' ƒë·ªÉ c√≥ th·ªÉ chuy·ªÉn `curl` th√†nh `GET` ho·∫∑c `POST` t·ªõi m·ªôt `endpoint`. ·ªû ƒë√¢y, ch√∫ng ta ƒëang '`GET`' **endpoint** `'/'`.

B∆∞·ªõc 5. D√πng `nodemon` trong khi **dev**
--------------------

S·∫Ω th·ª±c s·ª± kh√≥ ch·ªãu n·∫øu ch√∫ng ta ph·∫£i kh·ªüi ƒë·ªông l·∫°i `server` m·ªói khi ch√∫ng ta th·ª±c hi·ªán thay ƒë·ªïi ƒë·ªëi v·ªõi t·ªáp `server.js` c·ªßa m√¨nh. H√£y s·ª≠ d·ª•ng m√¥-ƒëun `nodemon`, m√¥-ƒëun n√†y s·∫Ω t·ª± ƒë·ªông kh·ªüi ƒë·ªông l·∫°i `server` c·ªßa ch√∫ng ta m·ªói khi ch√∫ng ta l∆∞u thay ƒë·ªïi v√†o t·ªáp `server.js`. ƒê·∫ßu ti√™n, c√†i ƒë·∫∑t g√≥i `nodemon` tr√™n `global`. M·ªü 1 Terminal m·ªõi sau ƒë√≥ th·ª±c hi·ªán l·ªánh: 

`server $ npm install -g nodemon`

Khi b·∫°n d√πng t√πy ch·ªçn `-g` v√†o tr√¨nh c√†i ƒë·∫∑t m√¥-ƒëun `npm`, n√≥ s·∫Ω c√†i ƒë·∫∑t g√≥i tr√™n m√¥i tr∆∞·ªùng `global` ƒë·ªÉ b·∫°n c√≥ th·ªÉ truy c·∫≠p m√¥-ƒëun ƒë√≥ t·ª´ b·∫•t k·ª≥ ƒë√¢u trong h·ªá th·ªëng t·ªáp c·ªßa m√¨nh khi b·∫°n ƒëang ·ªü trong `terminal`. B√¢y gi·ªù, h√£y t·∫Øt `server` c·ªßa ch√∫ng ta v√† kh·ªüi ƒë·ªông n√≥ b·∫±ng `nodemon`.

`server $ nodemon server.js`

B√¢y gi·ªù, ch√∫ng ta h√£y thay ƒë·ªïi vƒÉn b·∫£n ph·∫£n h·ªìi c·ªßa ƒë∆∞·ªùng d·∫´n trang ch·ªß c·ªßa ch√∫ng ta th√†nh m·ªôt c√°i g√¨ ƒë√≥ kh√°c v√† c≈©ng `console.log()` ƒë·ªëi t∆∞·ª£ng `request`, ƒë·ªÉ ch√∫ng ta c√≥ th·ªÉ th·∫•y n√≥ tr√¥ng nh∆∞ th·∫ø n√†o. Sau khi l∆∞u t·ªáp, b·∫°n s·∫Ω th·∫•y `server` kh·ªüi ƒë·ªông l·∫°i trong tab Terminal `server`.

```javascript
//npm modules
const express = require('express');

// create the server
const app = express();

// create the homepage route at '/'
app.get('/', (req, res) => {
  console.log(req)
  res.send('You hit the home page without restarting the server automatically\n')
})

// tell the server what port to listen on
app.listen(3000, () => {
  console.log('Listening on localhost:3000')
})
```
B√¢y gi·ªù, ch√∫ng ta h√£y g·ªçi l·∫°i `curl`, ri√™ng l·∫ßn n√†y l·∫ßn n√†y, h√£y d√πng th√™m flag `-v` (**verbose**).

```c
client $ curl -X GET http://localhost:3000 -v
Note: Unnecessary use of -X or --request, GET is already inferred.
* Rebuilt URL to: http://localhost:3000/
*   Trying ::1...
* TCP_NODELAY set
* Connected to localhost (::1) port 3000 (#0)
> GET / HTTP/1.1
> Host: localhost:3000
> User-Agent: curl/7.54.0
> Accept: */*
> 
< HTTP/1.1 200 OK
< X-Powered-By: Express
< Content-Type: text/html; charset=utf-8
< Content-Length: 66
< ETag: W/"42-Ybeup68SVZ+Id3fqVh25rCkXfno"
< Date: Sun, 29 Oct 2017 19:58:38 GMT
< Connection: keep-alive
< 
You hit the home page without restarting the server automatically
```

Trong `request` th·ª© 2, ch√∫ng ta nh·∫≠n ƒë∆∞·ª£c th√¥ng tin v·ªÅ `curl request` c·ªßa ch√∫ng ta. H√£y t√¨m hi·ªÉu k·ªπ h∆°n m·ªôt ch√∫t v·ªÅ n√≥ nh√©.

1.  `cURL` cho ch√∫ng ta bi·∫øt r·∫±ng ch√∫ng ta kh√¥ng c·∫ßn ph·∫£i s·ª≠ d·ª•ng `-X GET` v√¨ ƒë√≥ l√† `value` m·∫∑c ƒë·ªãnh cho `cURL`. Tuy nhi√™n, trong b√†i vi·∫øt n√†y m√¨nh mu·ªën s·ª≠ d·ª•ng n√≥ ƒë·ªÉ c√°c b·∫°n hi·ªÉu r√µ h∆°n.
2.  ‚Äú`rebuilt URL to‚Ä¶`‚Äù cho b·∫°n bi·∫øt `cURL` ƒë√£ th√™m m·ªôt d·∫•u g·∫°ch ch√©o v√†o cu·ªëi `URL` c·ªßa b·∫°n.
3.  ‚Äú`ƒêang th·ª≠ :: 1‚Ä¶`‚Äù l√† ƒë·ªãa ch·ªâ `IP` m√† `URL` ƒë√£ gi·∫£i quy·∫øt.
4.  D√≤ng ti·∫øp theo l√† `Port` ch√∫ng ta ƒë√£ k·∫øt n·ªëi, m√† b·∫°n nh·∫≠n th·∫•y l√† `Port` ch√∫ng ta ƒë√£ ch·ªâ ƒë·ªãnh khi ch√∫ng ta t·∫°o `server`.
5.  `>` cho bi·∫øt d·ªØ li·ªáu `cURL` ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn `server`.
6.  `<` cho bi·∫øt d·ªØ li·ªáu `cURL` ƒë√£ nh·∫≠n ƒë∆∞·ª£c t·ª´ `server`.
7.  Cu·ªëi c√πng, b·∫°n th·∫•y vƒÉn b·∫£n ph·∫£n h·ªìi m√† `server` ƒë√£ g·ª≠i

N·∫øu b·∫°n l·∫≠t qua `tab Terminal` n∆°i `server` ƒëang ch·∫°y, b·∫°n s·∫Ω th·∫•y m·ªôt `output` r·∫•t d√†i. ƒê√¢y l√† ƒë·ªëi t∆∞·ª£ng '`request`' m√† `server` c·ªßa ch√∫ng ta x√¢y d·ª±ng t·ª´ d·ªØ li·ªáu ch√∫ng ta ƒë√£ g·ª≠i ƒë·∫øn `server`.

B∆∞·ªõc 6. C√†i ƒë·∫∑t `uuid` ƒë·ªÉ t·ª± ƒë·ªông t·∫°o c√°c `unique string`
------------------------------------------------------

B√¢y gi·ªù, h√£y m·ªü m·ªôt `Terminal` m·ªõi trong th∆∞ m·ª•c `server` v√† c√†i ƒë·∫∑t m√¥-ƒëun `uuid`, gi√∫p ch√∫ng ta t·∫°o c√°c `string ng·∫´u nhi√™n`. (M·ªü m·ªôt tab kh√°c s·∫Ω cho ph√©p ch√∫ng ta c√†i ƒë·∫∑t c√°c g√≥i cho `server` c·ªßa m√¨nh m√† kh√¥ng ph·∫£i d·ª´ng qu√° tr√¨nh `server` hi·ªán t·∫°i. Khi ch√∫ng ta ƒë∆∞a c√°c m√¥-ƒëun m·ªõi v√†o t·ªáp `server.js` c·ªßa m√¨nh, `nodemon` s·∫Ω t·ª± ƒë·ªông kh·ªüi ƒë·ªông l·∫°i v√† c√≥ th·ªÉ k√©o c√°c m√¥-ƒëun n√†y v√†o.)

`server $ npm install --save uuid`

Sau ƒë√≥, ch√∫ng ta th√™m n√≥ v√†o t·ªáp `server` c·ªßa ch√∫ng ta v√† c·∫≠p nh·∫≠t vƒÉn b·∫£n ph·∫£n h·ªìi c·ªßa ch√∫ng ta ƒë·ªÉ g·ª≠i n√≥ ƒë·∫øn `client`. L∆∞u √Ω, m√¨nh ƒëang s·ª≠ d·ª•ng `string interpolation` trong v√≠ d·ª• b√™n d∆∞·ªõi ([N·∫øu b·∫°n ch∆∞a quen v·ªõi c√°ch s·ª≠ d·ª•ng n√†y h√£y tham kh·∫£o t·∫°i ƒë√¢y](https://viblo.asia/p/blog1-nhung-kien-thuc-javascript-can-ban-ma-mot-react-dev-phai-thuoc-nam-long-series-bi-kip-javascript-phan-1-AZoJj7yOLY7)), `request` s·ª≠ d·ª•ng '\`\`' thay v√¨ d·∫•u ngo·∫∑c k√©p. ƒê√≥ l√† (\`\`) kh√¥ng ph·∫£i l√† (''). (C√≥ th·ªÉ ·ªü g·∫ßn ph√≠a tr√™n b√™n tr√°i tr√™n b√†n ph√≠m c·ªßa b·∫°n.)

```javascript
//npm modules
const express = require('express');
const { v4: uuid } = require("uuid");

// create the server
const app = express();

// create the homepage route at '/'
app.get('/', (req, res) => {
  console.log(req)
  const uniqueId = uuid()
  res.send(`Hit home page. Received the unique id: ${uniqueId}\n`)
})

// tell the server what port to listen on
app.listen(3000, () => {
  console.log('Listening on localhost:3000')
})
```

B√¢y gi·ªù h√£y g·ªçi l·∫°i `cURL`.

```
client $ curl -X GET http://localhost:3000
Hit home page. Received the unique id: 044e0263-58b7-4c7f-a032-056cd81069e3
```

B∆∞·ªõc 7. Add/configure `express-session`
-----------------------------------------

C√†i ƒë·∫∑t `express-session`. Middleware n√†y x·ª≠ l√Ω vi·ªác t·∫°o `session` v√¨ `express` kh√¥ng t·ª± ƒë·ªông l√†m ƒëi·ªÅu n√†y.

`server $ npm install express-session --save`

Sau khi n√≥ ƒë∆∞·ª£c c√†i ƒë·∫∑t, h√£y s·ª≠a ƒë·ªïi t·ªáp `server.js` c·ªßa ch√∫ng ta theo nh·ªØng c√°ch sau:

1.  T·∫°o m·ªôt instance `express-session` th√¥ng qua require
2.  Add/configure ·ª©ng d·ª•ng c·ªßa ch√∫ng ta ƒë·ªÉ s·ª≠ d·ª•ng `middleware` `session` v·ªõi `id session duy nh·∫•t` m√† ch√∫ng ta t·∫°o. Ch√∫ng ta s·∫Ω ghi log ƒë·ªëi t∆∞·ª£ng `request.sessionID` tr∆∞·ªõc v√† sau khi `middleware` ƒë∆∞·ª£c s·ª≠ d·ª•ng.
3.  G·ª≠i `sessionID` cho `client`

L∆∞u √Ω, trong c·∫•u h√¨nh session b√™n d∆∞·ªõi, m√¨nh ƒë·ªÉ '`secret`' l√† '`keyboard cat`', nh∆∞ng trong th·ª±c t·∫ø, b·∫°n s·∫Ω thay th·∫ø ƒëi·ªÅu n√†y b·∫±ng m·ªôt `string` ƒë∆∞·ª£c l·∫•y t·ª´ bi·∫øn m√¥i tr∆∞·ªùng.

```javascript
//npm modules
const express = require('express');
const { v4: uuid } = require("uuid");
const session = require('express-session')

// create the server
const app = express();

// add & configure middleware
app.use(session({
  genid: (req) => {
    console.log('Inside the session middleware')
    console.log(req.sessionID)
    return uuid() // use UUIDs for session IDs
  },
  secret: 'keyboard cat',
  resave: false,
  saveUninitialized: true
}))

// create the homepage route at '/'
app.get('/', (req, res) => {
  console.log('Inside the homepage callback function')
  console.log(req.sessionID)
  res.send(`You hit home page!\n`)
})

// tell the server what port to listen on
app.listen(3000, () => {
  console.log('Listening on localhost:3000')
})
```

B√¢y gi·ªù, h√£y g·ªçi l·∫°i request curl b·∫±ng flag -v.

```console
curl -X GET http://localhost:3000 -v
...
< set-cookie: connect.sid=s%3A5199f3ed-3f5a-4478-aed7-fab9ce6ca378.DjQlJ%2F1t%2F00RAfIs5yW6CEsVUXM25aMclq7VGzxVnoY; Path=/; HttpOnly
...
```

M√¨nh ƒë√£ c·∫Øt ƒëi nh·ªØng ph·∫ßn ko c·∫ßn thi·∫øt ·ªü ph·∫ßn `Log` ·ªü tr√™n, nh∆∞ng b·∫°n c√≥ th·ªÉ th·∫•y r·∫±ng trong d·ªØ li·ªáu ƒë∆∞·ª£c tr·∫£ v·ªÅ t·ª´ `server` (ƒë∆∞·ª£c bi·ªÉu th·ªã b·∫±ng k√Ω hi·ªáu `<`) ch√∫ng ta ƒëang ƒë·∫∑t `ID session` th√†nh `uuid`. N·∫øu ch√∫ng ta m·ªü sang tab terminal `server` c·ªßa m√¨nh, ch√∫ng ta s·∫Ω th·∫•y nh∆∞ sau:

```console
Inside the session middleware
undefined
Inside the homepage callback function
5199f3ed-3f5a-4478-aed7-fab9ce6ca378
```

Khi ch√∫ng ta ghi l·∫°i `req.sessionID` b√™n trong `middleware session`, session v·∫´n ch∆∞a ƒë∆∞·ª£c kh·ªüi t·∫°o, v√¨ v·∫≠y ch√∫ng ta ch∆∞a th√™m `sessionID` v√†o ƒë·ªëi t∆∞·ª£ng request. Tuy nhi√™n, khi ch√∫ng ta nh·∫≠n ƒë∆∞·ª£c l·ªánh `callback` t·ª´ `request GET` c·ªßa m√¨nh, `middleware session` ƒë√£ ƒë∆∞·ª£c ch·∫°y v√† th√™m `sessionID` v√†o ƒë·ªëi t∆∞·ª£ng request.

H√£y th·ª≠ g·ªçi h√†m `cURL` v√†i l·∫ßn n·ªØa. B·∫°n s·∫Ω th·∫•y r·∫±ng m·ªôt `id session` m·ªõi ƒë∆∞·ª£c t·∫°o m·ªói l·∫ßn g·ªçi. **C√°c tr√¨nh duy·ªát** **s·∫Ω t·ª± ƒë·ªông l∆∞u `id session`** v√† g·ª≠i n√≥ theo t·ª´ng `request` ƒë·∫øn `server`; tuy nhi√™n, **cURL kh√¥ng** t·ª± ƒë·ªông l∆∞u `ID session` c·ªßa ch√∫ng ta v√† g·ª≠i n√≥ trong `headers request`. H√£y c√πng fix n√≥ nh√© ƒëi·ªÅu ƒë√≥. H√£y s·ª≠ d·ª•ng l·∫°i `cURL`, v√† s·ª≠ d·ª•ng flag '-c' v√† ƒëo·∫°n text 'cookie-file.txt'.

`client $ curl -X GET http://localhost:3000 -c cookie-file.txt`

ƒêi·ªÅu n√†y t·∫°o ra m·ªôt t·ªáp vƒÉn b·∫£n trong th∆∞ m·ª•c /client c·ªßa ch√∫ng ta c√≥ t√™n l√† 'cookie-file.txt'. B·∫°n s·∫Ω th·∫•y t·ªáp vƒÉn b·∫£n n√†y xu·∫•t hi·ªán trong project c·ªßa m√¨nh. B√¢y gi·ªù ch√∫ng ta c√≥ th·ªÉ g·ªçi l·∫°i `curl`, nh∆∞ng l·∫ßn n√†y g·ªçi `cookie-file.txt` v·ªõi flag '-b' request `cURL` g·ª≠i `id session` c·ªßa s·∫Ω ƒë∆∞·ª£c g·ª≠i trong d·ªØ li·ªáu `headers` c·ªßa ch√∫ng ta. H√£y c≈©ng s·ª≠ d·ª•ng th√™m flag '`-v`' ƒë·ªÉ xem ƒëi·ªÅu n√†y.

```console
curl -X GET http://localhost:3000 -b cookie-file.txt -v
...
> GET / HTTP/1.1
> Host: localhost:3000
> User-Agent: curl/7.54.0
> Accept: */*
> Cookie: connect.sid=s%3Ade59a40f-6737-4b8d-98bf-bf2bb8495118.e0pWTi2w8%2FAAOKxKgKDBdu99JnspruYSEgLSV3tvxX4
...
```

M√¨nh c≈©ng ƒë√£ c·∫Øt ƒëi nh·ªØng ph·∫ßn ko c·∫ßn thi·∫øt ·ªü ph·∫ßn `Output` ·ªü tr√™n, nh∆∞ng nh∆∞ b·∫°n c√≥ th·ªÉ th·∫•y, `id session` ƒëang ƒë∆∞·ª£c g·ª≠i trong `headers request` c·ªßa ch√∫ng ta v√† ch√∫ng ta bi·∫øt n√≥ ƒë∆∞·ª£c g·ª≠i t·ªõi `server` v√¨ c√≥ bi·ªÉu t∆∞·ª£ng `>`. H√£y th·ª≠ g·ªçi h√†m n√†y bao nhi√™u l·∫ßn t√πy th√≠ch. N·∫øu b·∫°n chuy·ªÉn qua ph·∫ßn `output` c·ªßa` terminal server`, b·∫°n s·∫Ω th·∫•y r·∫±ng c√πng m·ªôt `id session` ƒëang ƒë∆∞·ª£c xu·∫•t ra `Terminal` m·ªói l·∫ßn request. B·∫°n c≈©ng c√≥ th·ªÉ nh·∫≠n th·∫•y, ch√∫ng ta kh√¥ng th·∫•y consolog '`Inside the session middleware`' ƒë∆∞·ª£c t·∫°o. ƒêi·ªÅu n√†y l√† do h√†m '`genid`' c·ªßa ch√∫ng ta kh√¥ng ƒë∆∞·ª£c g·ªçi v√¨ id ƒë√£ ƒë∆∞·ª£c ƒë∆∞a v√†o.

Tuy nhi√™n, ch√∫ng ta l·∫°i c√≥ 1 v·∫•n ƒë·ªÅ ·ªü ƒë√¢y. H√£y th·ª≠ kh·ªüi ƒë·ªông l·∫°i `server` c·ªßa ch√∫ng ta.

Trong tab `Terminal` n∆°i `server` ƒëang ch·∫°y, nh·∫•n 'Ctrl + C' sau ƒë√≥ kh·ªüi ƒë·ªông n√≥ b·∫±ng `nodemon`.

```console
Inside the homepage callback function
de59a40f-6737-4b8d-98bf-bf2bb8495118
^C
server $ nodemon server.js
Listening on localhost:3000
```

T·ª´ th∆∞ m·ª•c client, h√£y g·ªçi l·∫°i l·ªánh `cURL`.

```
client $ curl -X GET http://localhost:3000 -b cookie-file.txt
```

Sau ƒë√≥ nh√¨n l·∫°i nh·∫≠t k√Ω server m·ªôt l·∫ßn n·ªØa.

```
Listening on localhost:3000
Inside the session middleware
de59a40f-6737-4b8d-98bf-bf2bb8495118
Inside the homepage callback function
ac656d2a-9796-4560-9dbf-73996a1853f8
```

Nh∆∞ b·∫°n c√≥ th·ªÉ th·∫•y ·ªü tr√™n, h√†m `genid middleware session` c·ªßa ch√∫ng ta ƒëang ƒë∆∞·ª£c g·ªçi. ƒêi·ªÅu n√†y l√† do `session` ƒë√£ ƒë∆∞·ª£c l∆∞u tr·ªØ trong b·ªô nh·ªõ c·ªßa `server`. V√¨ v·∫≠y, khi ch√∫ng ta kh·ªüi ƒë·ªông l·∫°i `server`, `id session` ƒë√£ b·ªã x√≥a c√πng v·ªõi ph·∫ßn c√≤n l·∫°i c·ªßa b·ªô nh·ªõ. ƒê√¢y l√† v·∫•n ƒë·ªÅ.

1.  `Server` ƒë∆∞·ª£c kh·ªüi ƒë·ªông l·∫°i v√† b·ªô nh·ªõ `session` b·ªã x√≥a.
2.  Ch√∫ng ta g·ª≠i `request cURL` c·ªßa ch√∫ng ta ƒë·∫øn `server` c√πng v·ªõi `id session` c·ªßa ch√∫ng ta
3.  `Server` nh·∫≠n c√°c `request` v√† `middleware session` kh√¥ng th·ªÉ t√¨m th·∫•y `id session` trong b·ªô nh·ªõ, v√¨ v·∫≠y n√≥ g·ªçi h√†m `genid`
4.  H√†m `genid` logging r·∫±ng ch√∫ng ta ƒëang ·ªü b√™n trong `middleware session` v√† n√≥ ghi l·∫°i `id session` c·ªßa ƒë·ªëi t∆∞·ª£ng `request`. V√¨ ch√∫ng ta ƒë√£ g·ª≠i `id session` trong `request cURL` c·ªßa m√¨nh, ƒë·ªëi t∆∞·ª£ng `request` ƒë√£ th·ª±c s·ª± ƒë∆∞·ª£c kh·ªüi t·∫°o v·ªõi `id session` ƒë√≥. Tuy nhi√™n, `id session` n√†y b·ªã ghi ƒë√® b·ªüi `value` tr·∫£ v·ªÅ c·ªßa h√†m `genid`.
5.  Khi `middleware session` ƒë∆∞·ª£c th·ª±c hi·ªán xong ghi ƒë√® `id session` m√† ch√∫ng ta ƒë√£ g·ª≠i, quy·ªÅn ki·ªÉm so√°t ƒë∆∞·ª£c chuy·ªÉn giao cho h√†m callback trong `app.get()`, n∆°i ch√∫ng ta ghi l·∫°i r·∫±ng ch√∫ng ta ƒëang ·ªü b√™n trong h√†m `callback hompage` v√† ghi l·∫°i id m·ªõi. 

H√£y th·ª±c hi·ªán `curl request` ƒë√≥ m·ªôt l·∫ßn n·ªØa t·ª´ th∆∞ m·ª•c `client` ƒë·ªÉ hi·ªÉu h∆°n v·ªÅ ph·∫ßn gi·∫£i th√≠ch tr√™n b·∫±ng c√°ch nh√¨n v√†o th·ª© t·ª± `log` ƒë√£ ƒë∆∞·ª£c ghi ra. ƒê·ªìng th·ªùi nh√¨n v√†o `source code` ƒë·ªÉ tham chi·∫øu c√°c b∆∞·ªõc:

`client $ curl -X GET http://localhost:3000 -b cookie-file.txt`

Xem l·∫°i nh·∫≠t k√Ω server.

```
Inside the session middleware
de59a40f-6737-4b8d-98bf-bf2bb8495118
Inside the homepage callback function
b02aa920-7031-427f-ac2e-b82f21140002
```

M·ªôt l·∫ßn n·ªØa, server c·ªßa ch√∫ng ta ph·∫£n h·ªìi v·ªõi m·ªôt `id session` kh√°c, v√¨ ch√∫ng ta ƒë√£ g·ª≠i c√πng m·ªôt `id session` t·ª´ tr∆∞·ªõc khi ch√∫ng ta kh·ªüi ƒë·ªông l·∫°i `server`. Ch√∫ng ta c·∫ßn g·ªçi l·∫°i `request curl`, nh∆∞ng l·∫ßn n√†y passed flag '-c' ƒë·ªÉ ch√∫ng ta ghi ƒë√® th√¥ng tin `session` hi·ªán c√≥.

`client $ curl -X GET http://localhost:3000 -c cookie-file.txt`

Quay l·∫°i nh·∫≠t k√Ω server.

```
Inside the session middleware
undefined
Inside the homepage callback function
74f37795-6fcf-4300-beb9-3de41395eafe
```

`Req.sessionID` kh√¥ng ƒë∆∞·ª£c x√°c ƒë·ªãnh, v√¨ ch√∫ng ta ƒë√£ kh√¥ng g·ª≠i th√¥ng tin `session` trong `request curl` c·ªßa ch√∫ng ta. H√£y xem `cookie-file.txt` c·ªßa ch√∫ng ta. Ch·∫Øc ch·∫Øn, c√≥ `id session` ƒë√£ ƒë∆∞·ª£c t·∫°o v√† g·ª≠i l·∫°i.

```
...
#HttpOnly_localhost FALSE / FALSE 0 connect.sid s%3A74f37795-6fcf-4300-beb9-3de41395eafe.5mblOCOvpwAMh7bNuTZ9qyloG5UOcIczep5GjMnVEi8
```

B√¢y gi·ªù, n·∫øu ch√∫ng ta g·ªçi l·∫°i `request curl` b·∫±ng flag '`-b`'. Ch√∫ng ta s·∫Ω kh√¥ng th·∫•y nh·∫≠t k√Ω '`Inside the session middle`' ƒë∆∞·ª£c ghi ra `output`, v√¨ `genid` kh√¥ng ƒë∆∞·ª£c g·ªçi. `Id session` ƒëang ƒë∆∞·ª£c kh·ªõp v·ªõi `id session` trong b·ªô nh·ªõ.

M·∫∑c d√π v·∫≠y, ch√∫ng ta v·∫´n ch∆∞a gi·∫£i quy·∫øt ƒë∆∞·ª£c v·∫•n ƒë·ªÅ ƒëang g·∫∑p ph·∫£i. N·∫øu ch√∫ng ta kh·ªüi ƒë·ªông l·∫°i `server` c·ªßa m√¨nh, b·ªô nh·ªõ s·∫Ω b·ªã x√≥a m·ªôt l·∫ßn n·ªØa. V√¨ v·∫≠y, ch√∫ng ta c·∫ßn c√≥ m·ªôt s·ªë c√°ch ƒë·ªÉ ƒë·∫£m b·∫£o r·∫±ng ch√∫ng ta c√≥ th·ªÉ l∆∞u `id session` c·ªßa m√¨nh ngay c·∫£ khi `server` t·∫Øt. ƒê√≥ l√† khi ch√∫ng ta c·∫ßn ƒë·∫øn '`session store`'. Th√¥ng th∆∞·ªùng, c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n s·∫Ω ho·∫°t ƒë·ªông nh∆∞ m·ªôt kho l∆∞u tr·ªØ `session`, nh∆∞ng v√¨ ch√∫ng ta ƒëang c·ªë g·∫Øng gi·ªØ m·ªçi th·ª© trong trong b√†i vi·∫øt n√†y ƒë∆°n gi·∫£n nh·∫•t c√≥ th·ªÉ, ch√∫ng ta h√£y ch·ªâ l∆∞u tr·ªØ th√¥ng tin `session` c·ªßa m√¨nh trong t·ªáp vƒÉn b·∫£n.

N·∫øu b·∫°n truy c·∫≠p v√†o [t√†i li·ªáu nhanh](https://github.com/expressjs/session), b·∫°n s·∫Ω th·∫•y r·∫±ng c√≥ m·ªôt s·ªë `npm packages` ƒë∆∞·ª£c cung c·∫•p ƒë·ªÉ ho·∫°t ƒë·ªông nh∆∞ m·ªôt b·ªô nh·ªõ `cache` hay c√°i g√¨ g√¨ ƒë√≥ n·∫±m gi·ªØa `c∆° s·ªü d·ªØ li·ªáu` c·ªßa b·∫°n v√† `middleware session`. Ch√∫ng ta s·∫Ω s·ª≠ d·ª•ng c√°i g·ªçi l√† '[session-file-store](https://www.npmjs.com/package/session-file-store).' Trong th·ª±c t·∫ø th√¨ ch√∫ng ta s·ª≠ d·ª•ng `Redis` ho·∫∑c `DynamoDB` (d·ª± √°n m√¨nh ƒëang d√πng `DynamoDB`) nh∆∞ng ƒë·ª´ng lo l·∫Øng n·∫øu b·∫°n hi·ªÉu c√°i n√†y th√¨ b·∫°n c≈©ng s·∫Ω s·ª≠ d·ª•ng ƒë∆∞·ª£c nh·ªØng c√°i kia m·ªôt c√°ch hi·ªáu qu·∫£.
Nh∆∞ th∆∞·ªùng l·ªá, ch√∫ng ta h√£y c√†i ƒë·∫∑t n√≥.

`server $ npm install session-file-store --save`

B√¢y gi·ªù, h√£y th√™m n√≥ v√†o t·ªáp `server.js` c·ªßa ch√∫ng ta.

```javascript
//npm modules
const express = require('express');
const { v4: uuid } = require("uuid");
const session = require('express-session')
const FileStore = require('session-file-store')(session);

// create the server
const app = express();

// add & configure middleware
app.use(session({
  genid: (req) => {
    console.log('Inside the session middleware')
    console.log(req.sessionID)
    return uuid() // use UUIDs for session IDs
  },
  store: new FileStore(),
  secret: 'keyboard cat',
  resave: false,
  saveUninitialized: true
}))

// create the homepage route at '/'
app.get('/', (req, res) => {
  console.log('Inside the homepage callback function')
  console.log(req.sessionID)
  res.send(`You hit home page!\n`)
})

// tell the server what port to listen on
app.listen(3000, () => {
  console.log('Listening on localhost:3000')
})
```

L∆∞u √Ω ·ªü tr√™n, r·∫±ng ch√∫ng ta ƒëang g·ªçi bi·∫øn `session` khi ch√∫ng ta `request FileStore`. Sau ƒë√≥, ch√∫ng ta th√™m m·ªôt `instance` v√†o `FileStore` v√†o `c·∫•u h√¨nh session` c·ªßa ch√∫ng ta.

Ch√∫ng ta c≈©ng c·∫ßn ph·∫£i l√†m m·ªôt vi·ªác kh√°c. Theo m·∫∑c ƒë·ªãnh, khi ch√∫ng ta s·ª≠ d·ª•ng m√¥-ƒëun '`session-file-store`', n√≥ s·∫Ω t·∫°o m·ªôt th∆∞ m·ª•c '`/session`' m·ªõi khi n√≥ ƒë∆∞·ª£c g·ªçi l·∫ßn ƒë·∫ßu ti√™n. L·∫ßn ƒë·∫ßu ti√™n v√† m·ªói l·∫ßn ti·∫øp theo khi ch√∫ng ta t·∫°o m·ªôt `session m·ªõi`, m√¥-ƒëun s·∫Ω t·∫°o m·ªôt t·ªáp m·ªõi cho th√¥ng tin `session` trong th∆∞ m·ª•c `/session`. V√¨ ch√∫ng ta nh·∫≠p `session-file-store` trong `server.js` v√† `session-file-store` ph·ª• thu·ªôc v√†o th∆∞ m·ª•c `/session`, n√™n `node` s·∫Ω kh·ªüi ƒë·ªông l·∫°i `server` m·ªói khi ch√∫ng ta t·∫°o m·ªôt `session m·ªõi`. C√°i n√†y th√¨ ko ƒë∆∞·ª£c k·ªÉ c·∫£ trong m√¥i tr∆∞·ªùng `dev` th√¨ ch·∫£ nh·∫Ω c·ª© m·ªói l·∫ßn `request` l·∫°i `restart` l·∫°i `server` -> ko ·ªïn.

Ch√∫ng ta c√≥ th·ªÉ `request nodemon` b·ªè qua m·ªôt t·ªáp ho·∫∑c th∆∞ m·ª•c b·∫±ng c√°ch g·ªçi '`- ignore`' v√† th√™m n√≥ v√†o t√™n t·ªáp ho·∫∑c th∆∞ m·ª•c.

`server $ nodemon --ignore sessions /server.js`

B·∫°n s·∫Ω c·∫£m th·∫•y kh√≥ kh·∫Øn n·∫øu m·ªói l·∫ßn c·∫ßn run n√≥ l·∫°i ph·∫£i g√µ m·ªôt ƒëo·∫°n d√†i nh∆∞ v·∫≠y. H√£y t·ª± l√†m cho n√≥ d·ªÖ d√†ng h∆°n b·∫±ng c√°ch th√™m n√≥ tr·ª±c ti·∫øp v√†o c√°c t·∫≠p l·ªánh `npm` c·ªßa ch√∫ng ta trong t·ªáp `package.json`.

```json
{
  "name": "server",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "dev:server": "nodemon --ignore sessions/ server.js" // B·∫°n th√™m d√≤ng n√†y v√†o l√† ok
  },
  "author": "",
  "license": "ISC",
  "dependencies": {
    "express": "^4.16.2",
    "express-session": "^1.15.6",
    "session-file-store": "^1.1.2",
    "uuid": "^3.1.0"
  }
}
```

B·∫°n ƒë√£ th√™m c√¢u l·ªánh ·ªü tr√™n v√†o file `package.json` b·∫°n ho√†n to√†n c√≥ th·ªÉ g·ªçi l·ªánh nh∆∞ sau n√≥ t∆∞∆°ng ƒë∆∞∆°ng v·ªõi l·ªánh m√† ch√∫ng ta ƒë√£ `setup` cho n√≥: (ƒë·ª´ng qu√™n t·∫Øt server tr∆∞·ªõc khi run l·∫°i l·ªánh n√†y nh√©)

`server $ npm run dev:server`

B√¢y gi·ªù ch√∫ng ta h√£y t·∫°o l·ªánh g·ªçi `cURL` v√† t·∫°o m·ªôt t·ªáp `cookie m·ªõi` s·∫Ω ƒë∆∞·ª£c l∆∞u v√†o th∆∞ m·ª•c `client`.

`client $ curl -X GET http://localhost:3000 -c cookie-file.txt`

File `Cookie-file.txt` c·ªßa b·∫°n b√¢y gi·ªù s·∫Ω c√≥ m·ªôt `id session` m·ªõi ƒë∆∞·ª£c l∆∞u trong ƒë√≥. N·∫øu b·∫°n b·ªè qua '`...s%3A`', th√¨ ph·∫ßn c√≤n l·∫°i tr∆∞·ªõc d·∫•u '.' ph·∫£i kh·ªõp v·ªõi t√™n c·ªßa t·ªáp m·ªõi ƒë∆∞·ª£c l∆∞u trong th∆∞ m·ª•c `/session`.

B√¢y gi·ªù kh·ªüi ƒë·ªông l·∫°i server m·ªôt l·∫ßn n·ªØa.

`server $ npm run dev:server`

Sau ƒë√≥, g·ªçi l·ªánh `cURL` truy·ªÅn cho n√≥ file `cookie-file.txt` v·ªõi flag '-b' trong l·∫ßn g·ªçi n√†y, ƒë·ªÉ n√≥ g·ª≠i `id session` m√† ch√∫ng ta ƒë√£ t·∫°o tr∆∞·ªõc khi ch√∫ng ta kh·ªüi ƒë·ªông l·∫°i `server`.

`client $ curl -X GET http://localhost:3000 -b cookie-file.txt`

H√£y th·ª≠ g·ªçi n√≥ bao nhi√™u t√πy th√≠ch. B·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c c√πng m·ªôt `output` `id session` m·ªçi l·∫ßn `request`. V√¨ v·∫≠y, ch√∫ng ta c√≥ th·ªÉ th·∫•y ·ªü ƒë√¢y vi·ªác t·∫°o kho l∆∞u tr·ªØ t·ªáp `session` cho ph√©p ch√∫ng ta l∆∞u c√°c `session` ·ªü ph√≠a `server`.

gi·ªù b·∫°n ƒë√£ c√≥ m·ªôt `Server nodejs` s∆° khai kh√¥ng c√≥ `Authentication` nh∆∞ng ƒë√£ c√≥ th·ªÉ nh·∫≠n bi·∫øt ƒë∆∞·ª£c `request` ƒë∆∞·ª£c g·ª≠i t·ª´ `id session` n√†o.

[·ªû b√†i ti·∫øp theo m√¨nh s·∫Ω h∆∞·ªõng d·∫´n b·∫°n c√°ch `Authentication` v√† ho√†n ch·ªânh m·ªôt `Server nodejs`. (PH·∫¶N 2)](https://viblo.asia/p/blog25-tat-ca-nhung-thu-ban-can-de-xay-dung-mot-nodejs-server-authentication-co-ban-express-sessions-passport-and-curl-part-22-series-bi-kip-javascript-phan-21-E1XVOoA6VMz)

Nh∆∞ m·ªçi khi, m√¨nh hy v·ªçng b·∫°n th√≠ch b√†i vi·∫øt n√†y v√† bi·∫øt th√™m ƒë∆∞·ª£c ƒëi·ªÅu g√¨ ƒë√≥ m·ªõi.

C·∫£m ∆°n v√† h·∫πn g·∫∑p l·∫°i c√°c b·∫°n trong nh·ªØng b√†i vi·∫øt ti·∫øp theo! üòç

N·∫øu b·∫°n th·∫•y Blog n√†y hay xin h√£y cho m√¨nh m·ªôt like v√† ƒëƒÉng k√Ω ƒë·ªÉ ·ªßng h·ªô m√¨nh nh√©. Thank you.üòâ

# Ref
* https://tuan200tokyo.blogspot.com/2022/10/blog24-tat-ca-nhung-thu-ban-can-e-xay.html