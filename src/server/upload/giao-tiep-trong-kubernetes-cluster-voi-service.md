Helloooooooooooooooooooooooo nh·ªØng ng∆∞·ªùi anh em thi·ªán l√†nh üëãüëã

Cu·ªôc s·ªëng c·ªßa anh em c√≥ ·ªïn kh√¥ng? c√≥ gi·ªëng anh em hi v·ªçng, ƒë·ªìng nghi·ªáp c√≥ d·ªÖ th∆∞∆°ng, s·∫øp c√≥ b·∫Øt ch·∫°y deadline hay kh√¥ng???? ü§ó M√¨nh th√¨ v·∫´n nh·ªõ Vi·ªát Nam qu√° ü•≤

...

M√† th√¥i, nh·ªõ nhung ƒë√†nh ph·∫£i ƒë·ªÉ sau, h√¥m nay ta ti·∫øp t·ª•c v·ªõi [series h·ªçc Kubernetes](https://viblo.asia/s/hoc-kubernetes-tu-co-ban-den-gan-nang-cao-aAY4qQ6w4Pw) nh√©, ·ªü b√†i tr∆∞·ªõc ta ƒë√£ t√¨m hi·ªÉu v·ªÅ [Pod tr√™n K8S](https://viblo.asia/p/mo-dau-voi-pod-tren-kubernetes-2oKLn2ryLQO), kh√¥ng bi·∫øt c√°c b·∫°n ƒë√£ th·∫•m ch∆∞a?

ƒêo·∫°n ƒë·∫ßu l√∫c m√¨nh m·ªõi h·ªçc K8S c≈©ng c√≥ r·∫•t nhi·ªÅu ch·ªó m√¨nh th·∫•y m∆° h·ªì v√† tr·ª´u t∆∞·ª£ng qu√°, c≈©ng v·∫≠t v√£ m·ªôt th·ªùi gian ƒë√≥, nh∆∞ng d·∫ßn d·∫ßn th√¨ th·ª±c h√†nh nhi·ªÅu r·ªìi c≈©ng quen.

·ªû b√†i n√†y ta s·∫Ω c√πng t√¨m hi·ªÉu v·ªÅ Service tr√™n K8S nh√©. Anh em theo m√¨nh l√™n t√†u n√†o.....üöÄüõ©Ô∏èüõ©Ô∏è

# L·∫•y K8S Session
Tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu c√°c b·∫°n ƒë·∫£m gi√∫p m√¨nh l√† ƒë√£ l·∫•y ƒë∆∞·ª£c K8S Session ƒë·ªÉ truy c·∫≠p v√†o cluster c·ªßa m√¨nh ƒë·∫ª l√°t n·ªØa ta th·ª±c h√†nh nh√©. Xem l·∫°i [b√†i c≈© gi√∫p m√¨nh nh√©](https://viblo.asia/p/mo-dau-voi-pod-tren-kubernetes-2oKLn2ryLQO#_setup-0)
# M·ªü ƒë·∫ßu
Nh∆∞ ·ªü b√†i tr∆∞·ªõc - [t√¨m hi·ªÉu v·ªÅ Pod](https://viblo.asia/p/mo-dau-voi-pod-tren-kubernetes-2oKLn2ryLQO) m√¨nh c√≥ tr√¨nh b√†y, m·ªói khi Pod ƒë∆∞·ª£c t·∫°o ra th√¨ n√≥ s·∫Ω ƒë∆∞·ª£c g√°n 1 ClusterIP, l√† duy nh·∫•t (global unique) tr√™n to√†n b·ªô Cluster. Ta c√≥ th·ªÉ d√πng ClusterIP ƒë√≥ v√† g·ªçi v√†o port. 

![](https://images.viblo.asia/bff86dd7-eb17-445e-8af9-0603c15677f1.png)

V·∫≠y nh∆∞ng c√≥ 1 v√†i ƒëi·ªÉm ta c·∫ßn l∆∞u √Ω:
- ClusterIP kia l√† ƒë·ªông (dynamic) ƒë∆∞·ª£c g√°n b·ªüi Kubernetes Control Plan
- S·ªë l∆∞·ª£ng Pod cho app c·ªßa ch√∫ng ta t·∫°i m·ªói th·ªùi ƒëi·ªÉm c√≥ th·ªÉ kh√°c nhau: ban ƒë·∫ßu c√≥ 1 pod, sau traffic cao th√¨ t·ª± autoscale l√™n 10 pods. C√°c pod c√≥ th·ªÉ b·ªã kh·ªüi t·∫°o v√† destroy ƒëi m·ªôt c√°ch t·ª± ƒë·ªông.

V·∫≠y c√¢u h·ªèi ƒë·∫∑t ra l√†: gi·∫£ s·ª≠ ta c√≥ Frontend (1 pod), c·∫ßn g·ªçi API v√†o Backend (10 pods), v·∫≠y th√¨ Frontend c√≥ c·∫ßn ph·∫£i l∆∞u 10 Cluster IP c·ªßa Backend??? Hay khi Backend autoscale l√™n 20 pods th√¨ Frontend c√≥ c·∫ßn t·ª± "t√¨m" r·ªìi th√™m v√†o 10 Cluster IP n·ªØa

# K8S Service
## M·ªü ƒë·∫ßu
ƒê·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ tr√™n th√¨ K8S cung c·∫•p cho ch√∫ng ta Service, n∆°i ta c√≥ th·ªÉ ƒë·ªãnh nghƒ©a logics c√°ch truy c·∫≠p v√†o 1 t·∫≠p h·ª£p 1 ho·∫∑c nhi·ªÅu pod ƒë·ªÉ c√°c app kh√°c c√≥ th·ªÉ g·ªçi v√†o. C√°i "t·∫≠p h·ª£p c√°c Pod" kia th∆∞·ªùng ƒë∆∞·ª£c ƒëinh nghƒ©a b·ªüi `selector` - l√°t n·ªØa ta s·∫Ω xem selector l√† g√¨ nh√©

C√°c b·∫°n t∆∞·ªüng t∆∞·ª£ng Service n√≥ nh∆∞ ki·ªÉu "t·ªï tr∆∞·ªüng d√¢n ph·ªë" v·∫≠y, ng∆∞·ªùi n·∫Øm gi·ªØ th√¥ng tin c√°c c∆∞ d√¢n trong ph·ªë c·ªßa m√¨nh, n·∫øu ai mu·ªën h·ªèi g√¨ th√¨ c√≥ th·ªÉ h·ªèi tr·ª±c ti·∫øp √¥ng √Ω, thay v√¨ t·ª± ƒëi t√¨m :)

Tr∆∞·ªõc khi ƒë·ªãnh nghƒ©a service th√¨ ta c·∫ßn deploy 1 Pod n√†o ƒë√≥ tr∆∞·ªõc ƒë·ªÉ test nh√©, c√°c b·∫°n t·∫°o cho m√¨nh 1 file manifest m·ªõi v·ªõi n·ªôi dung nh∆∞ sau, gi·∫£ s·ª≠ ta ƒë·∫∑t t√™n l√† `pod.yml` nh√©:

```go:yml
apiVersion: v1
kind: Pod
metadata:
  name: helloworld
spec:
  containers:
  - name: helloworld
    image: tutum/hello-world
    ports:
    - containerPort: 80
    resources:
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"
```
Nom ƒë√£ quen d·∫ßn ch∆∞a c√°c b·∫°n ;), b√™n tr√™n ta c√≥ 1 pod t√™n `helloworld` c√≥ 1 container trong ƒë√≥ c≈©ng t√™n l√† `helloworld` ch·∫°y image nh∆∞ tr√™n, expose port 80, port n√†y l√°t n·ªØa Service c·ªßa ta s·∫Ω d√πng nh√©

> ch√∫ √Ω ph·∫ßn resource b√™n tr√™n l√† ƒë·ªÉ ƒë·ªãnh nghƒ©a cpu/RAM t·ªëi thi·ªÉu c·∫ßn v√† t·ªëi ƒëa ƒë∆∞·ª£c s·ª≠ d·ª•ng cho pod c·ªßa ch√∫ng ta nh√©, K8S khuy√™n ch√∫ng ta n√™n lu√¥n c√≥ c√°i ƒë√≥, v√† b·ªüi v√¨ c√°c b·∫°n share cluster c·ªßa m√¨nh n√™n m√¨nh c√≥ ƒë·∫∑t ResourceQuota v√† n√≥ b·∫Øt bu·ªôc ta ph·∫£i c√≥ c√°i ƒë√≥, c√°c b·∫°n c·ª© t·∫°m b·ªè qua n√≥ sau n√†y ta s·∫Ω t√¨m hi·ªÉu nh√©

Ti·∫øp theo ta s·∫Ω `apply` ƒë·ªÉ deploy Pod n√†y nh√©:
```shell
kubectl apply -f pod.yml --kubeconfig=kubernetes-config
```
> ch√∫ √Ω n·∫øu c√°c b·∫°n kh√¥ng mu·ªën th√™m `--kubeconfig=kubernetes-config` cho m·ªçi command th√¨ c√°c b·∫°n c√≥ th·ªÉ th√™m n√≥ v√†o bi·∫øn m√¥i tr∆∞·ªùng nh√©. M√¨nh ƒë√£ n√≥i [·ªü b√†i tr∆∞·ªõc](https://viblo.asia/p/mo-dau-voi-pod-tren-kubernetes-2oKLn2ryLQO#_dat-config-mac-dinh-vao-bien-moi-truong-3) r·ªìi nh√©.

Sau khi apply xong th√¨ ta `get` xem Pod th·∫ø n√†o r·ªìi nh√©:
```sql
kubectl get po --kubeconfig=kubernetes-config

------

NAME         READY   STATUS    RESTARTS   AGE
helloworld   1/1     Running   0          25s
```
> ta c√≥ th·ªÉ vi·∫øt "po", "pod", "pods" ƒë·ªÅu ƒë∆∞·ª£c nh√©, m√¨nh th√≠ch c√°ch ng·∫Øn nh·∫•t

Pod n√†y nh·∫π n√™n pull v√† start kh√° nhanh, nh∆∞ c√°c b·∫°n th·∫•y ·ªü tr√™n th√¨ Pod c·ªßa ta ƒë√£ `Running`, ta th·ª≠ chui v√†o Pod v√† ƒë·∫£m b·∫£o l√† API trong ƒë√≥ ƒëang ch·∫°y ngon r·ªìi nh√©:
```shell
kubectl exec -it helloworld --kubeconfig=kubernetes-config -- sh

---- Sau ƒë√≥ ta c√†i curl
apk update && apk add curl

curl localhost:80
```
Th·∫•y in ra nh∆∞ sau l√† oke r·ªìi ƒë√≥ c√°c b·∫°n:

![](https://images.viblo.asia/7d058a5a-8d8e-4964-8e88-32f8cac6c878.png)

Gi·ªù ta l·∫°i chui ra ngo√†i (b·∫•m CTRL + D) v√† th·ª≠ `describe` pod c·ªßa ch√∫ng ta xem ch√∫t th√¥ng tin chi ti·∫øt h∆°n v·ªÅ Pod nh√©:

```sql
kubectl describe po helloworld --kubeconfig=kubernetes-config
```

Ta th·∫•y in ra nh∆∞ sau:

![Screenshot 2022-10-13 at 11.40.06 AM.png](https://images.viblo.asia/b9a83717-49f4-473d-9da6-0ea3604d357b.png)

Ta th·∫•y r·∫±ng Pod c·ªßa ta c√≥ IP (ClusterIP) l√† `10.244.0.159`

Ti·∫øp theo ta s·∫Ω ch·∫°y th√™m 1 pod nginx n·ªØa ƒë·ªÉ test API call v√†o pod Hello World nh√©. Ta t·∫°o file `nginx-pod.yml`
```go:yml
apiVersion: v1
kind: Pod
metadata:
  name: nginx
spec:
  containers:
  - name: nginx
    image: nginx:1.19
    ports:
    - containerPort: 80
    resources:
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"
```
Sau ƒë√≥ ta apply ƒë·ªÉ t·∫°o pod n√†y:
```shell
kubectl apply -f nginx-pod.yml --kubeconfig=kubernetes-config
```
Ti·∫øp theo ta chui v√†o Pod nginx m·ªõi t·∫°o n√†y v√† th·ª≠ g·ªçi sang b√™n Hello World xem nh√©:
```shell
kubectl exec -it --kubeconfig=kubernetes-config nginx -- sh
```
Sau ƒë√≥ n·∫øu ta th·ª≠ `curl` v√†o b√™n pod Helloworld d√πng t√™n pod th√¨ s·∫Ω g·∫∑p l·ªói:
```markdown
curl helloworld:80

---
curl: (6) Could not resolve host: helloworld
```
B·ªüi v√¨ t·ª´ b√™n nginx th√¨ n√≥ kh√¥ng bi·∫øt ƒë∆∞·ª£c c√°i host n√†o t√™n l√† `helloworld` c·∫£, m√† thay v√†o ƒë√≥ ta ph·∫£i d√πng ClusterIP c·ªßa pod `helloworld`
```css
curl 10.244.0.239:80
```
V√† ta s·∫Ω th·∫•y k·∫øt qu·∫£ nh∆∞ sau:

![Screenshot 2022-10-13 at 12.12.44 PM.png](https://images.viblo.asia/fdf33b20-008a-4929-af77-cf4a71df23ff.png)

> ch√∫ √Ω r·∫±ng c√°c b·∫°n ph·∫£i l·∫•y cluster IP c·ªßa Pod Helloworld t·ª´ command `describe` nh√©, ƒë·ª´ng l·∫•y y h·ªát nh∆∞ c·ªßa m√¨nh v√¨ c·ªßa c√°c b·∫°n n√≥ s·∫Ω kh√°c ƒë√≥ ;)

Nh∆∞ c√°c b·∫°n th·∫•y, t·ª´ b√™n Nginx ta ƒë√£ g·ªçi th√†nh c√¥ng sang HelloWorld d√πng ClusterIP. Th·∫ø nh∆∞ng n·∫øu b√¢y gi·ªù m√† ta `delete` pod HelloWorld ƒëi v√† ch·∫°y l·∫°i, th√¨ n√≥ l·∫°i c√≥ 1 clusterIP m·ªõi. V·∫≠y ch·∫≥ng l·∫Ω n·∫øu t·ª´ b√™n Nginx mu·ªën g·ªçi ƒë∆∞·ª£c Hello World th√¨ ta c·ª© ph·∫£i `describe` HelloWorld tr∆∞·ªõc ƒë·ªÉ l·∫•y ClusterIP c·ªßa n√≥ hay sao????

Oke v·∫≠y gi·ªù ph·∫£i d√πng Service ƒë√∫ng kh√¥ng, n√£y gi·ªù c·ª© nh√° h√†ng m√£i üòí ....

ƒê√∫ng r·ªìi ƒë√≥ c√°c b·∫°n, ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y ta s·∫Ω c√πng ƒë·ªãnh nghƒ©a Service cho app Hello world c·ªßa ch√∫ng ta nh√©

## V√≠ d·ª•
Nh∆∞ng tr∆∞·ªõc khi t·∫°o Service c√°c b·∫°n update l·∫°i file `pod.yml` c·ªßa helloworld ƒë·ªÉ th√™m cho n√≥ `labels` nh∆∞ sau nh√©:
```swift:yml
apiVersion: v1
kind: Pod
metadata:
  name: helloworld
  labels:
    app.kubernetes.io/name: helloworld #  ----->>> ·ªû ƒë√¢y
spec:
  containers:
  - name: helloworld
    image: tutum/hello-world
    ports:
    - containerPort: 80
    resources:
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"
```
Sau ƒë√≥ ta `delete` pod HelloWorld hi·ªán t·∫°i ƒëi:
```shell
kubectl delete po helloworld --kubeconfig=kubernetes-config
```
V√† `apply` ƒë·ªÉ t·∫°o l·∫°i pod m·ªõi:
```shell
kubectl apply -f pod.yml --kubeconfig=kubernetes-config
```
V·∫≠y l√† gi·ªù pod c·ªßa ch√∫ng ta ƒë√£ c√≥ `labels`, c√°c b·∫°n c√≥ th·ªÉ `describe` n√≥ s·∫Ω th·∫•y nh√©.

Ti·∫øp theo ta b·∫Øt ƒë·∫ßu t·∫°o file service, c√°c b·∫°n ƒë·∫∑t t√™n l√† `helloworld-svc.yml` nh√©:
```python:yml
apiVersion: v1
kind: Service
metadata:
  name: helloworld
spec:
  type: ClusterIP
  ports:
    - name: http
      protocol: TCP
      port: 3000
      targetPort: 80
  selector:
    app.kubernetes.io/name: helloworld
```
·ªû tr√™n c√°c b·∫°n th·∫•y ta c√≥ file manifest c·∫•u h√¨nh Service cho HelloWorld, c√≥ 1 s·ªë ƒëi·ªÉm c·∫ßn l∆∞u √Ω:
- `type=ClusterIP`: m·ªü cho service n√†y ch·ªâ ƒë∆∞·ª£c truy c·∫≠p trong cluster (type c√≥ 1 v√†i gi√° tr·ªã kh√°c ta s·∫Ω n√≥i ·ªü ph·∫ßn d∆∞·ªõi nh√©)
- protocol=TCP: ch·ªâ cho ph√©p traffic l√† TCP (c√°c d·∫°ng request http th√¥ng th∆∞·ªùng m√† ta v·∫´n hay g·ªçi),  ho·∫∑c c≈©ng c√≥ th·ªÉ c√≥ UDP hay ICMP
- port=3000: ƒë·ªãnh nghƒ©a cho Service n√†y 1 c√°i port, th√¨ l√°t n·ªØa ·ªü n∆°i kh√°c g·ªçi v√†o service th√¨ s·∫Ω l√† `Service_name:3000`
- targetPort=80: ƒë√¢y l√† c√°i `containerPort` c·ªßa Helloworld m√† service n√†y s·∫Ω `target` v√†o
- selector: √°p d·ª•ng service n√†y cho 1 t·∫≠p h·ª£p pod ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh c√≥ c√°c `labels` nh∆∞ ta ƒë·ªãnh nghƒ©a

Nom √¢u k√¢y ph·∫øt r·ªìi ƒë√≥, ta `apply` service n√†y nh√©:
```shell
kubectl apply -f helloworld-svc.yml --kubeconfig=kubernetes-config
```
Ta c√πng nhau `get` t·∫•t c·∫£ c√°c service trong namespace hi·ªán t·∫°i nh√©:
```sql
kubectl get services --kubeconfig=kubernetes-config

----
Th·∫•y in ra nh∆∞ sau l√† ƒë∆∞·ª£c:
NAME         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE
helloworld   ClusterIP   10.245.243.233   <none>        3000/TCP   22s
```
Nh∆∞ ·ªü output c√°c b·∫°n th·∫•y service c·ªßa ch√∫ng ta c√≥ 1 cluster IP, t·ª©c l√† ngo√†i ƒë∆∞·ª£c g·ªçi b·∫±ng t√™n service th√¨ ta c≈©ng c√≥ th·ªÉ d√πng clusterIP, nh∆∞ng h·∫ßu nh∆∞ ta ƒë·ªÅu d√πng name v√¨ d·ªÖ d√πng h∆°n nhi·ªÅu.

Service c·ªßa ta kh√¥ng c√≥ Extenal-IP -> kh√¥ng ƒë∆∞·ª£c truy c·∫≠p t·ª´ b√™n ngo√†i Cluster. V√† cu·ªëi c√πng l√† port=3000 c·ªßa Service.

Gi·ªù ta "chui" l·∫°i Pod Nginx v√† th·ª±c hi·ªán g·ªçi API l·∫°i v√†o b√™n HelloWorld b·∫±ng t√™n service nh√©:
```shell
kubectl exec -it --kubeconfig=kubernetes-config nginx -- sh
```
Ti·∫øp theo ta g·ªçi v√†o Pod HelloWorld th√¥ng qua Service c·ªßa n√≥:
```perl
curl helloworld:3000
```
Ta s·∫Ω th·∫•y nh∆∞ sau:

![Screenshot 2022-10-14 at 10.53.25 AM.png](https://images.viblo.asia/602b5a96-d6fc-404e-bd48-e77286d73aad.png)

Yayyyyyyyyy v·∫≠y l√† ta ƒë√£ th√†nh c√¥ng t·∫°o 1 Service cho Pod HelloWorld r·ªìi............ (th√†nh c√¥ng l·ªõn lao gh√™ üôÉ )

T·ª´ gi·ªù ·ªü b·∫•t k√¨ ƒë√¢u trong Cluster ta g·ªçi theo ƒë√∫ng format nh∆∞ tr√™n `<t√™n_service>:<port_c·ªßa_svc>` l√† ƒë∆∞·ª£c, d·ªÖ nh√¨n h∆°n r·∫•t nhi·ªÅu, Pod c·ªßa ta tha h·ªì restart, scale tho·∫£i m√°i, ta c·ª© d√πng t√™n service th√¨ v·∫´n g·ªçi ƒë∆∞·ª£c b√¨nh th∆∞·ªùng. V√† ƒë√¢y c≈©ng l√† c√°ch ta th∆∞·ªùng l√†m th·∫≠t ·ªü production - lu√¥n c√≥ service "ƒë·ª©ng tr∆∞·ªõc" pod c·ªßa ch√∫ng ta, giao ti·∫øp v·ªõi nh·ªØng n∆°i kh√°c ƒë·ªÅu qua Service.

# V·ªçc v·∫°ch
B√™n tr√™n m·ªõi ch·ªâ l√† c·∫•u h√¨nh c∆° b·∫£n (nh∆∞ng ph·ªï bi·∫øn) c·ªßa 1 Service, ngo√†i ra service c√≤n cho ta r·∫•t nhi·ªÅu th·ª© kh√°c, ta c√πng xem nh√© ;)
### T·∫°o nhi·ªÅu port cho Service
·ªû tr√™n th√¨ Service c·ªßa ch√∫ng ta ch·ªâ c√≥ 1 port l√† 3000, ta c√≥ th·ªÉ tho·∫£i m√°i th√™m v√†o nhi·ªÅu port cho service c≈©ng ƒë∆∞·ª£c nh√©:
```markdown:yml
apiVersion: v1
kind: Service
metadata:
  name: helloworld
spec:
  type: ClusterIP
  ports:
    - name: http
      protocol: TCP
      port: 3000
      targetPort: 80
      #==========
    - name: http2
      protocol: TCP
      port: 3001
      targetPort: 80

  selector:
    app.kubernetes.io/name: helloworld
```
·ªû tr√™n c√°c b·∫°n th·∫•y m√¨nh th√™m v√†o 1 port n·ªØa v·ªõi t√™n l√† `http2`, port=3001 v√† v·∫´n target v√†o port 80 c·ªßa Pod. Gi·ªù ta ch·ªâ c·∫ßn `apply` l·∫°i service n√†y 1 l·∫ßn n·ªØa, sau ƒë√≥ "chui" l·∫°i v√†o Pod nginx th√¨ ta c√≥ th·ªÉ g·ªçi ƒë∆∞·ª£c sang helloworld b·∫±ng c·ªïng 3001:
```perl
curl helloworld:3001
```
> T∆∞∆°ng t·ª± th√¨ c√°c b·∫°n c≈©ng c√≥ th·ªÉ t·∫°o nhi·ªÅu port cho Service ƒë·ªÉ target ƒë∆∞·ª£c v√†o nhi·ªÅu port c·ªßa container trong Pod Hello World nh√© (`targetPod`)
## C√°ch hay h∆°n cho targetPort
Nh∆∞ c√°c b·∫°n th·∫•y th√¨ hi·ªán t·∫°i, ng∆∞·ªùi vi·∫øt c·∫•u h√¨nh manifest cho Service c·∫ßn bi·∫øt ƒë∆∞·ª£c l√† "√† container HelloWorld c√≥ `containerPort=80`", v√† t·ª´ ƒë√≥ cho Service target v√†o port 80.

V√† c·ª© m·ªói khi `containerPort` thay ƒë·ªïi th√¨ `targetPort` b√™n Service c≈©ng ph·∫£i thay ƒë·ªïi theo.

ƒê·ªÉ c·∫£i thi·ªán ƒëi·ªÅu n√†y th√¨ ta s·∫Ω ƒë·ªãnh nghƒ©a cho c√°i `containerPort` b√™n Pod Helloworld, sau ƒë√≥ b√™n Service ch·ªâ ƒë∆°n gi·∫£n l√† d√πng c√°i t√™n ƒë√≥ l√† ƒë∆∞·ª£c.

Ta update l·∫°i file `pod.yml` nh∆∞ sau nh√©:
```swift:yml
apiVersion: v1
kind: Pod
metadata:
  name: helloworld
  labels:
    app.kubernetes.io/name: helloworld
spec:
  containers:
  - name: helloworld
    image: tutum/hello-world
    ports:
    - containerPort: 80
      name: myport # -----> ·ªü ƒë√¢y
    resources:
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"
```
Nh∆∞ c√°c b·∫°n th·∫•y ·ªü tr√™n, th√¨ ngo√†i `containerPort` ta c≈©ng cho n√≥ 1 c√°i t√™n "name=myport"

Sau ƒë√≥ ta xo√° Pod c≈© ƒëi v√† deploy Pod m·ªõi nh√©:
```perl
kubectl delete po helloworld --kubeconfig=kubernetes-config
kubectl apply -f pod.yml --kubeconfig=kubernetes-config
```
> l√Ω do ta ph·∫£i xo√° pod c≈© ƒëi l√† b·ªüi v√¨ K8S kh√¥ng ch·ªâ cho ph√©p ta update 1 s·ªë thu·ªôc t√≠nh nh∆∞ "image" th√¥i

Oke ti·∫øp theo ta update l·∫°i file service nh√©:
```swift:yml
apiVersion: v1
kind: Service
metadata:
  name: helloworld
spec:
  type: ClusterIP
  ports:
    - name: http
      protocol: TCP
      port: 3000
      targetPort: myport # ---->  ·ªü ƒë√¢y
  selector:
    app.kubernetes.io/name: helloworld
```
v√† `apply` l·∫°i service:
```shell
kubectl apply -f helloworld-svc.yml --kubeconfig=kubernetes-config
```
V√† gi·ªù c√°c b·∫°n l·∫°i chui v√†o `nginx` v√† th·ª≠ `curl` ta th·∫•y k·∫øt qu·∫£ t∆∞∆°ng t·ª± ;) (ph·∫ßn n√†y c√°c b·∫°n t·ª± l√†m nh√©)
## C√°c Type kh√°c c·ªßa Service
Nh∆∞ trong file manifest file c·ªßa Service ta c√≥ tr∆∞·ªùng "type" trong "spec":
```python:yml
apiVersion: v1
kind: Service
metadata:
  name: helloworld
spec:
  type: ClusterIP
```
Type n√†y ƒë·ªÉ ƒë·ªãnh nghƒ©a ki·ªÉu c·ªßa Service n√†y s·∫Ω l√† g√¨, c√°c type kh√°c nhau s·∫Ω cho ta k·∫øt qu·∫£ kh√°c nhau. M·∫∑c ƒë·ªãnh kh√¥ng n√≥i g√¨ th√¨ `type=ClusterIP`. 

Ta c√πng xem c√°c type kh√°c c·ªßa service c√≥ g√¨ n·ªØa nh√© üöÄüöÄ
### NodePort
Khi ta ƒë·ªÉ `type=NodePort` th√¨ service c·ªßa ch√∫ng ta s·∫Ω ƒë∆∞·ª£c "expose" m·ªü ra cho truy c·∫≠p tr√™n m·ªói node c·ªßa Cluster c√πng v·ªõi 1 c·ªïng c·ªë ƒë·ªãnh (gi√° tr·ªã ƒë∆∞·ª£c K8S t·ª± g√°n ta ch·ªâ vi·ªác s·ª≠ d·ª•ng).

c√°c b·∫°n m·ªü l·∫°i file manifest c·ªßa Service v√† ƒë·ªïi type th√†nh NodePort nh√©:
```swift:yml
apiVersion: v1
kind: Service
metadata:
  name: helloworld
spec:
  type: NodePort # ---- > ·ªü ƒë√¢y
  ports:
    - name: http
      protocol: TCP
      port: 3000
      targetPort: myport
  selector:
    app.kubernetes.io/name: helloworld
```
Sau ƒë√≥ ta `apply` l·∫°i service:
```shell
kubectl apply -f helloworld-svc.yml --kubeconfig=kubernetes-config
```
Sau ƒë√≥ ta th·ª≠ `get` l·∫°i service ƒëang c√≥:
```sql
kubectl get svc --kubeconfig=kubernetes-config
```
> c√°c b·∫°n c√≥ th·ªÉ vi·∫øt l√† "services", "service", hay "svc" ƒë·ªÅu ƒë∆∞·ª£c nh√©, m√¨nh lu√¥n d√πng ng·∫Øn :)

Sau ƒë√≥ ta th·∫•y in ra nh∆∞ sau:
```sql
NAME         TYPE       CLUSTER-IP     EXTERNAL-IP   PORT(S)          AGE
helloworld   NodePort   10.245.30.54   <none>        3000:32203/TCP   72m
```
Ch√∫ √Ω r·∫±ng ·ªü c·ªôt PORTS th√¨ c√≥ 1 ch√∫t thay ƒë·ªïi, nh∆∞ ta th·∫•y n√≥ l√† `3000:32203/TCP`, t·ª©c l√† ·ªü ƒë√¢y K8S ƒë√£ expose service c·ªßa ch√∫ng ta tr√™n t·∫•t c·∫£ c√°c node t·∫°i ƒë·ªãa ch·ªâ `<NODE_IP>:32203`, v√† c√≥ th·ªÉ truy c·∫≠p ƒë∆∞·ª£c t·ª´ b√™n ngo√†i cluster (Internet).

Gi·ªù ta test th·ª≠ truy c·∫≠p t·ª´ b√™n ngo√†i cluster xem nh√© ;)

......

M√† ·ªßa, th·∫ø r·ªìi truy c·∫≠p nh∆∞ n√†o, c√°i ip c·ªßa node kia l·∫•y ƒë√¢u ra??????üôÑü§î

Th√¨ ƒë·ªÉ l·∫•y ip c·ªßa c√°c nodes tr√™n cluster c√°c b·∫°n ch·∫°y command sau:
```shell
kubectl get nodes -o wide --kubeconfig=kubernetes-config
```
Xong t·ª± nhi√™n ta th·∫•y b√°o:
```python
Error from server (Forbidden): nodes is forbidden: User "learnk8s-335556" cannot list resource "nodes" in API group "" at the cluster scope
```
√ù b·∫£o l√† user c·ªßa c√°c b·∫°n kh√¥ng c√≥ quy·ªÅn ƒë∆∞·ª£c xem th√¥ng tin v·ªÅ nodes tr√™n cluster, c√°i n√†y m√¨nh ƒë√£ limit user c·ªßa c√°c b·∫°n ch·ªâ thao t√°c ƒë∆∞·ª£c tr√™n namespace l√∫c m√† t·∫°o file `kubernetes-config` v√† g·ª≠i v√†o h√≤m mail c·ªßa c√°c b·∫°n r·ªìi.

T√≠nh ƒë√πa c√°c b·∫°n t√≠ v·∫≠y ü§£ü§£ü§£ü§£ sau n√†y c√°c b·∫°n c√≥ cluster ri√™ng l√†m b·ªë ƒë·ªùi th√¨ th√≠ch xem g√¨ th√¨ xem nh√© :D

ƒê√¢y m√¨nh ƒë√£ `get nodes` cho c√°c b·∫°n b·∫±ng user admin c·ªßa m√¨nh v√† ta ƒë∆∞·ª£c nh∆∞ sau:

![Screenshot 2022-10-14 at 12.10.04 PM.png](https://images.viblo.asia/643c58a6-b56d-468a-b309-a18f28221f31.png)

Nh∆∞ c√°c b·∫°n th·∫•y ·ªü tr√™n ta c√≥ EXTERNAL-IP cho t·ª´ng node, n√≥ l√† static v√† kh√¥ng ƒë·ªïi. Gi·ªù c√°c b·∫°n m·ªü tr√¨nh duy·ªát, ch·ªçn IP c·ªßa 1 node b·∫•t k√¨ v√† truy c·∫≠p v√†o ƒë·ªãa ch·ªâ `NODE_IP:32203` (port 32203 l√† dynamic v√† ƒë∆∞·ª£c gen ng·∫´u nhi√™n khi th·ª±c h√†nh nh·ªõ thay l·∫°i cho ƒë√∫ng trong tr∆∞·ªùng h·ª£p c·ªßa c√°c b·∫°n nh√©) v√† ta s·∫Ω th·∫•y k·∫øt qu·∫£ nh∆∞ sau:

![Screenshot 2022-10-14 at 12.16.06 PM.png](https://images.viblo.asia/5628330d-c5ce-4372-9e91-c835f043db77.png)

Yeahhhh, v·∫≠y l√† ta ƒë√£ "expose" - m·ªü cho app c·ªßa ch√∫ng ta truy c·∫≠p t·ª´ b√™n ngo√†i cluster ƒë∆∞·ª£c r·ªìi ƒë√≥, g·ª≠i link cho ƒë·ª©a b·∫°n v√† khoe th√¥i n√†oüí™üí™üí™üí™üí™
### LoadBalancer
Khi ta ƒë·ªÉ type l√† Load Balancer th√¨ K8S s·∫Ω expose Service c·ªßa ch√∫ng ta d√πng Load Balancer cung c·∫•p b·ªüi cloud provider - n∆°i m√† ta ƒëang d√πng cloud ƒë·ªÉ ch·∫°y K8S Cluster (AWS, Google, Azure, Digital ocean,....), v√† ta c≈©ng ƒë∆∞·ª£c 1 public IP , IP ƒë√≥ l√† IP c·ªßa load balancer.

V√† ch√∫ √Ω l√† khi ta set type=LoadBalancer th√¨ K8S c≈©ng s·∫Ω c·∫•p cho Service c·ªßa ch√∫ng ta ClusterIP v√† expose ra NodePort.

ƒê·ªÉ demo r√µ nh·∫•t ph·∫ßn n√†y ta s·∫Ω c√πng ƒë·ªïi l·∫°i type c·ªßa Service v·ªÅ ClusterIP tr∆∞·ªõc ƒë√£ nh√©:
```swift:yml
apiVersion: v1
kind: Service
metadata:
  name: helloworld
spec:
  type: ClusterIP # ---- > ·ªü ƒë√¢y
  ports:
    - name: http
      protocol: TCP
      port: 3000
      targetPort: myport
  selector:
    app.kubernetes.io/name: helloworld
```
Sau ƒë√≥ ta `apply`:
```shell
kubectl apply -f helloworld-svc.yml --kubeconfig=kubernetes-config
```
R·ªìi `get` ƒë·ªÉ ki·ªÉm tra l·∫°i thay ƒë·ªïi ta v·ª´a c·∫≠p nh√¢t:
```sql
kubectl get svc --kubeconfig=kubernetes-config

----
Ta s·∫Ω th·∫•y nh∆∞ sau:

NAME         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE
helloworld   ClusterIP   10.245.243.233   <none>        3000/TCP   22s
```
ƒê·∫£m b·∫£o l√† type=ClusterIP v√† kh√¥ng c√≤n NodePort nh√© c√°c b·∫°n.

√Çu c√¢y ti·∫øp theo ta s·∫Ω ƒë·ªïi ti·∫øp type c·ªßa Service th√†nh LoadBalancer:
```swift:yml
apiVersion: v1
kind: Service
metadata:
  name: helloworld
spec:
  type: LoadBalancer # ---- > ·ªü ƒë√¢y
  ports:
    - name: http
      protocol: TCP
      port: 3000
      targetPort: myport
  selector:
    app.kubernetes.io/name: helloworld
```
V√† ta l·∫°i ti·∫øp t·ª•c `apply`:
```shell
kubectl apply -f helloworld-svc.yml --kubeconfig=kubernetes-config
```
Sau ƒë√≥ ta th·ª≠ `get` l·∫°i c√°c service trong namespace:
```sql
kubectl get svc --kubeconfig=kubernetes-config
```
Ta s·∫Ω th·∫•y in ra nh∆∞ sau:
```sql
NAME         TYPE           CLUSTER-IP     EXTERNAL-IP   PORT(S)          AGE
helloworld   LoadBalancer   10.245.30.54   <pending>     3000:30623/TCP   102m
```
Nh∆∞ c√°c b·∫°n th·∫•y, Service c·ªßa ta ƒë√£ c√≥ ClusterIP m·ªõi, EXTERNAL-IP th√¨ l√† `PENDING` t·ª©c l√† Load balancer ƒëang ƒë∆∞·ª£c t·∫°o, n·∫øu sau n√†y c√°c b·∫°n c√≥ cluster ri√™ng th√¨ c√≥ th·ªÉ l√™n trang qu·∫£n tr·ªã cluster s·∫Ω th·∫•y th√¥ng b√°o ƒëang t·∫°o Load balancer (LB). V√† ta th·∫•y Service c≈©ng ƒë∆∞·ª£c g√°n cho 1 c√°i `NodePort=30623`

Ta ch·ªù t·∫ßm v√†i ph√∫t ƒë·ªÉ b√™n Cloud t·∫°o xong LB, sau ƒë√≥ th·ª≠ `get` l·∫°i l·∫ßn n·ªØa s·∫Ω th·∫•y c√≥ EXTERNAL-IP (IP c·ªßa LB):
```sql
kubectl get svc --kubeconfig=kubernetes-config

------

NAME         TYPE           CLUSTER-IP     EXTERNAL-IP      PORT(S)          AGE
helloworld   LoadBalancer   10.245.30.54   139.59.219.145   3000:30623/TCP   110m
```
V√† gi·ªù ta c√≥ th·ªÉ truy c·∫≠p app c·ªßa ch√∫ng ta tr·ª±c ti·∫øp th√¥ng qua LB r·ªìi, c√°c b·∫°n m·ªü tr√¨nh duy·ªát v√† truy c·∫≠p ·ªü ƒë·ªãa ch·ªâ `<IP_c·ªßa_LB>:3000` ta s·∫Ω th·∫•y app ch·∫°y b√¨nh th∆∞·ªùng:

![Screenshot 2022-10-14 at 12.16.06 PM.png](https://images.viblo.asia/adb8b65a-1980-45ec-9ca8-1193ea054f67.png)

LB s·∫Ω t·ª± ƒë·ªông ƒëi·ªÅu ph·ªëi traffic v√†o t·ª´ng node c·ªßa ch√∫ng ta, ƒë·∫£m b·∫£o c√¢n b·∫±ng t·∫£i gi·ªØa c√°c node

**K·∫øt lu·∫≠n**: qua ƒë√¢y c√°c b·∫°n th·∫•y r·∫±ng, vi·ªác d√πng LB kh√° l√† "friendly" h∆°n, ta ch·ªâ vi·ªác d√πng 1 IP v√† port th√¨ c≈©ng c·ªë ƒë·ªãnh l√† port c·ªßa Service, l√† c√≥ th·ªÉ g·ªçi ƒë∆∞·ª£c v√†o app r·ªìi. N·∫øu d√πng nodeport th√¨ m·ªói l·∫ßn g·ªçi ta l·∫°i ph·∫£i ch·ªâ ƒë·ªãnh ch√≠nh x√°c Node IP, m√† c√°i ƒë√≥ khi cluster scale l√™n nhi·ªÅu node th√¨ ta l·∫°i ph·∫£i l∆∞u th√™m nhi·ªÅu Node IP hay sao? Do v·∫≠y theo m√¨nh th·∫•y th√¨ c√°ch ph·ªï bi·∫øn h∆°n l√† d√πng LoadBalancer thay v√¨ NodePort

> Nh∆∞ng d√πng LB c≈©ng s·∫Ω b·ªã t√≠nh 1 ch√∫t ph√≠ ƒë√≥ c√°c b·∫°n, nh∆∞ng kh√¥ng ƒë√°ng k·ªÉ ƒë√¢u ;)

> c≈©ng ƒë√¥i khi c√≥ 1 s·ªë tr∆∞·ªùng h·ª£p cho ƒë∆°n gi·∫£n th√¨ m√¨nh v·∫´n d√πng NodePort nh∆∞ng r·∫•t √≠t
### ExternalName
N·∫øu ta set `type=ExternalName` th√¨ theo m√¨nh xin ƒë∆∞·ª£c l·∫•y lu√¥n c√¢u t·ª´ tr√™n trang ch·ªß K8S: 
>Maps the Service to the contents of the externalName field (e.g. foo.bar.example.com), by returning a CNAME record with its value. No proxying of any kind is set up.

Th·ª±c t·∫ø l√† m√¨nh ch∆∞a bao gi·ªù d√πng type n√†y v√† c≈©ng th·∫•y r·∫•t √≠t ng∆∞·ªùi, √≠t n∆°i d√πng n√≥
## Endpoint
Nh∆∞ ·ªü tr√™n c√°c b·∫°n th·∫•y trong file manifest c·ªßa Service ta ph·∫£i c√≥ `selector` th√¨ service n√≥ m·ªõi bi·∫øt l√† n√≥ c·∫ßn "quan t√¢m" t·ªõi Pod n√†o.

N·∫øu ta kh√¥ng c√≥ selector th√¨ ta s·∫Ω c·∫ßn d√πng t·ªõi Endpoint, khi ƒë√≥ ta c√≥ th·ªÉ d√πng Service cho 1 backend n√†o ƒë√≥ n·∫±m ngo√†i cluster c≈©ng ƒë∆∞·ª£c. Ph·∫ßn n√†y m√¨nh c≈©ng r·∫•t r·∫•t √≠t khi ƒë·ª•ng t·ªõi ,v√¨ h·∫ßu nh∆∞ th·ª±c t·∫ø th√¨ ta ƒë·ªÅu "select" v√†o Pod trong cluster c·∫£, n·∫øu backend/app ·ªü ngo√†i th√¨ ch√∫ng n√≥ c≈©ng c√≥ IP/domain r·ªìi kh√¥ng c·∫ßn ƒë·ª•ng t·ªõi Endpoint l√†m chi cho c√°ch r√°ch
# C√¢u h·ªèi li√™n quan
## Type LoadBalancer nom ·ªïn ph·∫øt, th√¥i m·ªçi service c·ª© phang lu√¥n c√°i ƒë√≥?
ƒê√∫ng l√† nh∆∞ c√°c b·∫°n th·∫•y, ƒë·ªÉ ServiceType=LoadBalancer th√¨ app c·ªßa ch√∫ng ta ƒë∆∞·ª£c access ƒë∆∞·ª£c t·ª´ c·∫£ trong l·∫´n ngo√†i cluster, ta kh√¥ng c·∫ßn quan t√¢m t·ªõi s·ªë l∆∞·ª£ng pod v√¨ LB s·∫Ω t·ª± ƒëi·ªÅu ph·ªëi traffic v√†o ƒë√≥.

Nh∆∞ng th·ª±c t·∫ø m√¨nh th·∫•y n·∫øu kh√¥ng c·∫ßn thi·∫øt ph·∫£i d√πng t·ªõi type l√† LB th√¨ ta kh√¥ng c·∫ßn thi·∫øt ph·∫£i d√πng n√≥, t·ªën th√™m ph√≠ n·ªØa v√¨ LB l√† c·ªßa cloud provider, v√† v·ªõi c·∫£ l√†m nh∆∞ th·∫ø th√¨ service c·ªßa ch√∫ng ta s·∫Ω ƒë∆∞·ª£c "expose" ra internet ai c≈©ng v√†o ƒë∆∞·ª£c.

*L·ªùi khuy√™n c·ªßa m√¨nh (c√° nh√¢n m√¨nh th·∫•y th√¥i nh√©)*: lu√¥n gi·ªØ app b·∫£o m·∫≠t, ch·ªâ c·∫ßn expose c√°i n√†o th·∫≠t s·ª± c·∫ßn thi·∫øt. V√≠ d·ª• ta c√≥ 1 frontend, 10 backend, user ch·ªâ s·ª≠ d·ª•ng th√¥ng qua UI c·ªßa frontend, th√¨ kh√¥ng c√≥ l√Ω do g√¨ ta l·∫°i ƒëi expose ra 10 backend kia cho Internet (th√¥ng qua NodePort hay LB), ta ch·ªâ c·∫ßn expose ra frontend, c√≤n 10 backend kia ta ƒë·ªÉ ClusterIP h·∫øt, nh∆∞ th·∫ø s·∫Ω b·∫£o m·∫≠t h∆°n, c√πng v·ªõi ƒë√≥ th√¨ theo l√Ω thuy·∫øt request g·ªçi t·ª´ frontend ƒë·∫øn backend c≈©ng nhanh h∆°n, v√¨ n√≥ g·ªçi tr·ª±c ti·∫øp b√™n trong cluster, n·∫øu g·ªçi qua LB th√¨ n√≥ ph·∫£i ƒëi qua 1 l·ªõp LB c·ªßa cloud provider.
## Setup HTTPS nh∆∞ th·∫ø n√†o nh·ªâ??
C√°i n√†y ta s·∫Ω xem ·ªü b√†i v·ªÅ Ingress nh√©
##  G·ªçi sang service ·ªü namespace kh√°c nh∆∞ th·∫ø n√†o nh·ªâ?
N·∫øu c√°c b·∫°n ƒë·ªÉ √Ω, hi·ªán t·∫°i ta ƒëang l√†m vi·ªác tr√™n 1 namespace, pod, service m√¨nh t·∫°o ra trong b√†i n√†y ƒë·ªÉu n·∫±m tr√™n c√πng 1 namespace, khi ta "chui" v√†o trong nginx v√† g·ªçi v√†o service c·ªßa Helloworld th√¨ ƒë∆°n gi·∫£n l√† ta nh·∫≠p lu√¥n t√™n service:
```perl
curl helloworld:3000
```
·ªû tr√™n K8S s·∫Ω t√¨m t·ªõi service trong namespace hi·ªán t·∫°i.

Trong tr∆∞·ªùng h·ª£p ta mu·ªën g·ªçi t·ªõi 1 service ·ªü namespace kh√°c, v√≠ d·ª• c≈©ng t√™n l√† `helloworld` th√¨ ta l√†m nh∆∞ sau:
```python
curl helloworld.namespace-abc.svc.cluster.local
```
`namespace-abc` l√† t√™n namespace ta mu·ªën g·ªçi t·ªõi
## T·∫°o service ·ªü trong 1 namespace th·∫ø n√†o nh·ªâ?
M·ªçi resource khi ta t·∫°o, ·ªü file manifest, n·∫øu ta kh√¥ng n√≥i namespace n√†o th√¨ K8S s·∫Ω t·∫°o ·ªü namespace ·ªü "context" hi·ªán t·∫°i, context c·ªßa c√°c b·∫°n m√¨nh ƒë√£ t·∫°o s·∫µn cho c√°c b·∫°n r·ªìi, c√°c b·∫°n c√≥ namespace c·ªßa ri√™ng c√°c b·∫°n, kh√¥ng c·∫ßn n√≥i g√¨ t·ª± K8S s·∫Ω t·∫°o resource tr√™n namespace ƒë√≥.

C√≤n sau n√†y khi c√°c b·∫°n c√≥ cluster ri√™ng th√¨ c√°c b·∫°n tho·∫£i m√°i t·∫°o resource tr√™n c√°c namespace kh√°c tu·ª≥ √Ω:
```markdown:yml
apiVersion: v1
kind: Service
metadata:
  name: helloworld
  namespace: abc # -----> ·ªü ƒë√¢y
```
# T√≠ qu√™n
N·∫øu Pod c·ªßa c√°c b·∫°n c·∫ßn Service, v√† **ƒë∆∞·ª£c t·∫°o sau khi t·∫°o Service** th√¨ m·∫∑c ƒë·ªãnh khi container c·ªßa Pod kh·ªüi ƒë·ªông l√™n th√¨ K8S s·∫Ω inject (b∆°m ti√™m - hay c·ª• th·ªÉ l√† kh·ªüi t·∫°o) 1 s·ªë bi·∫øn m√¥i tr∆∞·ªùng ta c√≥ th·ªÉ s·ª≠ d·ª•ng:
```python
HELLOWORLD_SERVICE_HOST=10.0.0.11
HELLOWORLD_SERVICE_PORT=3000
HELLOWORLD_PORT=tcp://10.0.0.11:3000
HELLOWORLD_PORT_3000_TCP=tcp://10.0.0.11:3000
HELLOWORLD_PORT_3000_TCP_PROTO=tcp
HELLOWORLD_PORT_3000_TCP_PORT=3000
HELLOWORLD_PORT_3000_TCP_ADDR=10.0.0.11
```
> 10.0.0.11 b√™n tr√™n l√† ClusterIP c·ªßa Service

Ph·∫ßn n√†y c√°c b·∫°n t·ª± ki·ªÉm tra nh√© (`exec` v√†o container v√† th·ª≠ `echo` l√† th·∫•y ;)

# K·∫øt b√†i
Ph√πuuuu.... b√†i n√†o c≈©ng d√†i th·∫ø nh·ªâ??? üòÇüòÇ m√¨nh c·ªë vi·∫øt ng·∫Øn g·ªçn r·ªìi m√† n√≥ c·ª© d√¢y ra. Hi v·ªçng l√† c√°c b·∫°n c√≥ th·ªÉ th·∫•m ƒë∆∞·ª£c ph·∫ßn n√†o.

Qua b√†i n√†y mong l√† c√°c b·∫°n ƒë√£ hi·ªÉu v·ªÅ Service tr√™n K8S, c√°ch s·ª≠ d·ª•ng v√† khi n√†o n√™n d√πng Type n√†o. D√πng Service l√† c√°c ta th∆∞·ªùng d√πng ·ªü production ch·ª© m√¨nh ch∆∞a th·∫•y ai d√πng ClusterIP ƒë·ªÉ truy c·∫≠p tr·ª±c ti·∫øp v√†o Pod bao gi·ªù (c√≥ chƒÉng n√≥ l√† khi debug) :).

H·∫πn g·∫∑p l·∫°i c√°c b·∫°n v√†o nh·ªØng b√†i sau. Ch√∫c ch√∫ng ta cu·ªëi tu·∫ßn vui v·∫ª.

M·∫°nh m·∫Ω, quy·∫øt th·∫Øng üáªüá≥üáªüá≥üáªüá≥üáªüá≥üáªüá≥