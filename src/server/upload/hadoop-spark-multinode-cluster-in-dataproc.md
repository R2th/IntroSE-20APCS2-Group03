Google offers a managed Spark and Hadoop service. They call it Google Cloud Data Proc. It is almost same as Amazon's EMR. You can use Data Proc service to create a Hadoop and Spark cluster in less than two minutes. 

+ Setup your Google cloud account and a default project.
+ Start your Google Cloud Console.
+ Go to products and services menu.
+ Scroll down to Data Proc and select clusters.
+ Hit the create cluster button.
+ Give a name to your Cluster and choose your region.
+ Choose a machine type for your master node.
+ Select a cluster type.
+ Select the disk size for the master node.
+ Choose the data node configuration and the number of workers.
+ Select the disk size for each worker.
+ Select an initialization action (Optional)
+ Hit the create button.

![](https://lh3.googleusercontent.com/BY9VQVlrxsRaC1HmQf0THEGEUV7cH4Pls5jbUatrRi79f35CYbThwgtzLmuVWp0AjeOiwy5vbhXrhSysGWS03L6GHLHdQiAw5__h8JVMaQikoEs6E-IJv-9X8O1_6SoPo5u7Qfxh6E2DdFZSIpaq6xARLmqglodZCS20s8nRefI5wD85sON8P9KWLoDplndG5YB87fpgjMiKTmoW0Ly7BkFm7nBBIpw9O1taaybI08BrZ7OerFwpleXY0X77DHi51VP2I3t69Vr3IIPJDbzQLL59AgeMtMqaLq-VNkE9yJ6f5-Bzpf36kjdP0oBa-C6aYUKhMB4TI3I_wJ4cCazrKybc2Cuw3aBw5RN3NU7WTaYlx_n2QMzx8iPD51ahX7bNNyquIB27c89EwYxaIN_BFNxvKDChgnRkek3-zCecAmdhXR_Co6hRb2V9rFVck4Jww0uxP2QDWa2bfsnjY54A1KtQrcSrKNmpOwp7CZ360Ua-hRWY0G_5q1DYHouZi_e4X3e_qYDICUHTSpPEljHE59S6j_jrxG_JxMBYJ7Eyp3OztQaswDT-Yg0SI-AXfWjGvPGTyf6lENl42Sr2dztalgUqA9zVky9UoWQQiFgEBE-Bj41uO5IKH4L0c9kCax8tX5GY6EUkL1ZOG8vvC2_dGoHilr3NI6a6=w1040-h616-no)

![](https://lh3.googleusercontent.com/O5oZGIYazO2OcrOj4QJBNpmyxLoh87KACVkv6ghnYIIEgGRuWtYtgS618FQ1H4qGLZnzVd37OgxPk15hnSCAVh8HPgf9Db2DCTfUtdVEHuIaXhLdQbZuWfHmL2MBeAoojrvPUtI0sgyyBG2hcxrPObuOXo1kMNgD4PmI7bs2vUAMRqoiKhzyLycP3Pxq9ocy_SjL3cNTIWG1-Kw32ik-1BYgiFH4kcwZ6rV1ew2rVZGplUs6lH2gqO1mviNE7DwQseD8xwtWPpX6rXWlQmf_HIUVSvxFus_qVHjR8XVdRNe9-sroNWG2mm6u4tOgqANekQ17ZTXzF1Cp-JmP_0PpSvP9T1s3wwEpA-pHsOLJzxtwaAKIFEIttZNU_LI39DcaV3KNTKMFJkTXeFu7O8gNG2WfvX_QsHtfG8XWa1sqqOri1MmJ8kGF0fuoNrz_mHhTMSVdlLxjY5CT08f30Oi7ttArSAS4pIDaljI1Oa3vvNWLxq5gGBRbkDWSBdlmqlyTujNJiw8NrEwmNum9GDvQBAYUVldfJXmIzF3jQjTWxTjgG7Z7BdEqj54ilGal_yaf1aNCafChZnhwCQN-VFMXG5slgZ282rBuhucY2V5thOJPrz7YDx0z1TbNiGEry6Q6-ssCXuhAyrhWdUVhfA82Yuc3JWVr7kYw=w998-h520-no)

![](https://lh3.googleusercontent.com/jEMgRaAdjRkFdUsqLzzqTumOKhbQTkmuyTrIljeVgxiYOtzBwVgdqKqUr2NG-ltSheWz7mcBNUKTNt9K6o-2D10qgaRT1iv18w_1XjZ_wwwu8IbNwRcJUlCxeNI32edqVcn_PAwE6snAGexLltyvFfZWdpzcfKb36pw4_0ECv5rsZwBEf3n2IS4ipjDgnnIFCBMvPa9GOgdN5wd5xvbXIOyBnNQQYt5uE4r95qQ7lEQivnOZB_5FyMq1LJbujYkVvlSYJfkDgcuMzXl4-bRmebdtgH5F6Ol1e7zpF2RNgPPUdsfWJ7m3Rnkpw2P6OVKGQhsU0MaqYjrwXERA0MgnMV8L0Zfbk6-2HSOK4PfT46GGz4LfamOwrzQIp1ZAUgWNsuzABVEytfJuqEvldcvhs6bh6a4rDQglYK7OTALJj1k_zlexOdjFOu86AozGpTlT8DE3V_e2vaIK1TJacmQ7pjrPd_Q6xQcRTuyvho53BYfb-tVdQGHMWsWMOmAWwE0yHh2V7AFQvgj9RwCQMIiAis79yNM6BFXd5SomFH3Sx0tdwvpqade-Wz21uJUDFaPvfct5fvWRN-wCK6mCiQoJ0Z6JGqpIBn3zMDQHh2o0TdLK_PRHw0E5SX1OEzSjISjFfHaVwye01aaxuQG5m-9lyZGSkDP-y_Au=w969-h523-no)

Get initialization actions:

![](https://lh3.googleusercontent.com/b94aIuHDCS0PKGR5_F5DliDpfyb8j6gwSp3PG6sZ5WHh4rKWE_S5NLivjR-g5ciXCGOvRuqYWdrPwFi9a3E20W1avF5KqKrCYVwaoZhDN63yUjpeCQNKff32WMprLWrPGlv8l4vYYXOfP09KLMyD_1cEft2EQOn60V2VbsZt8p-KC4sGw1NVVrihnj4wLPuXu9r9KhgKsOkEpdHjgXtav9zOEDmp54OuAR9bQOgEAP0PCFjHJWSq_AYXydtOaseBCSPPb3l7uOHv5WZ7zDEfxFLhHoLxVo8Ak0qO7XKRv7AfMRThU6-JPWV5G5unlDMujmlT-x04cRvET4rezwOu_dY6X2Mk0qmZ33Pm2ApWNXAc5J2Q6xpksbHtaP54ZazwZFpvIubAI7GWMLXrMIH0F99_nXJrIaj5TKM9n1Usow82KDWlz_X0u49S2nvfpXt6NjoZZpQQva3tRfHgzBzPuyb36t88iP1hKHJraHJbiBHTt4M5uGCuShc8bImpJiN7So0gt2d9cb8Vk1MiNlh99cext4WDt6EaFT42edFMJSlRzmmU_PAhgRywPYgFY-E9Zg446Ic00rwllKbzgZhN64DNco6NBbjcr0fueO9-IURAi29Sshm2BS0WGzzLym0sWhNIhCNW3kczsenHX74qc5GJ8dp0y6S-=w759-h502-no)

![](https://lh3.googleusercontent.com/y8FzrH5TB4FuFNwrgvBSnvnG7uBkg1aoL8CBwwcQprWrS0Zb7xuUiT4b4BAODUxMSdTK_o_DYY_BRKVB5KCw3Z5lYjIniGYJHZb2McGIJLtuslK4R7DiMBBchxCwktb3-OzmqnJL94jkfiGQLNXla2xvq4IZYwocN0lrHEPy6dbewUNJihXoY0UPMI6oA_G_JtMnAAFdPagoyuhFSDjwQ_hyCE-YeoO0UM_o-eYGH8gNFf5arCUMqGTrZZNCAtw3oqCfbQ7FTC-vD32wR044pYXPgLImPJGIX0JYxo99BI-kJnSEgCDwZwS6rRUxEE3bGBJ9Z5pNO47yVylp9Tg-umTG81SaaOlPZNEgvA2J1EXQ4VFAoToYyQZ0fISAlP3F5blYJ4MHn5KeJVANS_vwuos2ujJFBqHmosZZDCp2_zWW50egXmtLa-gYvFouie_LG5AiJT4zUgAnEHWNGr_-fsI4FTOgZltE5uJWxSU0CNv7WzAIR28RgKYmsyytsEn9dL9U06arkYhxl9cEwE5GRB82iTNEc9u5ZkXkgjGY0vJtKpJa9Zfi0lJjc8xK4UIesWXoSPix1syrX298D92CdtPc-Az86A5zGo0vu4_1DhhxG5mrT-DAXhINpS9olHfvK5eb4lUWWaE5oNEkCiZL5n3z5lXOQS5Z=w821-h140-no)

Wait a minute or two, and the Data Proc API will provision your cluster. You don't need a download, no installation, and nothing. Your Spark cluster should be ready in just a few clicks.

## How to access Spark Cluster in Cloud?

1. Download and install cloud sdk: [https://dl.google.com/dl/cloudsdk/channels/rapid/GoogleCloudSDKInstaller.exe?hl=vi](https://dl.google.com/dl/cloudsdk/channels/rapid/GoogleCloudSDKInstaller.exe?hl=vi)

2. Run the following command prompt:

```
gcloud compute ssh --zone=asia-east1-a --ssh-flag="-D"  --ssh-flag="10000" --ssh-flag="-N" "spark-6-m"

```

![](https://lh3.googleusercontent.com/tE6Y7khvCgeap4n5jVjkOJ_XNc5z00uZv_KaUFtThmXMmTv-cFzJ5h4N7T5DeMPNQ5zwRJSxNo8irno2Jod4CQ3BRvR7HdBg8OiYyL9EEezaEAiyT-GIS7Coup-8F8BPr_9xmmflC9jtdvmwMc9dp5C-radTWFK94VvM3lV2gxxZT9GVq65Te0yZwzpsddEqK5aYOn0XrMTj9GtNryZpy4-cEufybZMq62znVxvM_nIBOacz5K7jH0Ny4WrfAwxCLLG-W4caTwpWaS4xNA0qWsWowmWUkO_dw7dgQ4Ouq4gJ02Di8JbkLr6Q3Y_ojG87hoEUmHYm3CDuTY6xmXLRSim1cthfveDiH_aiZ88i8Pie4mq4d3FsxJTKj1t1nYeRMdhA9E6o0YzYGw0aF4dfHTex4oIvqmmxd5F23EKmQydy89_JHX1mJW2Yoq2pxqY0mkUOI7rB7wGwDqrD2Cbk7S4Vcnpn-R2XRm_9MAX-5BBKmeG6bbE44gy6m2anVddlQIvY4ospqbswqsoaXCzZnrBxOh3U_LuSmOFcEWoRV-WWan9N-bDTaPZiRuzIhds88d1FuN48UF-yJV90cEtwE5t_V_zaCIwOKAwi1oNfnbqDX2Xq9r4GNyXPtmmrxb5hA5aLya-e9hCilvPKvjRoN8lglfXguwW-=w965-h246-no)

After Putty will automatic run, authenticate user:

![](https://lh3.googleusercontent.com/7neNHgDj9CvshPQ92_y6Ub78rKxtYIvttFDq3KQAzferW6auTejYdShj46JG5SFzXzrkuj7nnK-FGXLdAfhZeRNwsLIssB2bbGg-hgc8EFfbzGz3o8rzSdoBAtCkfF0TTejHTMaMrE0yA6bHdLe2G8VSgePwlLT16YFduz6r5LCpRKMSAWwVqKux2ZJYHghM1HzVIxkfxDOM5nY18SF7Jr4KDyV262tJkqh-GSPH8BwerXT6TxxjJ_aMOdPFUXGFrNVgRs0s1OwGzC-4zyFBRwIl-cHTqRlMZov1_xarcifIqNXjB5kSIb2VxkkXDVm0mfC0NlSicRBAUEhFlhNnBrsO2ftX9v-xbVEwnae8qEokcZ9kjF2uyEUQhNtFTw-W4vpQJzm6A3BHb2rcRzU47KFpoPa-TS_q4p83Ls6qgKvnKcIvNEk56l-uySIpI8K0yJdLOoHXUwB6mAyt1SSi1jq8lBZFtLOxWxr1A-s0G8zdvdZXljBPvNkE370oHxmNYMj2eLHYd_t-KDpHTARoY0QksC64dPnx2WQqkR4BWG_5Me3NnKybX2CGMtoyBXOkFJTV-eOLu90_hRypNLrxQrtgI9Rene1rn7P8HfwlQyEoWidDUJLisSi26N1mwNX7fsZkNolF8wjW_AnkD6R408EfuKIWcNr_=w658-h335-no)


```
"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" "http://spark-6-m:8088" 
    --proxy-server="socks5://localhost:10000" --host-resolver-rules="MAP * 0.0.0.0, EXCLUDE localhost" 
        --user-data-dir=c:\test\spark-6-m

```
![](https://lh3.googleusercontent.com/XTGt7MvnNvjUVqP-jK3J11W-8redgjOedkcILLkYNxIdJbl_-DwHYYAyqR5ljHReslLFVFr26-exj8ksz1bfc-Ye36xUb80slvudap5Lyfs6gpfcAnS3OqC2KOqQMNHnYFpyvUhIzVog2zadPJJJClfUUtKgktFVMDk9Z0SLLe0OCoVL0l2FZpb6UxDnDbD7Cbtc9sqI6G2yxn_9v8fCdLlqr5kmRjgiS4aAQzw1x83a2vk7aiw-BB9tQnlh0cugAa2P3AHxfD_sbZmyHR0xTbFdhDp6unn1wV3W5Gw06hpAyuUV0Fwkpmhm59Tog0pY3dF7plLV0RXJF5xWsqEaWziOPEX3eqVFJwMk7cfdQUE7sQQjlS6rUVjBIpU6EkiW_X-WvRlpZAkQ2m89IdL6xY4BTDGl8PbZcyvVgFdTWvvUcnMZbzkwem64dqNh6m8pYJ6h480QuUOE7bBqaxr6tsrxTrcniLd8GX-znR_8zddfwIi0NXeM25m83uhyx6qLI8A2I-CMHfEvV3TwCIls4Mz-hTWOej6IKrJgFYpnWEhAFvg_1wA-jfdohC2FcXVrPF0F-bjfDg-_N4ZLOdKZ-G94dQHsKx-CSMsvhCk9BABE0FruqsuODut7WvhCbPZ57_kmDlRMLKOfaOuPG2gANjOkZmwjKaUz=w1296-h662-no)

I am starting chrome.exe with my YARN Resource Manager URL. Next one is the proxy server. It should use the socks5 protocol on my local machine's port 10000. That's the port where we started the SSH tunnel. Right? 
The next flag is to avoid any DNS resolves by chrome. Finally, the last option is a non-existent directory path. This option allows chrome to start a brand-new session. 
That's it. You can access the resource manager in the new browser. 
This video demonstrated to get you a Spark cluster. You can access that over the web and SSH. Execute your Jobs, play with it and later go back to your Data Proc clusters list and delete it. We don't have an option to keep it there in shutdown state. Creating and removing a cluster is as simple as few clicks. You can create a new one every day, use it and then throw it away.

References more: [Spark SQL, DataFrames and Datasets Guide](https://spark.apache.org/docs/latest/sql-programming-guide.html)